(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}})();const style$2="",sharedConfig={};function setHydrateContext(e){sharedConfig.context=e}const equalFn=(e,t)=>e===t,$PROXY=Symbol("solid-proxy"),$TRACK=Symbol("solid-track"),signalOptions={equals:equalFn};let runEffects=runQueue;const STALE=1,PENDING=2,UNOWNED={owned:null,cleanups:null,context:null,owner:null};var Owner=null;let Transition=null,Listener=null,Updates=null,Effects=null,ExecCount=0;function createRoot(e,t){const r=Listener,n=Owner,o=e.length===0,i=o?UNOWNED:{owned:null,cleanups:null,context:null,owner:t||n},s=o?e:()=>e(()=>untrack(()=>cleanNode(i)));Owner=i,Listener=null;try{return runUpdates(s,!0)}finally{Listener=r,Owner=n}}function createSignal(e,t){t=t?Object.assign({},signalOptions,t):signalOptions;const r={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},n=o=>(typeof o=="function"&&(o=o(r.value)),writeSignal(r,o));return[readSignal.bind(r),n]}function createComputed(e,t,r){const n=createComputation(e,t,!0,STALE);updateComputation(n)}function createRenderEffect(e,t,r){const n=createComputation(e,t,!1,STALE);updateComputation(n)}function createEffect(e,t,r){runEffects=runUserEffects;const n=createComputation(e,t,!1,STALE),o=SuspenseContext&&lookup(Owner,SuspenseContext.id);o&&(n.suspense=o),n.user=!0,Effects?Effects.push(n):updateComputation(n)}function createMemo(e,t,r){r=r?Object.assign({},signalOptions,r):signalOptions;const n=createComputation(e,t,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,updateComputation(n),readSignal.bind(n)}function batch(e){return runUpdates(e,!1)}function untrack(e){const t=Listener;Listener=null;try{return e()}finally{Listener=t}}function onMount(e){createEffect(()=>untrack(e))}function onCleanup(e){return Owner===null||(Owner.cleanups===null?Owner.cleanups=[e]:Owner.cleanups.push(e)),e}function getListener(){return Listener}let SuspenseContext;function readSignal(){const e=Transition;if(this.sources&&(this.state||e))if(this.state===STALE||e)updateComputation(this);else{const t=Updates;Updates=null,runUpdates(()=>lookUpstream(this),!1),Updates=t}if(Listener){const t=this.observers?this.observers.length:0;Listener.sources?(Listener.sources.push(this),Listener.sourceSlots.push(t)):(Listener.sources=[this],Listener.sourceSlots=[t]),this.observers?(this.observers.push(Listener),this.observerSlots.push(Listener.sources.length-1)):(this.observers=[Listener],this.observerSlots=[Listener.sources.length-1])}return this.value}function writeSignal(e,t,r){let n=e.value;return(!e.comparator||!e.comparator(n,t))&&(e.value=t,e.observers&&e.observers.length&&runUpdates(()=>{for(let o=0;o<e.observers.length;o+=1){const i=e.observers[o],s=Transition&&Transition.running;s&&Transition.disposed.has(i),(s&&!i.tState||!s&&!i.state)&&(i.pure?Updates.push(i):Effects.push(i),i.observers&&markDownstream(i)),s||(i.state=STALE)}if(Updates.length>1e6)throw Updates=[],new Error},!1)),t}function updateComputation(e){if(!e.fn)return;cleanNode(e);const t=Owner,r=Listener,n=ExecCount;Listener=Owner=e,runComputation(e,e.value,n),Listener=r,Owner=t}function runComputation(e,t,r){let n;try{n=e.fn(t)}catch(o){e.pure&&(e.state=STALE),handleError(o)}(!e.updatedAt||e.updatedAt<=r)&&(e.updatedAt!=null&&"observers"in e?writeSignal(e,n):e.value=n,e.updatedAt=r)}function createComputation(e,t,r,n=STALE,o){const i={fn:e,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:Owner,context:null,pure:r};return Owner===null||Owner!==UNOWNED&&(Owner.owned?Owner.owned.push(i):Owner.owned=[i]),i}function runTop(e){const t=Transition;if(e.state===0||t)return;if(e.state===PENDING||t)return lookUpstream(e);if(e.suspense&&untrack(e.suspense.inFallback))return e.suspense.effects.push(e);const r=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<ExecCount);)(e.state||t)&&r.push(e);for(let n=r.length-1;n>=0;n--)if(e=r[n],e.state===STALE||t)updateComputation(e);else if(e.state===PENDING||t){const o=Updates;Updates=null,runUpdates(()=>lookUpstream(e,r[0]),!1),Updates=o}}function runUpdates(e,t){if(Updates)return e();let r=!1;t||(Updates=[]),Effects?r=!0:Effects=[],ExecCount++;try{const n=e();return completeUpdates(r),n}catch(n){Updates||(Effects=null),handleError(n)}}function completeUpdates(e){if(Updates&&(runQueue(Updates),Updates=null),e)return;const t=Effects;Effects=null,t.length&&runUpdates(()=>runEffects(t),!1)}function runQueue(e){for(let t=0;t<e.length;t++)runTop(e[t])}function runUserEffects(e){let t,r=0;for(t=0;t<e.length;t++){const n=e[t];n.user?e[r++]=n:runTop(n)}for(sharedConfig.context&&setHydrateContext(),t=0;t<r;t++)runTop(e[t])}function lookUpstream(e,t){const r=Transition;e.state=0;for(let n=0;n<e.sources.length;n+=1){const o=e.sources[n];o.sources&&(o.state===STALE||r?o!==t&&runTop(o):(o.state===PENDING||r)&&lookUpstream(o,t))}}function markDownstream(e){const t=Transition;for(let r=0;r<e.observers.length;r+=1){const n=e.observers[r];(!n.state||t)&&(n.state=PENDING,n.pure?Updates.push(n):Effects.push(n),n.observers&&markDownstream(n))}}function cleanNode(e){let t;if(e.sources)for(;e.sources.length;){const r=e.sources.pop(),n=e.sourceSlots.pop(),o=r.observers;if(o&&o.length){const i=o.pop(),s=r.observerSlots.pop();n<o.length&&(i.sourceSlots[s]=n,o[n]=i,r.observerSlots[n]=s)}}if(e.owned){for(t=0;t<e.owned.length;t++)cleanNode(e.owned[t]);e.owned=null}if(e.cleanups){for(t=0;t<e.cleanups.length;t++)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function castError(e){return e instanceof Error||typeof e=="string"?e:new Error("Unknown error")}function handleError(e){throw e=castError(e),e}function lookup(e,t){return e?e.context&&e.context[t]!==void 0?e.context[t]:lookup(e.owner,t):void 0}const FALLBACK=Symbol("fallback");function dispose(e){for(let t=0;t<e.length;t++)e[t]()}function mapArray(e,t,r={}){let n=[],o=[],i=[],s=0,l=t.length>1?[]:null;return onCleanup(()=>dispose(i)),()=>{let c=e()||[],d,f;return c[$TRACK],untrack(()=>{let b=c.length,v,w,S,T,I,N,F,B,E;if(b===0)s!==0&&(dispose(i),i=[],n=[],o=[],s=0,l&&(l=[])),r.fallback&&(n=[FALLBACK],o[0]=createRoot(D=>(i[0]=D,r.fallback())),s=1);else if(s===0){for(o=new Array(b),f=0;f<b;f++)n[f]=c[f],o[f]=createRoot(m);s=b}else{for(S=new Array(b),T=new Array(b),l&&(I=new Array(b)),N=0,F=Math.min(s,b);N<F&&n[N]===c[N];N++);for(F=s-1,B=b-1;F>=N&&B>=N&&n[F]===c[B];F--,B--)S[B]=o[F],T[B]=i[F],l&&(I[B]=l[F]);for(v=new Map,w=new Array(B+1),f=B;f>=N;f--)E=c[f],d=v.get(E),w[f]=d===void 0?-1:d,v.set(E,f);for(d=N;d<=F;d++)E=n[d],f=v.get(E),f!==void 0&&f!==-1?(S[f]=o[d],T[f]=i[d],l&&(I[f]=l[d]),f=w[f],v.set(E,f)):i[d]();for(f=N;f<b;f++)f in S?(o[f]=S[f],i[f]=T[f],l&&(l[f]=I[f],l[f](f))):o[f]=createRoot(m);o=o.slice(0,s=b),n=c.slice(0)}return o});function m(b){if(i[f]=b,l){const[v,w]=createSignal(f);return l[f]=w,t(c[f],v)}return t(c[f])}}}function createComponent(e,t){return untrack(()=>e(t||{}))}function trueFn(){return!0}const propTraps={get(e,t,r){return t===$PROXY?r:e.get(t)},has(e,t){return e.has(t)},set:trueFn,deleteProperty:trueFn,getOwnPropertyDescriptor(e,t){return{configurable:!0,enumerable:!0,get(){return e.get(t)},set:trueFn,deleteProperty:trueFn}},ownKeys(e){return e.keys()}};function resolveSource(e){return(e=typeof e=="function"?e():e)?e:{}}function mergeProps(...e){if(e.some(r=>r&&($PROXY in r||typeof r=="function")))return new Proxy({get(r){for(let n=e.length-1;n>=0;n--){const o=resolveSource(e[n])[r];if(o!==void 0)return o}},has(r){for(let n=e.length-1;n>=0;n--)if(r in resolveSource(e[n]))return!0;return!1},keys(){const r=[];for(let n=0;n<e.length;n++)r.push(...Object.keys(resolveSource(e[n])));return[...new Set(r)]}},propTraps);const t={};for(let r=e.length-1;r>=0;r--)if(e[r]){const n=Object.getOwnPropertyDescriptors(e[r]);for(const o in n)o in t||Object.defineProperty(t,o,{enumerable:!0,get(){for(let i=e.length-1;i>=0;i--){const s=(e[i]||{})[o];if(s!==void 0)return s}}})}return t}function splitProps(e,...t){const r=new Set(t.flat()),n=Object.getOwnPropertyDescriptors(e),o=$PROXY in e;o||t.push(Object.keys(n).filter(s=>!r.has(s)));const i=t.map(s=>{const l={};for(let c=0;c<s.length;c++){const d=s[c];!o&&!(d in e)||Object.defineProperty(l,d,n[d]?n[d]:{get(){return e[d]},set(){return!0},enumerable:!0})}return l});return o&&i.push(new Proxy({get(s){return r.has(s)?void 0:e[s]},has(s){return r.has(s)?!1:s in e},keys(){return Object.keys(e).filter(s=>!r.has(s))}},propTraps)),i}function For(e){const t="fallback"in e&&{fallback:()=>e.fallback};return createMemo(mapArray(()=>e.each,e.children,t||void 0))}function Show(e){let t=!1;const r=e.keyed,n=createMemo(()=>e.when,void 0,{equals:(o,i)=>t?o===i:!o==!i});return createMemo(()=>{const o=n();if(o){const i=e.children,s=typeof i=="function"&&i.length>0;return t=r||s,s?untrack(()=>i(o)):i}return e.fallback})}const booleans=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],Properties=new Set(["className","value","readOnly","formNoValidate","isMap","noModule","playsInline",...booleans]),ChildProperties=new Set(["innerHTML","textContent","innerText","children"]),Aliases=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),PropAliases=Object.assign(Object.create(null),{class:"className",formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly"}),DelegatedEvents=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),SVGNamespace={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"};function reconcileArrays(e,t,r){let n=r.length,o=t.length,i=n,s=0,l=0,c=t[o-1].nextSibling,d=null;for(;s<o||l<i;){if(t[s]===r[l]){s++,l++;continue}for(;t[o-1]===r[i-1];)o--,i--;if(o===s){const f=i<n?l?r[l-1].nextSibling:r[i-l]:c;for(;l<i;)e.insertBefore(r[l++],f)}else if(i===l)for(;s<o;)(!d||!d.has(t[s]))&&t[s].remove(),s++;else if(t[s]===r[i-1]&&r[l]===t[o-1]){const f=t[--o].nextSibling;e.insertBefore(r[l++],t[s++].nextSibling),e.insertBefore(r[--i],f),t[o]=r[i]}else{if(!d){d=new Map;let m=l;for(;m<i;)d.set(r[m],m++)}const f=d.get(t[s]);if(f!=null)if(l<f&&f<i){let m=s,b=1,v;for(;++m<o&&m<i&&!((v=d.get(t[m]))==null||v!==f+b);)b++;if(b>f-l){const w=t[s];for(;l<f;)e.insertBefore(r[l++],w)}else e.replaceChild(r[l++],t[s++])}else s++;else t[s++].remove()}}}const $$EVENTS="_$DX_DELEGATE";function render(e,t,r,n={}){let o;return createRoot(i=>{o=i,t===document?e():insert(t,e(),t.firstChild?null:void 0,r)},n.owner),()=>{o(),t.textContent=""}}function template(e,t,r){const n=document.createElement("template");n.innerHTML=e;let o=n.content.firstChild;return r&&(o=o.firstChild),o}function delegateEvents(e,t=window.document){const r=t[$$EVENTS]||(t[$$EVENTS]=new Set);for(let n=0,o=e.length;n<o;n++){const i=e[n];r.has(i)||(r.add(i),t.addEventListener(i,eventHandler))}}function setAttribute(e,t,r){r==null?e.removeAttribute(t):e.setAttribute(t,r)}function setAttributeNS(e,t,r,n){n==null?e.removeAttributeNS(t,r):e.setAttributeNS(t,r,n)}function className(e,t){t==null?e.removeAttribute("class"):e.className=t}function addEventListener$1(e,t,r,n){if(n)Array.isArray(r)?(e[`$$${t}`]=r[0],e[`$$${t}Data`]=r[1]):e[`$$${t}`]=r;else if(Array.isArray(r)){const o=r[0];e.addEventListener(t,r[0]=i=>o.call(e,r[1],i))}else e.addEventListener(t,r)}function classList(e,t,r={}){const n=Object.keys(t||{}),o=Object.keys(r);let i,s;for(i=0,s=o.length;i<s;i++){const l=o[i];!l||l==="undefined"||t[l]||(toggleClassKey(e,l,!1),delete r[l])}for(i=0,s=n.length;i<s;i++){const l=n[i],c=!!t[l];!l||l==="undefined"||r[l]===c||!c||(toggleClassKey(e,l,!0),r[l]=c)}return r}function style$1(e,t,r){if(!t)return r?setAttribute(e,"style"):t;const n=e.style;if(typeof t=="string")return n.cssText=t;typeof r=="string"&&(n.cssText=r=void 0),r||(r={}),t||(t={});let o,i;for(i in r)t[i]==null&&n.removeProperty(i),delete r[i];for(i in t)o=t[i],o!==r[i]&&(n.setProperty(i,o),r[i]=o);return r}function spread(e,t={},r,n){const o={};return n||createRenderEffect(()=>o.children=insertExpression(e,t.children,o.children)),createRenderEffect(()=>t.ref&&t.ref(e)),createRenderEffect(()=>assign(e,t,r,!0,o,!0)),o}function use(e,t,r){return untrack(()=>e(t,r))}function insert(e,t,r,n){if(r!==void 0&&!n&&(n=[]),typeof t!="function")return insertExpression(e,t,n,r);createRenderEffect(o=>insertExpression(e,t(),o,r),n)}function assign(e,t,r,n,o={},i=!1){t||(t={});for(const s in o)if(!(s in t)){if(s==="children")continue;o[s]=assignProp(e,s,null,o[s],r,i)}for(const s in t){if(s==="children"){n||insertExpression(e,t.children);continue}const l=t[s];o[s]=assignProp(e,s,l,o[s],r,i)}}function toPropertyName(e){return e.toLowerCase().replace(/-([a-z])/g,(t,r)=>r.toUpperCase())}function toggleClassKey(e,t,r){const n=t.trim().split(/\s+/);for(let o=0,i=n.length;o<i;o++)e.classList.toggle(n[o],r)}function assignProp(e,t,r,n,o,i){let s,l,c;if(t==="style")return style$1(e,r,n);if(t==="classList")return classList(e,r,n);if(r===n)return n;if(t==="ref")i||r(e);else if(t.slice(0,3)==="on:"){const d=t.slice(3);n&&e.removeEventListener(d,n),r&&e.addEventListener(d,r)}else if(t.slice(0,10)==="oncapture:"){const d=t.slice(10);n&&e.removeEventListener(d,n,!0),r&&e.addEventListener(d,r,!0)}else if(t.slice(0,2)==="on"){const d=t.slice(2).toLowerCase(),f=DelegatedEvents.has(d);if(!f&&n){const m=Array.isArray(n)?n[0]:n;e.removeEventListener(d,m)}(f||r)&&(addEventListener$1(e,d,r,f),f&&delegateEvents([d]))}else if((c=ChildProperties.has(t))||!o&&(PropAliases[t]||(l=Properties.has(t)))||(s=e.nodeName.includes("-")))t==="class"||t==="className"?className(e,r):s&&!l&&!c?e[toPropertyName(t)]=r:e[PropAliases[t]||t]=r;else{const d=o&&t.indexOf(":")>-1&&SVGNamespace[t.split(":")[0]];d?setAttributeNS(e,d,t,r):setAttribute(e,Aliases[t]||t,r)}return r}function eventHandler(e){const t=`$$${e.type}`;let r=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==r&&Object.defineProperty(e,"target",{configurable:!0,value:r}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return r||document}}),sharedConfig.registry&&!sharedConfig.done&&(sharedConfig.done=!0,document.querySelectorAll("[id^=pl-]").forEach(n=>n.remove()));r!==null;){const n=r[t];if(n&&!r.disabled){const o=r[`${t}Data`];if(o!==void 0?n.call(r,o,e):n.call(r,e),e.cancelBubble)return}r=r.host&&r.host!==r&&r.host instanceof Node?r.host:r.parentNode}}function insertExpression(e,t,r,n,o){for(sharedConfig.context&&!r&&(r=[...e.childNodes]);typeof r=="function";)r=r();if(t===r)return r;const i=typeof t,s=n!==void 0;if(e=s&&r[0]&&r[0].parentNode||e,i==="string"||i==="number"){if(sharedConfig.context)return r;if(i==="number"&&(t=t.toString()),s){let l=r[0];l&&l.nodeType===3?l.data=t:l=document.createTextNode(t),r=cleanChildren(e,r,n,l)}else r!==""&&typeof r=="string"?r=e.firstChild.data=t:r=e.textContent=t}else if(t==null||i==="boolean"){if(sharedConfig.context)return r;r=cleanChildren(e,r,n)}else{if(i==="function")return createRenderEffect(()=>{let l=t();for(;typeof l=="function";)l=l();r=insertExpression(e,l,r,n)}),()=>r;if(Array.isArray(t)){const l=[],c=r&&Array.isArray(r);if(normalizeIncomingArray(l,t,r,o))return createRenderEffect(()=>r=insertExpression(e,l,r,n,!0)),()=>r;if(sharedConfig.context){if(!l.length)return r;for(let d=0;d<l.length;d++)if(l[d].parentNode)return r=l}if(l.length===0){if(r=cleanChildren(e,r,n),s)return r}else c?r.length===0?appendNodes(e,l,n):reconcileArrays(e,r,l):(r&&cleanChildren(e),appendNodes(e,l));r=l}else if(t instanceof Node){if(sharedConfig.context&&t.parentNode)return r=s?[t]:t;if(Array.isArray(r)){if(s)return r=cleanChildren(e,r,n,t);cleanChildren(e,r,null,t)}else r==null||r===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);r=t}}return r}function normalizeIncomingArray(e,t,r,n){let o=!1;for(let i=0,s=t.length;i<s;i++){let l=t[i],c=r&&r[i];if(l instanceof Node)e.push(l);else if(!(l==null||l===!0||l===!1))if(Array.isArray(l))o=normalizeIncomingArray(e,l,c)||o;else if(typeof l=="function")if(n){for(;typeof l=="function";)l=l();o=normalizeIncomingArray(e,Array.isArray(l)?l:[l],Array.isArray(c)?c:[c])||o}else e.push(l),o=!0;else{const d=String(l);c&&c.nodeType===3&&c.data===d?e.push(c):e.push(document.createTextNode(d))}}return o}function appendNodes(e,t,r=null){for(let n=0,o=t.length;n<o;n++)e.insertBefore(t[n],r)}function cleanChildren(e,t,r,n){if(r===void 0)return e.textContent="";const o=n||document.createTextNode("");if(t.length){let i=!1;for(let s=t.length-1;s>=0;s--){const l=t[s];if(o!==l){const c=l.parentNode===e;!i&&!s?c?e.replaceChild(o,l):e.insertBefore(o,r):c&&l.remove()}else i=!0}}else e.insertBefore(o,r);return[o]}const _tmpl$$8=template('<button aria-label="import audio from file">from file</button>'),_tmpl$2$3=template('<input type="file" style="display: none;" accept=".mp3, .wav, .m4a">'),AudioInput=e=>{let t;return[(()=>{const r=_tmpl$$8.cloneNode(!0);return r.$$click=()=>t?.click(),r})(),(()=>{const r=_tmpl$2$3.cloneNode(!0);r.addEventListener("change",o=>{const[i]=[...o.currentTarget.files||[]];!i||e.onChange(i)});const n=t;return typeof n=="function"?use(n,r):t=r,r})()]};delegateEvents(["click"]);function unmute(e,t=!1,r=!1){let n;document.hidden!==void 0?n={hidden:"hidden",visibilitychange:"visibilitychange"}:document.webkitHidden!==void 0?n={hidden:"webkitHidden",visibilitychange:"webkitvisibilitychange"}:document.mozHidden!==void 0?n={hidden:"mozHidden",visibilitychange:"mozvisibilitychange"}:document.msHidden!==void 0&&(n={hidden:"msHidden",visibilitychange:"msvisibilitychange"});function o(R,W,q,Y,_){for(let C=0;C<W.length;++C)R.addEventListener(W[C],q,{capture:Y,passive:_})}function i(R,W,q,Y,_){for(let C=0;C<W.length;++C)R.removeEventListener(W[C],q,{capture:Y,passive:_})}function s(){}let l=navigator.userAgent.toLowerCase(),c=r||l.indexOf("iphone")>=0&&l.indexOf("like iphone")<0||l.indexOf("ipad")>=0&&l.indexOf("like ipad")<0||l.indexOf("ipod")>=0&&l.indexOf("like ipod")<0||l.indexOf("mac os x")>=0&&navigator.maxTouchPoints>0,d=!0;function f(){let R=!!(t||(!n||!document[n.hidden])&&(!c||document.hasFocus()));R!==d&&(d=R,N(!1),v())}function m(){f()}n&&o(document,[n.visibilitychange],m,!0,!0);function b(R){R&&R.target!==window||f()}c&&o(window,["focus","blur"],b,!0,!0);function v(){if(d){if(e.state!=="running"&&e.state!=="closed"&&E){let R=e.resume();R&&R.then(s,s).catch(s)}}else if(e.state==="running"){let R=e.suspend();R&&R.then(s,s).catch(s)}}function w(R){(!R||!R.unmute_handled)&&(R.unmute_handled=!0,v())}o(e,["statechange"],w,!0,!0),e.onstatechange||(e.onstatechange=w);let S=null;function T(R,W){let q=W;for(;R>1;R--)q+=W;return q}let I="data:audio/mpeg;base64,//uQx"+T(23,"A")+"WGluZwAAAA8AAAACAAACcQCA"+T(16,"gICA")+T(66,"/")+"8AAABhTEFNRTMuMTAwA8MAAAAAAAAAABQgJAUHQQAB9AAAAnGMHkkI"+T(320,"A")+"//sQxAADgnABGiAAQBCqgCRMAAgEAH"+T(15,"/")+"7+n/9FTuQsQH//////2NG0jWUGlio5gLQTOtIoeR2WX////X4s9Atb/JRVCbBUpeRUq"+T(18,"/")+"9RUi0f2jn/+xDECgPCjAEQAABN4AAANIAAAAQVTEFNRTMuMTAw"+T(97,"V")+"Q==";function N(R){if(c)if(d){if(R){if(!S){let W=document.createElement("div");W.innerHTML="<audio x-webkit-airplay='deny'></audio>",S=W.children.item(0),S.controls=!1,S.disableRemotePlayback=!0,S.preload="auto",S.src=I,S.loop=!0,S.load()}if(S.paused){let W=S.play();W&&W.then(s,F).catch(F)}}}else F()}function F(){S&&(S.src="about:blank",S.load(),S=null)}const B=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let E=!1;function D(){E=!0,N(!0),v()}return o(window,B,D,!0,!0),{dispose:function(){F(),n&&i(document,[n.visibilitychange],m,!0,!0),c&&i(window,["focus","blur"],b,!0,!0),i(window,B,D,!0,!0),i(e,["statechange"],w,!0,!0),e.onstatechange===w&&(e.onstatechange=null)}}}const audioContext=new AudioContext;unmute(audioContext);const useAnimationFrame=e=>{let t;const r=()=>{e(),t=requestAnimationFrame(r)};onMount(()=>{t=requestAnimationFrame(r)}),onCleanup(()=>{cancelAnimationFrame(t)})};var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},audiobufferToWav=audioBufferToWav;function audioBufferToWav(e,t){t=t||{};var r=e.numberOfChannels,n=e.sampleRate,o=t.float32?3:1,i=o===3?32:16,s;return r===2?s=interleave(e.getChannelData(0),e.getChannelData(1)):s=e.getChannelData(0),encodeWAV(s,o,n,r,i)}function encodeWAV(e,t,r,n,o){var i=o/8,s=n*i,l=new ArrayBuffer(44+e.length*i),c=new DataView(l);return writeString(c,0,"RIFF"),c.setUint32(4,36+e.length*i,!0),writeString(c,8,"WAVE"),writeString(c,12,"fmt "),c.setUint32(16,16,!0),c.setUint16(20,t,!0),c.setUint16(22,n,!0),c.setUint32(24,r,!0),c.setUint32(28,r*s,!0),c.setUint16(32,s,!0),c.setUint16(34,o,!0),writeString(c,36,"data"),c.setUint32(40,e.length*i,!0),t===1?floatTo16BitPCM(c,44,e):writeFloat32(c,44,e),l}function interleave(e,t){for(var r=e.length+t.length,n=new Float32Array(r),o=0,i=0;o<r;)n[o++]=e[i],n[o++]=t[i],i++;return n}function writeFloat32(e,t,r){for(var n=0;n<r.length;n++,t+=4)e.setFloat32(t,r[n],!0)}function floatTo16BitPCM(e,t,r){for(var n=0;n<r.length;n++,t+=2){var o=Math.max(-1,Math.min(1,r[n]));e.setInt16(t,o<0?o*32768:o*32767,!0)}}function writeString(e,t,r){for(var n=0;n<r.length;n++)e.setUint8(t+n,r.charCodeAt(n))}const player=createPlayer(audioContext);window.player=player;function createFxAssembly(e){const t=e.createBiquadFilter();t.type="lowpass",t.Q.value=0;const r=e.createBiquadFilter();r.type="highpass",r.Q.value=0;const n=e.createDynamicsCompressor(),o=e.createGain();return t.connect(r).connect(n).connect(o),{in:t,out:o,loPassFreq:t.frequency,hiPassFreq:r.frequency,compressionThreshold:n.threshold,gain:o.gain}}function createPlayer(e){const[t,r]=createSignal(void 0),[n,o]=createSignal({start:0,end:1});let i;const[s,l]=createSignal(!1),[c,d]=createSignal(0),[f,m]=createSignal(0),[b,v]=createSignal(100),[w,S]=createSignal(0),[T,I]=createSignal(0),[N,F]=createSignal(0),B=()=>{const _=f()+100*c();return Math.pow(2,_/1200)},E=createFxAssembly(e);E.out.connect(e.destination),createEffect(()=>{rampTo(E.gain,Math.pow(10,N()/20))}),createEffect(()=>{rampTo(E.hiPassFreq,mapLinearToLogarithmic(w()))}),createEffect(()=>{rampTo(E.loPassFreq,mapLinearToLogarithmic(b()))}),createEffect(()=>{rampTo(E.compressionThreshold,T())}),createEffect(()=>{B();const _=i?.sourceAssembly.sourceNode.buffer;_&&(R(),D(_,n()))});const D=(_,C={start:0,end:1})=>{R(),o(C),r(e.currentTime),s()?i=schedulePlaybackLoop(e,_,C,B(),E.in):i={sourceAssembly:schedulePlaybackSingle(e,_,C,B(),E.in,R)}},R=()=>{!i||(clearInterval(i.gainEnvelopeScheduler),smoothStop(i.sourceAssembly),i=void 0,r(void 0))},W=()=>t()!==void 0,[q,Y]=createSignal(0);return useAnimationFrame(()=>{const _=t();if(!_||!i?.sourceAssembly.sourceNode.buffer)return;const C=(n().end-n().start)*i.sourceAssembly.sourceNode.buffer.duration,L=(e.currentTime-_)*B()%C,U=i.sourceAssembly.sourceNode.buffer.duration*n().start,G=L+U;Y(G/i.sourceAssembly.sourceNode.buffer.duration)}),{play:D,playing:W,region:n,stop:R,progress:q,loop:s,setLoop:l,pitchOffsetSemis:c,setPitchOffsetSemis:d,pitchOffsetCents:f,setPitchOffsetCents:m,loPass:b,setLoPass:_=>{_<w()&&S(_),v(_)},hiPass:w,setHiPass:_=>{b()<_&&v(_),S(_)},speed:B,compressionThreshold:T,setCompressionThreshold:I,gain:N,setGain:F}}window.createPlayer=createPlayer;function rampTo(e,t,r=.001){e.cancelScheduledValues(audioContext.currentTime),e.value=e.value,e.linearRampToValueAtTime(t,audioContext.currentTime+r)}const smoothStop=(e,t=.001)=>{const r=audioContext.currentTime+t;e.gainNode.gain.cancelScheduledValues(audioContext.currentTime),e.gainNode.gain.setValueAtTime(1,audioContext.currentTime),e.gainNode.gain.linearRampToValueAtTime(0,r),e.sourceNode.onended=null,e.sourceNode.stop(r)},schedulePlaybackSingle=(e,t,r,n,o,i)=>{const s=e.currentTime,l=t.duration*r.start,c=t.duration*(r.end-r.start),d=e.createGain();d.connect(o);const f=e.createBufferSource();return f.playbackRate.value=n,f.buffer=t,f.connect(d),i&&(f.onended=i),scheduleEnvelope(d,{start:s,end:s+c/n,ramp:.001}),f.start(s,l,c),{sourceNode:f,gainNode:d}},schedulePlaybackLoop=(e,t,r,n,o)=>{const i=e.currentTime,s=t.duration*r.start,l=t.duration*r.end,c=e.createGain();c.connect(o);const d=e.createBufferSource();d.buffer=t,d.loop=!0,d.loopStart=s,d.loopEnd=l,d.playbackRate.value=n,d.connect(c);const f={sourceNode:d,gainNode:c},m=startEnvelopeScheduler(f,r,i,n);return d.start(i,s),{sourceAssembly:f,gainEnvelopeScheduler:m}},startEnvelopeScheduler=(e,t,r,n)=>{const o=(t.end-t.start)*(e.sourceNode.buffer?.duration||1)/n;let i=-1;const s=()=>{const l=audioContext.currentTime+1;for(let c=i+1;c*o+r<l;c++)i=c,scheduleEnvelope(e.gainNode,{start:r+c*o,end:r+(c+1)*o,ramp:.001})};return s(),setInterval(s,300)},scheduleEnvelope=(e,t)=>{e.gain.setValueAtTime(0,t.start),e.gain.linearRampToValueAtTime(1,t.start+t.ramp),e.gain.setValueAtTime(1,t.end-t.ramp),e.gain.linearRampToValueAtTime(0,t.end)},print=async(e,t,r,n,o,i,s)=>{const l=new OfflineAudioContext(e.numberOfChannels,e.duration*e.sampleRate*(t.end-t.start)/r,e.sampleRate),c=createFxAssembly(l);c.hiPassFreq.value=mapLinearToLogarithmic(n),c.loPassFreq.value=mapLinearToLogarithmic(o),c.compressionThreshold.value=i,c.gain.value=Math.pow(10,s/20),c.out.connect(l.destination),schedulePlaybackSingle(l,e,t,r,c.in);const d=await l.startRendering(),f=audiobufferToWav(d),m=await crypto.subtle.digest("SHA-256",f),v=Array.from(new Uint8Array(m)).map(w=>w.toString(16).padStart(2,"0")).join("")+".wav";return{wav:f,fileName:v}};function mapLinearToLogarithmic(e){const i=(Math.log10(2e4)-Math.log10(20))*((e-0)/100);return Math.pow(10,Math.log10(20)+i)}const download=async(e,t,r,n,o,i,s)=>{const{wav:l,fileName:c}=await print(e,t,r,o,n,i,s),d=URL.createObjectURL(new Blob([l],{type:"audio/wav"})),f=document.createElement("a");f.href=d,f.setAttribute("download",c),f.click(),URL.revokeObjectURL(d)},share=async(e,t,r,n,o,i,s)=>{const{wav:l,fileName:c}=await print(e,t,r,o,n,i,s),d=new File([l],c,{type:"audio/wav"});navigator.share({files:[d]})},$RAW=Symbol("store-raw"),$NODE=Symbol("store-node"),$NAME=Symbol("store-name");function wrap$1(e,t){let r=e[$PROXY];if(!r&&(Object.defineProperty(e,$PROXY,{value:r=new Proxy(e,proxyTraps$1)}),!Array.isArray(e))){const n=Object.keys(e),o=Object.getOwnPropertyDescriptors(e);for(let i=0,s=n.length;i<s;i++){const l=n[i];if(o[l].get){const c=o[l].get.bind(r);Object.defineProperty(e,l,{enumerable:o[l].enumerable,get:c})}}}return r}function isWrappable(e){let t;return e!=null&&typeof e=="object"&&(e[$PROXY]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function unwrap(e,t=new Set){let r,n,o,i;if(r=e!=null&&e[$RAW])return r;if(!isWrappable(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let s=0,l=e.length;s<l;s++)o=e[s],(n=unwrap(o,t))!==o&&(e[s]=n)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const s=Object.keys(e),l=Object.getOwnPropertyDescriptors(e);for(let c=0,d=s.length;c<d;c++)i=s[c],!l[i].get&&(o=e[i],(n=unwrap(o,t))!==o&&(e[i]=n))}return e}function getDataNodes(e){let t=e[$NODE];return t||Object.defineProperty(e,$NODE,{value:t={}}),t}function getDataNode(e,t,r){return e[t]||(e[t]=createDataNode(r))}function proxyDescriptor$1(e,t){const r=Reflect.getOwnPropertyDescriptor(e,t);return!r||r.get||!r.configurable||t===$PROXY||t===$NODE||t===$NAME||(delete r.value,delete r.writable,r.get=()=>e[$PROXY][t]),r}function trackSelf(e){if(getListener()){const t=getDataNodes(e);(t._||(t._=createDataNode()))()}}function ownKeys(e){return trackSelf(e),Reflect.ownKeys(e)}function createDataNode(e){const[t,r]=createSignal(e,{equals:!1,internal:!0});return t.$=r,t}const proxyTraps$1={get(e,t,r){if(t===$RAW)return e;if(t===$PROXY)return r;if(t===$TRACK)return trackSelf(e),r;const n=getDataNodes(e),o=n.hasOwnProperty(t);let i=o?n[t]():e[t];if(t===$NODE||t==="__proto__")return i;if(!o){const s=Object.getOwnPropertyDescriptor(e,t);getListener()&&(typeof i!="function"||e.hasOwnProperty(t))&&!(s&&s.get)&&(i=getDataNode(n,t,i)())}return isWrappable(i)?wrap$1(i):i},has(e,t){return t===$RAW||t===$PROXY||t===$TRACK||t===$NODE||t==="__proto__"?!0:(this.get(e,t,e),t in e)},set(){return!0},deleteProperty(){return!0},ownKeys,getOwnPropertyDescriptor:proxyDescriptor$1};function setProperty(e,t,r,n=!1){if(!n&&e[t]===r)return;const o=e[t],i=e.length;r===void 0?delete e[t]:e[t]=r;let s=getDataNodes(e),l;(l=getDataNode(s,t,o))&&l.$(()=>r),Array.isArray(e)&&e.length!==i&&(l=getDataNode(s,"length",i))&&l.$(e.length),(l=s._)&&l.$()}function mergeStoreNode(e,t){const r=Object.keys(t);for(let n=0;n<r.length;n+=1){const o=r[n];setProperty(e,o,t[o])}}function updateArray(e,t){if(typeof t=="function"&&(t=t(e)),t=unwrap(t),Array.isArray(t)){if(e===t)return;let r=0,n=t.length;for(;r<n;r++){const o=t[r];e[r]!==o&&setProperty(e,r,o)}setProperty(e,"length",n)}else mergeStoreNode(e,t)}function updatePath(e,t,r=[]){let n,o=e;if(t.length>1){n=t.shift();const s=typeof n,l=Array.isArray(e);if(Array.isArray(n)){for(let c=0;c<n.length;c++)updatePath(e,[n[c]].concat(t),r);return}else if(l&&s==="function"){for(let c=0;c<e.length;c++)n(e[c],c)&&updatePath(e,[c].concat(t),r);return}else if(l&&s==="object"){const{from:c=0,to:d=e.length-1,by:f=1}=n;for(let m=c;m<=d;m+=f)updatePath(e,[m].concat(t),r);return}else if(t.length>1){updatePath(e[n],t,[n].concat(r));return}o=e[n],r=[n].concat(r)}let i=t[0];typeof i=="function"&&(i=i(o,r),i===o)||n===void 0&&i==null||(i=unwrap(i),n===void 0||isWrappable(o)&&isWrappable(i)&&!Array.isArray(i)?mergeStoreNode(o,i):setProperty(e,n,i))}function createStore(...[e,t]){const r=unwrap(e||{}),n=Array.isArray(r),o=wrap$1(r);function i(...s){batch(()=>{n&&s.length===1?updateArray(r,s[0]):updatePath(r,s)})}return[o,i]}const $ROOT=Symbol("store-root");function applyState(e,t,r,n,o){const i=t[r];if(e===i)return;if(!isWrappable(e)||!isWrappable(i)||o&&e[o]!==i[o]){if(e!==i){if(r===$ROOT)return e;setProperty(t,r,e)}return}if(Array.isArray(e)){if(e.length&&i.length&&(!n||o&&e[0][o]!=null)){let c,d,f,m,b,v,w,S;for(f=0,m=Math.min(i.length,e.length);f<m&&(i[f]===e[f]||o&&i[f][o]===e[f][o]);f++)applyState(e[f],i,f,n,o);const T=new Array(e.length),I=new Map;for(m=i.length-1,b=e.length-1;m>=f&&b>=f&&(i[m]===e[b]||o&&i[m][o]===e[b][o]);m--,b--)T[b]=i[m];if(f>b||f>m){for(d=f;d<=b;d++)setProperty(i,d,e[d]);for(;d<e.length;d++)setProperty(i,d,T[d]),applyState(e[d],i,d,n,o);i.length>e.length&&setProperty(i,"length",e.length);return}for(w=new Array(b+1),d=b;d>=f;d--)v=e[d],S=o?v[o]:v,c=I.get(S),w[d]=c===void 0?-1:c,I.set(S,d);for(c=f;c<=m;c++)v=i[c],S=o?v[o]:v,d=I.get(S),d!==void 0&&d!==-1&&(T[d]=i[c],d=w[d],I.set(S,d));for(d=f;d<e.length;d++)d in T?(setProperty(i,d,T[d]),applyState(e[d],i,d,n,o)):setProperty(i,d,e[d])}else for(let c=0,d=e.length;c<d;c++)applyState(e[c],i,c,n,o);i.length>e.length&&setProperty(i,"length",e.length);return}const s=Object.keys(e);for(let c=0,d=s.length;c<d;c++)applyState(e[s[c]],i,s[c],n,o);const l=Object.keys(i);for(let c=0,d=l.length;c<d;c++)e[l[c]]===void 0&&setProperty(i,l[c],void 0)}function reconcile(e,t={}){const{merge:r,key:n="id"}=t,o=unwrap(e);return i=>{if(!isWrappable(i)||!isWrappable(o))return o;const s=applyState(o,{[$ROOT]:i},$ROOT,r,n);return s===void 0?i:s}}const range=(e,t,r=1)=>[...new Array(Math.ceil((t-e)/r))].map((n,o)=>o*r);function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var localforage$1={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,o,i){function s(d,f){if(!o[d]){if(!n[d]){var m=typeof commonjsRequire=="function"&&commonjsRequire;if(!f&&m)return m(d,!0);if(l)return l(d,!0);var b=new Error("Cannot find module '"+d+"'");throw b.code="MODULE_NOT_FOUND",b}var v=o[d]={exports:{}};n[d][0].call(v.exports,function(w){var S=n[d][1][w];return s(S||w)},v,v.exports,r,n,o,i)}return o[d].exports}for(var l=typeof commonjsRequire=="function"&&commonjsRequire,c=0;c<i.length;c++)s(i[c]);return s}({1:[function(r,n,o){(function(i){var s=i.MutationObserver||i.WebKitMutationObserver,l;if(s){var c=0,d=new s(w),f=i.document.createTextNode("");d.observe(f,{characterData:!0}),l=function(){f.data=c=++c%2}}else if(!i.setImmediate&&typeof i.MessageChannel<"u"){var m=new i.MessageChannel;m.port1.onmessage=w,l=function(){m.port2.postMessage(0)}}else"document"in i&&"onreadystatechange"in i.document.createElement("script")?l=function(){var T=i.document.createElement("script");T.onreadystatechange=function(){w(),T.onreadystatechange=null,T.parentNode.removeChild(T),T=null},i.document.documentElement.appendChild(T)}:l=function(){setTimeout(w,0)};var b,v=[];function w(){b=!0;for(var T,I,N=v.length;N;){for(I=v,v=[],T=-1;++T<N;)I[T]();N=v.length}b=!1}n.exports=S;function S(T){v.push(T)===1&&!b&&l()}}).call(this,typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(r,n,o){var i=r(1);function s(){}var l={},c=["REJECTED"],d=["FULFILLED"],f=["PENDING"];n.exports=m;function m(E){if(typeof E!="function")throw new TypeError("resolver must be a function");this.state=f,this.queue=[],this.outcome=void 0,E!==s&&S(this,E)}m.prototype.catch=function(E){return this.then(null,E)},m.prototype.then=function(E,D){if(typeof E!="function"&&this.state===d||typeof D!="function"&&this.state===c)return this;var R=new this.constructor(s);if(this.state!==f){var W=this.state===d?E:D;v(R,W,this.outcome)}else this.queue.push(new b(R,E,D));return R};function b(E,D,R){this.promise=E,typeof D=="function"&&(this.onFulfilled=D,this.callFulfilled=this.otherCallFulfilled),typeof R=="function"&&(this.onRejected=R,this.callRejected=this.otherCallRejected)}b.prototype.callFulfilled=function(E){l.resolve(this.promise,E)},b.prototype.otherCallFulfilled=function(E){v(this.promise,this.onFulfilled,E)},b.prototype.callRejected=function(E){l.reject(this.promise,E)},b.prototype.otherCallRejected=function(E){v(this.promise,this.onRejected,E)};function v(E,D,R){i(function(){var W;try{W=D(R)}catch(q){return l.reject(E,q)}W===E?l.reject(E,new TypeError("Cannot resolve promise with itself")):l.resolve(E,W)})}l.resolve=function(E,D){var R=T(w,D);if(R.status==="error")return l.reject(E,R.value);var W=R.value;if(W)S(E,W);else{E.state=d,E.outcome=D;for(var q=-1,Y=E.queue.length;++q<Y;)E.queue[q].callFulfilled(D)}return E},l.reject=function(E,D){E.state=c,E.outcome=D;for(var R=-1,W=E.queue.length;++R<W;)E.queue[R].callRejected(D);return E};function w(E){var D=E&&E.then;if(E&&(typeof E=="object"||typeof E=="function")&&typeof D=="function")return function(){D.apply(E,arguments)}}function S(E,D){var R=!1;function W(C){R||(R=!0,l.reject(E,C))}function q(C){R||(R=!0,l.resolve(E,C))}function Y(){D(q,W)}var _=T(Y);_.status==="error"&&W(_.value)}function T(E,D){var R={};try{R.value=E(D),R.status="success"}catch(W){R.status="error",R.value=W}return R}m.resolve=I;function I(E){return E instanceof this?E:l.resolve(new this(s),E)}m.reject=N;function N(E){var D=new this(s);return l.reject(D,E)}m.all=F;function F(E){var D=this;if(Object.prototype.toString.call(E)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=E.length,W=!1;if(!R)return this.resolve([]);for(var q=new Array(R),Y=0,_=-1,C=new this(s);++_<R;)x(E[_],_);return C;function x(L,U){D.resolve(L).then(G,function(J){W||(W=!0,l.reject(C,J))});function G(J){q[U]=J,++Y===R&&!W&&(W=!0,l.resolve(C,q))}}}m.race=B;function B(E){var D=this;if(Object.prototype.toString.call(E)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=E.length,W=!1;if(!R)return this.resolve([]);for(var q=-1,Y=new this(s);++q<R;)_(E[q]);return Y;function _(C){D.resolve(C).then(function(x){W||(W=!0,l.resolve(Y,x))},function(x){W||(W=!0,l.reject(Y,x))})}}},{1:1}],3:[function(r,n,o){(function(i){typeof i.Promise!="function"&&(i.Promise=r(2))}).call(this,typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(r,n,o){var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};function s(a,h){if(!(a instanceof h))throw new TypeError("Cannot call a class as a function")}function l(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var c=l();function d(){try{if(!c||!c.open)return!1;var a=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),h=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!a||h)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function f(a,h){a=a||[],h=h||{};try{return new Blob(a,h)}catch(p){if(p.name!=="TypeError")throw p;for(var u=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,g=new u,y=0;y<a.length;y+=1)g.append(a[y]);return g.getBlob(h.type)}}typeof Promise>"u"&&r(3);var m=Promise;function b(a,h){h&&a.then(function(u){h(null,u)},function(u){h(u)})}function v(a,h,u){typeof h=="function"&&a.then(h),typeof u=="function"&&a.catch(u)}function w(a){return typeof a!="string"&&(console.warn(a+" used as a key, but it is not a string."),a=String(a)),a}function S(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var T="local-forage-detect-blob-support",I=void 0,N={},F=Object.prototype.toString,B="readonly",E="readwrite";function D(a){for(var h=a.length,u=new ArrayBuffer(h),g=new Uint8Array(u),y=0;y<h;y++)g[y]=a.charCodeAt(y);return u}function R(a){return new m(function(h){var u=a.transaction(T,E),g=f([""]);u.objectStore(T).put(g,"key"),u.onabort=function(y){y.preventDefault(),y.stopPropagation(),h(!1)},u.oncomplete=function(){var y=navigator.userAgent.match(/Chrome\/(\d+)/),p=navigator.userAgent.match(/Edge\//);h(p||!y||parseInt(y[1],10)>=43)}}).catch(function(){return!1})}function W(a){return typeof I=="boolean"?m.resolve(I):R(a).then(function(h){return I=h,I})}function q(a){var h=N[a.name],u={};u.promise=new m(function(g,y){u.resolve=g,u.reject=y}),h.deferredOperations.push(u),h.dbReady?h.dbReady=h.dbReady.then(function(){return u.promise}):h.dbReady=u.promise}function Y(a){var h=N[a.name],u=h.deferredOperations.pop();if(u)return u.resolve(),u.promise}function _(a,h){var u=N[a.name],g=u.deferredOperations.pop();if(g)return g.reject(h),g.promise}function C(a,h){return new m(function(u,g){if(N[a.name]=N[a.name]||ve(),a.db)if(h)q(a),a.db.close();else return u(a.db);var y=[a.name];h&&y.push(a.version);var p=c.open.apply(c,y);h&&(p.onupgradeneeded=function(k){var $=p.result;try{$.createObjectStore(a.storeName),k.oldVersion<=1&&$.createObjectStore(T)}catch(P){if(P.name==="ConstraintError")console.warn('The database "'+a.name+'" has been upgraded from version '+k.oldVersion+" to version "+k.newVersion+', but the storage "'+a.storeName+'" already exists.');else throw P}}),p.onerror=function(k){k.preventDefault(),g(p.error)},p.onsuccess=function(){var k=p.result;k.onversionchange=function($){$.target.close()},u(k),Y(a)}})}function x(a){return C(a,!1)}function L(a){return C(a,!0)}function U(a,h){if(!a.db)return!0;var u=!a.db.objectStoreNames.contains(a.storeName),g=a.version<a.db.version,y=a.version>a.db.version;if(g&&(a.version!==h&&console.warn('The database "'+a.name+`" can't be downgraded from version `+a.db.version+" to version "+a.version+"."),a.version=a.db.version),y||u){if(u){var p=a.db.version+1;p>a.version&&(a.version=p)}return!0}return!1}function G(a){return new m(function(h,u){var g=new FileReader;g.onerror=u,g.onloadend=function(y){var p=btoa(y.target.result||"");h({__local_forage_encoded_blob:!0,data:p,type:a.type})},g.readAsBinaryString(a)})}function J(a){var h=D(atob(a.data));return f([h],{type:a.type})}function z(a){return a&&a.__local_forage_encoded_blob}function Q(a){var h=this,u=h._initReady().then(function(){var g=N[h._dbInfo.name];if(g&&g.dbReady)return g.dbReady});return v(u,a,a),u}function K(a){q(a);for(var h=N[a.name],u=h.forages,g=0;g<u.length;g++){var y=u[g];y._dbInfo.db&&(y._dbInfo.db.close(),y._dbInfo.db=null)}return a.db=null,x(a).then(function(p){return a.db=p,U(a)?L(a):p}).then(function(p){a.db=h.db=p;for(var k=0;k<u.length;k++)u[k]._dbInfo.db=p}).catch(function(p){throw _(a,p),p})}function te(a,h,u,g){g===void 0&&(g=1);try{var y=a.db.transaction(a.storeName,h);u(null,y)}catch(p){if(g>0&&(!a.db||p.name==="InvalidStateError"||p.name==="NotFoundError"))return m.resolve().then(function(){if(!a.db||p.name==="NotFoundError"&&!a.db.objectStoreNames.contains(a.storeName)&&a.version<=a.db.version)return a.db&&(a.version=a.db.version+1),L(a)}).then(function(){return K(a).then(function(){te(a,h,u,g-1)})}).catch(u);u(p)}}function ve(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function We(a){var h=this,u={db:null};if(a)for(var g in a)u[g]=a[g];var y=N[u.name];y||(y=ve(),N[u.name]=y),y.forages.push(h),h._initReady||(h._initReady=h.ready,h.ready=Q);var p=[];function k(){return m.resolve()}for(var $=0;$<y.forages.length;$++){var P=y.forages[$];P!==h&&p.push(P._initReady().catch(k))}var A=y.forages.slice(0);return m.all(p).then(function(){return u.db=y.db,x(u)}).then(function(O){return u.db=O,U(u,h._defaultConfig.version)?L(u):O}).then(function(O){u.db=y.db=O,h._dbInfo=u;for(var M=0;M<A.length;M++){var j=A[M];j!==h&&(j._dbInfo.db=u.db,j._dbInfo.version=u.version)}})}function Be(a,h){var u=this;a=w(a);var g=new m(function(y,p){u.ready().then(function(){te(u._dbInfo,B,function(k,$){if(k)return p(k);try{var P=$.objectStore(u._dbInfo.storeName),A=P.get(a);A.onsuccess=function(){var O=A.result;O===void 0&&(O=null),z(O)&&(O=J(O)),y(O)},A.onerror=function(){p(A.error)}}catch(O){p(O)}})}).catch(p)});return b(g,h),g}function Fe(a,h){var u=this,g=new m(function(y,p){u.ready().then(function(){te(u._dbInfo,B,function(k,$){if(k)return p(k);try{var P=$.objectStore(u._dbInfo.storeName),A=P.openCursor(),O=1;A.onsuccess=function(){var M=A.result;if(M){var j=M.value;z(j)&&(j=J(j));var H=a(j,M.key,O++);H!==void 0?y(H):M.continue()}else y()},A.onerror=function(){p(A.error)}}catch(M){p(M)}})}).catch(p)});return b(g,h),g}function Ue(a,h,u){var g=this;a=w(a);var y=new m(function(p,k){var $;g.ready().then(function(){return $=g._dbInfo,F.call(h)==="[object Blob]"?W($.db).then(function(P){return P?h:G(h)}):h}).then(function(P){te(g._dbInfo,E,function(A,O){if(A)return k(A);try{var M=O.objectStore(g._dbInfo.storeName);P===null&&(P=void 0);var j=M.put(P,a);O.oncomplete=function(){P===void 0&&(P=null),p(P)},O.onabort=O.onerror=function(){var H=j.error?j.error:j.transaction.error;k(H)}}catch(H){k(H)}})}).catch(k)});return b(y,u),y}function je(a,h){var u=this;a=w(a);var g=new m(function(y,p){u.ready().then(function(){te(u._dbInfo,E,function(k,$){if(k)return p(k);try{var P=$.objectStore(u._dbInfo.storeName),A=P.delete(a);$.oncomplete=function(){y()},$.onerror=function(){p(A.error)},$.onabort=function(){var O=A.error?A.error:A.transaction.error;p(O)}}catch(O){p(O)}})}).catch(p)});return b(g,h),g}function ze(a){var h=this,u=new m(function(g,y){h.ready().then(function(){te(h._dbInfo,E,function(p,k){if(p)return y(p);try{var $=k.objectStore(h._dbInfo.storeName),P=$.clear();k.oncomplete=function(){g()},k.onabort=k.onerror=function(){var A=P.error?P.error:P.transaction.error;y(A)}}catch(A){y(A)}})}).catch(y)});return b(u,a),u}function qe(a){var h=this,u=new m(function(g,y){h.ready().then(function(){te(h._dbInfo,B,function(p,k){if(p)return y(p);try{var $=k.objectStore(h._dbInfo.storeName),P=$.count();P.onsuccess=function(){g(P.result)},P.onerror=function(){y(P.error)}}catch(A){y(A)}})}).catch(y)});return b(u,a),u}function He(a,h){var u=this,g=new m(function(y,p){if(a<0){y(null);return}u.ready().then(function(){te(u._dbInfo,B,function(k,$){if(k)return p(k);try{var P=$.objectStore(u._dbInfo.storeName),A=!1,O=P.openKeyCursor();O.onsuccess=function(){var M=O.result;if(!M){y(null);return}a===0||A?y(M.key):(A=!0,M.advance(a))},O.onerror=function(){p(O.error)}}catch(M){p(M)}})}).catch(p)});return b(g,h),g}function Ve(a){var h=this,u=new m(function(g,y){h.ready().then(function(){te(h._dbInfo,B,function(p,k){if(p)return y(p);try{var $=k.objectStore(h._dbInfo.storeName),P=$.openKeyCursor(),A=[];P.onsuccess=function(){var O=P.result;if(!O){g(A);return}A.push(O.key),O.continue()},P.onerror=function(){y(P.error)}}catch(O){y(O)}})}).catch(y)});return b(u,a),u}function Ke(a,h){h=S.apply(this,arguments);var u=this.config();a=typeof a!="function"&&a||{},a.name||(a.name=a.name||u.name,a.storeName=a.storeName||u.storeName);var g=this,y;if(!a.name)y=m.reject("Invalid arguments");else{var p=a.name===u.name&&g._dbInfo.db,k=p?m.resolve(g._dbInfo.db):x(a).then(function($){var P=N[a.name],A=P.forages;P.db=$;for(var O=0;O<A.length;O++)A[O]._dbInfo.db=$;return $});a.storeName?y=k.then(function($){if(!!$.objectStoreNames.contains(a.storeName)){var P=$.version+1;q(a);var A=N[a.name],O=A.forages;$.close();for(var M=0;M<O.length;M++){var j=O[M];j._dbInfo.db=null,j._dbInfo.version=P}var H=new m(function(V,Z){var X=c.open(a.name,P);X.onerror=function(ee){var se=X.result;se.close(),Z(ee)},X.onupgradeneeded=function(){var ee=X.result;ee.deleteObjectStore(a.storeName)},X.onsuccess=function(){var ee=X.result;ee.close(),V(ee)}});return H.then(function(V){A.db=V;for(var Z=0;Z<O.length;Z++){var X=O[Z];X._dbInfo.db=V,Y(X._dbInfo)}}).catch(function(V){throw(_(a,V)||m.resolve()).catch(function(){}),V})}}):y=k.then(function($){q(a);var P=N[a.name],A=P.forages;$.close();for(var O=0;O<A.length;O++){var M=A[O];M._dbInfo.db=null}var j=new m(function(H,V){var Z=c.deleteDatabase(a.name);Z.onerror=function(){var X=Z.result;X&&X.close(),V(Z.error)},Z.onblocked=function(){console.warn('dropInstance blocked for database "'+a.name+'" until all open connections are closed')},Z.onsuccess=function(){var X=Z.result;X&&X.close(),H(X)}});return j.then(function(H){P.db=H;for(var V=0;V<A.length;V++){var Z=A[V];Y(Z._dbInfo)}}).catch(function(H){throw(_(a,H)||m.resolve()).catch(function(){}),H})})}return b(y,h),y}var Ye={_driver:"asyncStorage",_initStorage:We,_support:d(),iterate:Fe,getItem:Be,setItem:Ue,removeItem:je,clear:ze,length:qe,key:He,keys:Ve,dropInstance:Ke};function Ge(){return typeof openDatabase=="function"}var re="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Qe="~~local_forage_type~",be=/^~~local_forage_type~([^~]+)~/,ae="__lfsc__:",ce=ae.length,ue="arbf",fe="blob",we="si08",_e="ui08",ke="uic8",xe="si16",Ee="si32",Se="ur16",$e="ui32",Ce="fl32",Pe="fl64",Ae=ce+ue.length,Te=Object.prototype.toString;function Oe(a){var h=a.length*.75,u=a.length,g,y=0,p,k,$,P;a[a.length-1]==="="&&(h--,a[a.length-2]==="="&&h--);var A=new ArrayBuffer(h),O=new Uint8Array(A);for(g=0;g<u;g+=4)p=re.indexOf(a[g]),k=re.indexOf(a[g+1]),$=re.indexOf(a[g+2]),P=re.indexOf(a[g+3]),O[y++]=p<<2|k>>4,O[y++]=(k&15)<<4|$>>2,O[y++]=($&3)<<6|P&63;return A}function de(a){var h=new Uint8Array(a),u="",g;for(g=0;g<h.length;g+=3)u+=re[h[g]>>2],u+=re[(h[g]&3)<<4|h[g+1]>>4],u+=re[(h[g+1]&15)<<2|h[g+2]>>6],u+=re[h[g+2]&63];return h.length%3===2?u=u.substring(0,u.length-1)+"=":h.length%3===1&&(u=u.substring(0,u.length-2)+"=="),u}function Xe(a,h){var u="";if(a&&(u=Te.call(a)),a&&(u==="[object ArrayBuffer]"||a.buffer&&Te.call(a.buffer)==="[object ArrayBuffer]")){var g,y=ae;a instanceof ArrayBuffer?(g=a,y+=ue):(g=a.buffer,u==="[object Int8Array]"?y+=we:u==="[object Uint8Array]"?y+=_e:u==="[object Uint8ClampedArray]"?y+=ke:u==="[object Int16Array]"?y+=xe:u==="[object Uint16Array]"?y+=Se:u==="[object Int32Array]"?y+=Ee:u==="[object Uint32Array]"?y+=$e:u==="[object Float32Array]"?y+=Ce:u==="[object Float64Array]"?y+=Pe:h(new Error("Failed to get type for BinaryArray"))),h(y+de(g))}else if(u==="[object Blob]"){var p=new FileReader;p.onload=function(){var k=Qe+a.type+"~"+de(this.result);h(ae+fe+k)},p.readAsArrayBuffer(a)}else try{h(JSON.stringify(a))}catch(k){console.error("Couldn't convert value into a JSON string: ",a),h(null,k)}}function Ze(a){if(a.substring(0,ce)!==ae)return JSON.parse(a);var h=a.substring(Ae),u=a.substring(ce,Ae),g;if(u===fe&&be.test(h)){var y=h.match(be);g=y[1],h=h.substring(y[0].length)}var p=Oe(h);switch(u){case ue:return p;case fe:return f([p],{type:g});case we:return new Int8Array(p);case _e:return new Uint8Array(p);case ke:return new Uint8ClampedArray(p);case xe:return new Int16Array(p);case Se:return new Uint16Array(p);case Ee:return new Int32Array(p);case $e:return new Uint32Array(p);case Ce:return new Float32Array(p);case Pe:return new Float64Array(p);default:throw new Error("Unkown type: "+u)}}var he={serialize:Xe,deserialize:Ze,stringToBuffer:Oe,bufferToString:de};function Re(a,h,u,g){a.executeSql("CREATE TABLE IF NOT EXISTS "+h.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],u,g)}function Je(a){var h=this,u={db:null};if(a)for(var g in a)u[g]=typeof a[g]!="string"?a[g].toString():a[g];var y=new m(function(p,k){try{u.db=openDatabase(u.name,String(u.version),u.description,u.size)}catch($){return k($)}u.db.transaction(function($){Re($,u,function(){h._dbInfo=u,p()},function(P,A){k(A)})},k)});return u.serializer=he,y}function ne(a,h,u,g,y,p){a.executeSql(u,g,y,function(k,$){$.code===$.SYNTAX_ERR?k.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[h.storeName],function(P,A){A.rows.length?p(P,$):Re(P,h,function(){P.executeSql(u,g,y,p)},p)},p):p(k,$)},p)}function et(a,h){var u=this;a=w(a);var g=new m(function(y,p){u.ready().then(function(){var k=u._dbInfo;k.db.transaction(function($){ne($,k,"SELECT * FROM "+k.storeName+" WHERE key = ? LIMIT 1",[a],function(P,A){var O=A.rows.length?A.rows.item(0).value:null;O&&(O=k.serializer.deserialize(O)),y(O)},function(P,A){p(A)})})}).catch(p)});return b(g,h),g}function tt(a,h){var u=this,g=new m(function(y,p){u.ready().then(function(){var k=u._dbInfo;k.db.transaction(function($){ne($,k,"SELECT * FROM "+k.storeName,[],function(P,A){for(var O=A.rows,M=O.length,j=0;j<M;j++){var H=O.item(j),V=H.value;if(V&&(V=k.serializer.deserialize(V)),V=a(V,H.key,j+1),V!==void 0){y(V);return}}y()},function(P,A){p(A)})})}).catch(p)});return b(g,h),g}function Ie(a,h,u,g){var y=this;a=w(a);var p=new m(function(k,$){y.ready().then(function(){h===void 0&&(h=null);var P=h,A=y._dbInfo;A.serializer.serialize(h,function(O,M){M?$(M):A.db.transaction(function(j){ne(j,A,"INSERT OR REPLACE INTO "+A.storeName+" (key, value) VALUES (?, ?)",[a,O],function(){k(P)},function(H,V){$(V)})},function(j){if(j.code===j.QUOTA_ERR){if(g>0){k(Ie.apply(y,[a,P,u,g-1]));return}$(j)}})})}).catch($)});return b(p,u),p}function rt(a,h,u){return Ie.apply(this,[a,h,u,1])}function nt(a,h){var u=this;a=w(a);var g=new m(function(y,p){u.ready().then(function(){var k=u._dbInfo;k.db.transaction(function($){ne($,k,"DELETE FROM "+k.storeName+" WHERE key = ?",[a],function(){y()},function(P,A){p(A)})})}).catch(p)});return b(g,h),g}function ot(a){var h=this,u=new m(function(g,y){h.ready().then(function(){var p=h._dbInfo;p.db.transaction(function(k){ne(k,p,"DELETE FROM "+p.storeName,[],function(){g()},function($,P){y(P)})})}).catch(y)});return b(u,a),u}function it(a){var h=this,u=new m(function(g,y){h.ready().then(function(){var p=h._dbInfo;p.db.transaction(function(k){ne(k,p,"SELECT COUNT(key) as c FROM "+p.storeName,[],function($,P){var A=P.rows.item(0).c;g(A)},function($,P){y(P)})})}).catch(y)});return b(u,a),u}function st(a,h){var u=this,g=new m(function(y,p){u.ready().then(function(){var k=u._dbInfo;k.db.transaction(function($){ne($,k,"SELECT key FROM "+k.storeName+" WHERE id = ? LIMIT 1",[a+1],function(P,A){var O=A.rows.length?A.rows.item(0).key:null;y(O)},function(P,A){p(A)})})}).catch(p)});return b(g,h),g}function at(a){var h=this,u=new m(function(g,y){h.ready().then(function(){var p=h._dbInfo;p.db.transaction(function(k){ne(k,p,"SELECT key FROM "+p.storeName,[],function($,P){for(var A=[],O=0;O<P.rows.length;O++)A.push(P.rows.item(O).key);g(A)},function($,P){y(P)})})}).catch(y)});return b(u,a),u}function lt(a){return new m(function(h,u){a.transaction(function(g){g.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(y,p){for(var k=[],$=0;$<p.rows.length;$++)k.push(p.rows.item($).name);h({db:a,storeNames:k})},function(y,p){u(p)})},function(g){u(g)})})}function ct(a,h){h=S.apply(this,arguments);var u=this.config();a=typeof a!="function"&&a||{},a.name||(a.name=a.name||u.name,a.storeName=a.storeName||u.storeName);var g=this,y;return a.name?y=new m(function(p){var k;a.name===u.name?k=g._dbInfo.db:k=openDatabase(a.name,"","",0),a.storeName?p({db:k,storeNames:[a.storeName]}):p(lt(k))}).then(function(p){return new m(function(k,$){p.db.transaction(function(P){function A(H){return new m(function(V,Z){P.executeSql("DROP TABLE IF EXISTS "+H,[],function(){V()},function(X,ee){Z(ee)})})}for(var O=[],M=0,j=p.storeNames.length;M<j;M++)O.push(A(p.storeNames[M]));m.all(O).then(function(){k()}).catch(function(H){$(H)})},function(P){$(P)})})}):y=m.reject("Invalid arguments"),b(y,h),y}var ut={_driver:"webSQLStorage",_initStorage:Je,_support:Ge(),iterate:tt,getItem:et,setItem:rt,removeItem:nt,clear:ot,length:it,key:st,keys:at,dropInstance:ct};function ft(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function Ne(a,h){var u=a.name+"/";return a.storeName!==h.storeName&&(u+=a.storeName+"/"),u}function dt(){var a="_localforage_support_test";try{return localStorage.setItem(a,!0),localStorage.removeItem(a),!1}catch{return!0}}function ht(){return!dt()||localStorage.length>0}function pt(a){var h=this,u={};if(a)for(var g in a)u[g]=a[g];return u.keyPrefix=Ne(a,h._defaultConfig),ht()?(h._dbInfo=u,u.serializer=he,m.resolve()):m.reject()}function mt(a){var h=this,u=h.ready().then(function(){for(var g=h._dbInfo.keyPrefix,y=localStorage.length-1;y>=0;y--){var p=localStorage.key(y);p.indexOf(g)===0&&localStorage.removeItem(p)}});return b(u,a),u}function gt(a,h){var u=this;a=w(a);var g=u.ready().then(function(){var y=u._dbInfo,p=localStorage.getItem(y.keyPrefix+a);return p&&(p=y.serializer.deserialize(p)),p});return b(g,h),g}function yt(a,h){var u=this,g=u.ready().then(function(){for(var y=u._dbInfo,p=y.keyPrefix,k=p.length,$=localStorage.length,P=1,A=0;A<$;A++){var O=localStorage.key(A);if(O.indexOf(p)===0){var M=localStorage.getItem(O);if(M&&(M=y.serializer.deserialize(M)),M=a(M,O.substring(k),P++),M!==void 0)return M}}});return b(g,h),g}function vt(a,h){var u=this,g=u.ready().then(function(){var y=u._dbInfo,p;try{p=localStorage.key(a)}catch{p=null}return p&&(p=p.substring(y.keyPrefix.length)),p});return b(g,h),g}function bt(a){var h=this,u=h.ready().then(function(){for(var g=h._dbInfo,y=localStorage.length,p=[],k=0;k<y;k++){var $=localStorage.key(k);$.indexOf(g.keyPrefix)===0&&p.push($.substring(g.keyPrefix.length))}return p});return b(u,a),u}function wt(a){var h=this,u=h.keys().then(function(g){return g.length});return b(u,a),u}function _t(a,h){var u=this;a=w(a);var g=u.ready().then(function(){var y=u._dbInfo;localStorage.removeItem(y.keyPrefix+a)});return b(g,h),g}function kt(a,h,u){var g=this;a=w(a);var y=g.ready().then(function(){h===void 0&&(h=null);var p=h;return new m(function(k,$){var P=g._dbInfo;P.serializer.serialize(h,function(A,O){if(O)$(O);else try{localStorage.setItem(P.keyPrefix+a,A),k(p)}catch(M){(M.name==="QuotaExceededError"||M.name==="NS_ERROR_DOM_QUOTA_REACHED")&&$(M),$(M)}})})});return b(y,u),y}function xt(a,h){if(h=S.apply(this,arguments),a=typeof a!="function"&&a||{},!a.name){var u=this.config();a.name=a.name||u.name,a.storeName=a.storeName||u.storeName}var g=this,y;return a.name?y=new m(function(p){a.storeName?p(Ne(a,g._defaultConfig)):p(a.name+"/")}).then(function(p){for(var k=localStorage.length-1;k>=0;k--){var $=localStorage.key(k);$.indexOf(p)===0&&localStorage.removeItem($)}}):y=m.reject("Invalid arguments"),b(y,h),y}var Et={_driver:"localStorageWrapper",_initStorage:pt,_support:ft(),iterate:yt,getItem:gt,setItem:kt,removeItem:_t,clear:mt,length:wt,key:vt,keys:bt,dropInstance:xt},St=function(h,u){return h===u||typeof h=="number"&&typeof u=="number"&&isNaN(h)&&isNaN(u)},$t=function(h,u){for(var g=h.length,y=0;y<g;){if(St(h[y],u))return!0;y++}return!1},Le=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"},ie={},De={},oe={INDEXEDDB:Ye,WEBSQL:ut,LOCALSTORAGE:Et},Ct=[oe.INDEXEDDB._driver,oe.WEBSQL._driver,oe.LOCALSTORAGE._driver],le=["dropInstance"],pe=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(le),Pt={description:"",driver:Ct.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function At(a,h){a[h]=function(){var u=arguments;return a.ready().then(function(){return a[h].apply(a,u)})}}function me(){for(var a=1;a<arguments.length;a++){var h=arguments[a];if(h)for(var u in h)h.hasOwnProperty(u)&&(Le(h[u])?arguments[0][u]=h[u].slice():arguments[0][u]=h[u])}return arguments[0]}var Tt=function(){function a(h){s(this,a);for(var u in oe)if(oe.hasOwnProperty(u)){var g=oe[u],y=g._driver;this[u]=y,ie[y]||this.defineDriver(g)}this._defaultConfig=me({},Pt),this._config=me({},this._defaultConfig,h),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return a.prototype.config=function(u){if((typeof u>"u"?"undefined":i(u))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var g in u){if(g==="storeName"&&(u[g]=u[g].replace(/\W/g,"_")),g==="version"&&typeof u[g]!="number")return new Error("Database version must be a number.");this._config[g]=u[g]}return"driver"in u&&u.driver?this.setDriver(this._config.driver):!0}else return typeof u=="string"?this._config[u]:this._config},a.prototype.defineDriver=function(u,g,y){var p=new m(function(k,$){try{var P=u._driver,A=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!u._driver){$(A);return}for(var O=pe.concat("_initStorage"),M=0,j=O.length;M<j;M++){var H=O[M],V=!$t(le,H);if((V||u[H])&&typeof u[H]!="function"){$(A);return}}var Z=function(){for(var se=function(It){return function(){var Nt=new Error("Method "+It+" is not implemented by the current driver"),Me=m.reject(Nt);return b(Me,arguments[arguments.length-1]),Me}},ge=0,Rt=le.length;ge<Rt;ge++){var ye=le[ge];u[ye]||(u[ye]=se(ye))}};Z();var X=function(se){ie[P]&&console.info("Redefining LocalForage driver: "+P),ie[P]=u,De[P]=se,k()};"_support"in u?u._support&&typeof u._support=="function"?u._support().then(X,$):X(!!u._support):X(!0)}catch(ee){$(ee)}});return v(p,g,y),p},a.prototype.driver=function(){return this._driver||null},a.prototype.getDriver=function(u,g,y){var p=ie[u]?m.resolve(ie[u]):m.reject(new Error("Driver not found."));return v(p,g,y),p},a.prototype.getSerializer=function(u){var g=m.resolve(he);return v(g,u),g},a.prototype.ready=function(u){var g=this,y=g._driverSet.then(function(){return g._ready===null&&(g._ready=g._initDriver()),g._ready});return v(y,u,u),y},a.prototype.setDriver=function(u,g,y){var p=this;Le(u)||(u=[u]);var k=this._getSupportedDrivers(u);function $(){p._config.driver=p.driver()}function P(M){return p._extend(M),$(),p._ready=p._initStorage(p._config),p._ready}function A(M){return function(){var j=0;function H(){for(;j<M.length;){var V=M[j];return j++,p._dbInfo=null,p._ready=null,p.getDriver(V).then(P).catch(H)}$();var Z=new Error("No available storage method found.");return p._driverSet=m.reject(Z),p._driverSet}return H()}}var O=this._driverSet!==null?this._driverSet.catch(function(){return m.resolve()}):m.resolve();return this._driverSet=O.then(function(){var M=k[0];return p._dbInfo=null,p._ready=null,p.getDriver(M).then(function(j){p._driver=j._driver,$(),p._wrapLibraryMethodsWithReady(),p._initDriver=A(k)})}).catch(function(){$();var M=new Error("No available storage method found.");return p._driverSet=m.reject(M),p._driverSet}),v(this._driverSet,g,y),this._driverSet},a.prototype.supports=function(u){return!!De[u]},a.prototype._extend=function(u){me(this,u)},a.prototype._getSupportedDrivers=function(u){for(var g=[],y=0,p=u.length;y<p;y++){var k=u[y];this.supports(k)&&g.push(k)}return g},a.prototype._wrapLibraryMethodsWithReady=function(){for(var u=0,g=pe.length;u<g;u++)At(this,pe[u])},a.prototype.createInstance=function(u){return new a(u)},a}(),Ot=new Tt;n.exports=Ot},{3:3}]},{},[4])(4)})})(localforage$1);const localforage=localforage$1.exports;var FUNC_ERROR_TEXT="Expected a function",NAN=0/0,symbolTag="[object Symbol]",reTrim=/^\s+|\s+$/g,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt,freeGlobal=typeof commonjsGlobal=="object"&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),objectProto=Object.prototype,objectToString=objectProto.toString,nativeMax=Math.max,nativeMin=Math.min,now=function(){return root.Date.now()};function debounce$1(e,t,r){var n,o,i,s,l,c,d=0,f=!1,m=!1,b=!0;if(typeof e!="function")throw new TypeError(FUNC_ERROR_TEXT);t=toNumber(t)||0,isObject(r)&&(f=!!r.leading,m="maxWait"in r,i=m?nativeMax(toNumber(r.maxWait)||0,t):i,b="trailing"in r?!!r.trailing:b);function v(D){var R=n,W=o;return n=o=void 0,d=D,s=e.apply(W,R),s}function w(D){return d=D,l=setTimeout(I,t),f?v(D):s}function S(D){var R=D-c,W=D-d,q=t-R;return m?nativeMin(q,i-W):q}function T(D){var R=D-c,W=D-d;return c===void 0||R>=t||R<0||m&&W>=i}function I(){var D=now();if(T(D))return N(D);l=setTimeout(I,S(D))}function N(D){return l=void 0,b&&n?v(D):(n=o=void 0,s)}function F(){l!==void 0&&clearTimeout(l),d=0,n=c=o=l=void 0}function B(){return l===void 0?s:N(now())}function E(){var D=now(),R=T(D);if(n=arguments,o=this,c=D,R){if(l===void 0)return w(c);if(m)return l=setTimeout(I,t),v(c)}return l===void 0&&(l=setTimeout(I,t)),s}return E.cancel=F,E.flush=B,E}function isObject(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function isObjectLike(e){return!!e&&typeof e=="object"}function isSymbol(e){return typeof e=="symbol"||isObjectLike(e)&&objectToString.call(e)==symbolTag}function toNumber(e){if(typeof e=="number")return e;if(isSymbol(e))return NAN;if(isObject(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=isObject(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(reTrim,"");var r=reIsBinary.test(e);return r||reIsOctal.test(e)?freeParseInt(e.slice(2),r?2:8):reIsBadHex.test(e)?NAN:+e}var lodash_debounce=debounce$1;const defaultState=Object.freeze({cursor:0,mode:"slice",cursorControlsVisible:!1,clip:void 0,regions:[{start:0,end:1}],selectedRegion:void 0}),[store,setStore]=createStore(defaultState),state=store,[undoStack,setUndoStack]=createSignal([],{equals:!1}),[redoStack,setRedoStack]=createSignal([],{equals:!1});let lastModified;window.localforage=localforage;const reset=()=>{setUndoStack([]),setRedoStack([]),setStore(defaultState)},dispatch=e=>{switch(e.type){case"reset":{syncStorage().then(reset);break}case"setClip":{setUndoStack([]),setRedoStack([]),setStore("clip",e.clip),localforage.getItem("sessions").then(t=>{const r=t,n=r.get(e.clip.hash);n?loadSession(n):(r.set(e.clip.hash,{alias:e.clip.name,hash:e.clip.hash,lastModified:Date.now(),numberOfChannels:e.clip.buffer.numberOfChannels,sampleRate:e.clip.buffer.sampleRate,length:e.clip.buffer.length}),localforage.setItem("sessions",r))}),saveChannels(e.clip);break}case"setCursor":{setStore("cursor",Math.max(0,Math.min(e.pos,1)));break}case"showCursorControls":{setStore("cursorControlsVisible",!0);break}case"hideCursorControls":{setStore("cursorControlsVisible",!1);break}case"setMode":{setStore("mode",e.mode);break}case"selectRegion":{setStore("selectedRegion",e.index);break}default:{const t=undoStack()[undoStack().length-1];lastModified!==void 0&&e.type==="moveSlice"&&t?.forward.type==="moveSlice"&&e.index===t?.forward.index&&Date.now()-lastModified<1e3?setUndoStack(r=>(r[r.length-1]={forward:e,backward:t.backward},r)):setUndoStack(r=>(r.push(migrationOfEvent(e)),r)),setRedoStack([]),updateRegions(e)}}},migrationOfEvent=e=>{switch(e.type){case"slice":return{forward:e,backward:{type:"healSlice",index:e.index+1}};case"segmentRegion":return{forward:e,backward:{type:"combineRegions",startIndex:e.index,endIndex:e.index+e.pieces-1}};case"combineRegions":return{forward:e,backward:{type:"segmentRegion",index:e.startIndex,pieces:e.endIndex-e.startIndex}};case"healSlice":return{forward:e,backward:{type:"slice",index:e.index-1,pos:state.regions[e.index].start}};case"moveSlice":return{forward:e,backward:{...e,pos:state.regions[e.index].start}}}},updateRegions=e=>{switch(e.type){case"slice":{const t=store.regions[e.index];if(!t||e.pos<=t.start||e.pos>=t.end)return;same(player.region(),t)&&player.stop(),setStore("regions",r=>[...r.slice(0,e.index),{start:t.start,end:e.pos},{start:e.pos,end:t.end},...r.slice(e.index+1)]);break}case"segmentRegion":{const t=store.regions[e.index];if(!t)return;const r=(t.end-t.start)/e.pieces;same(player.region(),t)&&player.stop(),setStore("regions",n=>[...n.slice(0,e.index),...range(0,e.pieces).map(o=>({start:t.start+r*o,end:t.start+r*(o+1)})),...n.slice(e.index+1)]);break}case"combineRegions":{if(!state.regions[e.startIndex]||!state.regions[e.endIndex]||e.endIndex<=e.startIndex)return;state.selectedRegion&&state.selectedRegion>e.startIndex&&(state.selectedRegion<=e.endIndex?setStore("selectedRegion",e.startIndex):setStore("selectedRegion",state.selectedRegion-(e.endIndex-e.startIndex))),setStore("regions",t=>{const r=t[e.startIndex],n=t[e.endIndex];return!r||!n?t:[...t.slice(0,e.startIndex),{start:r.start,end:n.end},...t.slice(e.endIndex+1)]});break}case"healSlice":{const t=store.regions[e.index],r=store.regions[e.index-1];if(!t||!r)return;(same(player.region(),t)||same(player.region(),r))&&player.stop(),setStore("regions",n=>[...n.slice(0,e.index).map((o,i)=>i===e.index-1?{start:o.start,end:n[e.index+1]?.start||1}:o),...n.slice(e.index+1)]);break}case"moveSlice":{const t=store.regions[e.index],r=store.regions[e.index-1];if(!t||!r||e.pos<=r.start||e.pos>=t.end)return;(same(player.region(),t)||same(player.region(),r))&&player.stop(),setStore("regions",e.index-1,n=>({start:n.start,end:e.pos})),setStore("regions",e.index,n=>({start:e.pos,end:n.end}));break}}lastModified=Date.now(),lodash_debounce(syncStorage)()};window.dispatch=dispatch;window.state=state;const same=(e,t)=>e.start===t.start&&e.end===t.end,tabSyncChannel=new BroadcastChannel("tab-sync");tabSyncChannel.addEventListener("message",e=>{!state.clip?.hash||e.data!==state.clip.hash||lodash_debounce(syncState,1e3)()});tabSyncChannel.addEventListener("message",e=>{e.data==="DELETE_SESSIONS"&&state.clip&&reset()});const undo={execute:()=>{const e=undoStack().pop();setUndoStack(t=>t),e&&(setRedoStack(t=>(t.push(e),t)),updateRegions(e.backward),state.selectedRegion&&state.selectedRegion>=state.regions.length&&setStore("selectedRegion",state.regions.length-1)),lodash_debounce(syncStorage)(),lastModified=Date.now()},disabled:()=>undoStack().length===0},redo={execute:()=>{const e=redoStack().pop();console.log(e),setRedoStack(t=>t),e&&(updateRegions(e.forward),undoStack().push(e),setUndoStack(t=>t)),lodash_debounce(syncStorage)(),lastModified=Date.now()},disabled:()=>redoStack().length===0},[busy,setBusy]=createSignal(!1),syncState=async()=>{setBusy(!0);try{const e=state.clip;if(!e)return;const r=(await localforage.getItem("sessions")).get(e.hash);if(!r||lastModified===void 0||r.lastModified<=lastModified)return;await loadSession(r),lastModified=r.lastModified}finally{setBusy(!1)}};async function loadSession(e){const t=e.sampleRate,r=e.numberOfChannels,n=e.alias;if(state.clip?.hash!==e.hash){const o=await localforage.getItem(e.hash+"_0"),i=await localforage.getItem(e.hash+"_0"),l=[o,i].filter(Boolean)[0]?.length;if(!l)throw new Error("no channel data for "+e.hash);const c=audioContext.createBuffer(r,l,t);for(let d=0;d<r;d++){const f=await localforage.getItem(e.hash+"_"+d);c.copyToChannel(f,d)}setStore("clip",{name:n,buffer:c,hash:e.hash})}await localforage.getItem(e.hash+"_regions").then(o=>{if(!Array.isArray(o))return;const i=o.map((s,l,c)=>({start:s,end:c[l+1]||1}));setStore("regions",i)}),setUndoStack(await localforage.getItem(e.hash+"_undoStack")||[]),setRedoStack(await localforage.getItem(e.hash+"_redoStack")||[])}const syncStorage=async()=>{const e=state.clip;!e||(await localforage.setItem(e.hash+"_redoStack",redoStack()),await localforage.setItem(e.hash+"_undoStack",undoStack()),await localforage.setItem(e.hash+"_regions",store.regions.map(t=>t.start)),await localforage.getItem("sessions").then(t=>{const r=t===null?new Map:t,n=r.get(e.hash),o={hash:e.hash,alias:e.name,sampleRate:e.buffer.sampleRate,numberOfChannels:e.buffer.numberOfChannels,lastModified:lastModified||n?.lastModified||Date.now(),length:e.buffer.length};r.set(e.hash,o),localforage.setItem("sessions",r)}),tabSyncChannel.postMessage(e.hash))},saveChannels=e=>{for(let t=0;t<e.buffer.numberOfChannels;t++)localforage.setItem(e.hash+"_"+t,e.buffer.getChannelData(t))};await localforage.keys().then(e=>!e.includes("sessions"))&&localforage.setItem("sessions",new Map);const deleteSessions=async()=>{tabSyncChannel.postMessage("DELETE_SESSIONS"),await localforage.clear(),await localforage.setItem("sessions",new Map)};/**
 * solid-virtual
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 *//**
 * virtual-core
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var props=["bottom","height","left","right","top","width"],rectChanged=function(t,r){return t===void 0&&(t={}),r===void 0&&(r={}),props.some(function(n){return t[n]!==r[n]})},observedNodes=new Map,rafId,run=function e(){var t=[];observedNodes.forEach(function(r,n){var o=n.getBoundingClientRect();rectChanged(o,r.rect)&&(r.rect=o,t.push(r))}),t.forEach(function(r){r.callbacks.forEach(function(n){return n(r.rect)})}),rafId=window.requestAnimationFrame(e)};function observeRect(e,t){return{observe:function(){var n=observedNodes.size===0;observedNodes.has(e)?observedNodes.get(e).callbacks.push(t):observedNodes.set(e,{rect:void 0,hasRectChanged:!1,callbacks:[t]}),n&&run()},unobserve:function(){var n=observedNodes.get(e);if(n){var o=n.callbacks.indexOf(t);o>=0&&n.callbacks.splice(o,1),n.callbacks.length||observedNodes.delete(e),observedNodes.size||cancelAnimationFrame(rafId)}}}}function memo(e,t,r){let n=[],o;return()=>{let i;r.key&&r.debug!=null&&r.debug()&&(i=Date.now());const s=e();if(!(s.length!==n.length||s.some((d,f)=>n[f]!==d)))return o;n=s;let c;if(r.key&&r.debug!=null&&r.debug()&&(c=Date.now()),o=t(...s),r==null||r.onChange==null||r.onChange(o),r.key&&r.debug!=null&&r.debug()){const d=Math.round((Date.now()-i)*100)/100,f=Math.round((Date.now()-c)*100)/100,m=f/16,b=(v,w)=>{for(v=String(v);v.length<w;)v=" "+v;return v};console.info("%c\u23F1 "+b(f,5)+" /"+b(d,5)+" ms",`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(`+Math.max(0,Math.min(120-120*m,120))+"deg 100% 31%);",r?.key)}return o}}const defaultKeyExtractor=e=>e,defaultRangeExtractor=e=>{const t=Math.max(e.startIndex-e.overscan,0),r=Math.min(e.endIndex+e.overscan,e.count-1),n=[];for(let o=t;o<=r;o++)n.push(o);return n},observeElementRect=(e,t)=>{const r=observeRect(e.scrollElement,n=>{t(n)});if(!!e.scrollElement)return t(e.scrollElement.getBoundingClientRect()),r.observe(),()=>{r.unobserve()}},observeElementOffset=(e,t)=>{const r=()=>t(e.scrollElement[e.options.horizontal?"scrollLeft":"scrollTop"]);if(!!e.scrollElement)return r(),e.scrollElement.addEventListener("scroll",r,{capture:!1,passive:!0}),()=>{e.scrollElement.removeEventListener("scroll",r)}},measureElement=(e,t)=>e.getBoundingClientRect()[t.options.horizontal?"width":"height"],elementScroll=(e,t,r)=>{var n;(n=r.scrollElement)==null||n.scrollTo({[r.options.horizontal?"left":"top"]:e,behavior:t?"smooth":void 0})};class Virtualizer{constructor(t){var r=this;this.unsubs=[],this.scrollElement=null,this.measurementsCache=[],this.itemMeasurementsCache={},this.pendingMeasuredCacheIndexes=[],this.measureElementCache={},this.setOptions=n=>{Object.entries(n).forEach(o=>{let[i,s]=o;typeof s>"u"&&delete n[i]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:defaultKeyExtractor,rangeExtractor:defaultRangeExtractor,enableSmoothScroll:!0,onChange:()=>{},measureElement,initialRect:{width:0,height:0},...n}},this.notify=()=>{var n,o;(n=(o=this.options).onChange)==null||n.call(o,this)},this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(n=>n()),this.unsubs=[]},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{const n=this.options.getScrollElement();this.scrollElement!==n&&(this.cleanup(),this.scrollElement=n,this.unsubs.push(this.options.observeElementRect(this,o=>{this.scrollRect=o,this.notify()})),this.unsubs.push(this.options.observeElementOffset(this,o=>{this.scrollOffset=o,this.notify()})))},this.getSize=()=>this.scrollRect[this.options.horizontal?"width":"height"],this.getMeasurements=memo(()=>[this.options.count,this.options.paddingStart,this.options.getItemKey,this.itemMeasurementsCache],(n,o,i,s)=>{const l=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const c=this.measurementsCache.slice(0,l);for(let d=l;d<n;d++){const f=i(d),m=s[f],b=c[d-1]?c[d-1].end:o,v=typeof m=="number"?m:this.options.estimateSize(d),w=b+v;c[d]={index:d,start:b,size:v,end:w,key:f}}return this.measurementsCache=c,c},{key:!1,debug:()=>this.options.debug}),this.calculateRange=memo(()=>[this.getMeasurements(),this.getSize(),this.scrollOffset],(n,o,i)=>calculateRange({measurements:n,outerSize:o,scrollOffset:i}),{key:!1,debug:()=>this.options.debug}),this.getIndexes=memo(()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count],(n,o,i,s)=>n({...o,overscan:i,count:s}),{key:!1}),this.getVirtualItems=memo(()=>[this.getIndexes(),this.getMeasurements(),this.options.measureElement],(n,o,i)=>{const s=f=>m=>{var b;const v=this.measurementsCache[f];if(!m)return;const w=i(m,this),S=(b=this.itemMeasurementsCache[v.key])!=null?b:v.size;w!==S&&(v.start<this.scrollOffset&&(this.destinationOffset||this._scrollToOffset(this.scrollOffset+(w-S),!1)),this.pendingMeasuredCacheIndexes.push(f),this.itemMeasurementsCache={...this.itemMeasurementsCache,[v.key]:w},this.notify())},l=[],c={};for(let f=0,m=n.length;f<m;f++){var d;const b=n[f],w={...o[b],measureElement:c[b]=(d=this.measureElementCache[b])!=null?d:s(b)};l.push(w)}return this.measureElementCache=c,l},{key:!1}),this.scrollToOffset=function(n,o){let{align:i}=o===void 0?{align:"start"}:o;const s=()=>{const l=r.scrollOffset,c=r.getSize();i==="auto"&&(n<=l?i="start":n>=l+c?i="end":i="start"),i==="start"?r._scrollToOffset(n,!0):i==="end"?r._scrollToOffset(n-c,!0):i==="center"&&r._scrollToOffset(n-c/2,!0)};s(),requestAnimationFrame(()=>{s()})},this.scrollToIndex=function(n,o){let{align:i,...s}=o===void 0?{align:"auto"}:o;const l=r.getMeasurements(),c=r.scrollOffset,d=r.getSize(),{count:f}=r.options,m=l[Math.max(0,Math.min(n,f-1))];if(!m)return;if(i==="auto")if(m.end>=c+d-r.options.scrollPaddingEnd)i="end";else if(m.start<=c+r.options.scrollPaddingStart)i="start";else return;const b=i==="end"?m.end+r.options.scrollPaddingEnd:m.start-r.options.scrollPaddingStart;r.scrollToOffset(b,{align:i,...s})},this.getTotalSize=()=>{var n;return(((n=this.getMeasurements()[this.options.count-1])==null?void 0:n.end)||this.options.paddingStart)+this.options.paddingEnd},this._scrollToOffset=(n,o)=>{clearTimeout(this.scrollCheckFrame),this.destinationOffset=n,this.options.scrollToFn(n,this.options.enableSmoothScroll&&o,this);let i;const s=()=>{let l=this.scrollOffset;this.scrollCheckFrame=i=setTimeout(()=>{if(this.scrollCheckFrame===i){if(this.scrollOffset===l){this.destinationOffset=void 0;return}l=this.scrollOffset,s()}},100)};s()},this.measure=()=>{this.itemMeasurementsCache={},this.notify()},this.setOptions(t),this.scrollRect=this.options.initialRect,this.scrollOffset=this.options.initialOffset}}const findNearestBinarySearch=(e,t,r,n)=>{for(;e<=t;){const o=(e+t)/2|0,i=r(o);if(i<n)e=o+1;else if(i>n)t=o-1;else return o}return e>0?e-1:0};function calculateRange(e){let{measurements:t,outerSize:r,scrollOffset:n}=e;const o=t.length-1,s=findNearestBinarySearch(0,o,c=>t[c].start,n);let l=s;for(;l<o&&t[l].end<n+r;)l++;return{startIndex:s,endIndex:l}}function createVirtualizerBase(e){const t=mergeProps(e),r=new Virtualizer(t),[n,o]=createStore(r.getVirtualItems()),[i,s]=createSignal(r.getTotalSize()),l={get(d,f){switch(f){case"getVirtualItems":return()=>n;case"getTotalSize":return()=>i();default:return Reflect.get(d,f)}}},c=new Proxy(r,l);return c.setOptions(t),onMount(()=>{const d=c._didMount();c._willUpdate(),onCleanup(d)}),createComputed(()=>{c.setOptions(mergeProps(t,e,{onChange:d=>{d._willUpdate(),o(reconcile(d.getVirtualItems(),{key:"index"})),s(d.getTotalSize()),e.onChange==null||e.onChange(d)}})),c.measure()}),c}function createVirtualizer(e){return createVirtualizerBase(mergeProps({observeElementRect,observeElementOffset,scrollToFn:elementScroll},e))}var workerpool$1={exports:{}};/**
 * workerpool.js
 * https://github.com/josdejong/workerpool
 *
 * Offload tasks to a pool of workers on node.js and in the browser.
 *
 * @version 6.4.0
 * @date    2023-02-24
 *
 * @license
 * Copyright (C) 2014-2022 Jos de Jong <wjosdejong@gmail.com>
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy
 * of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations under
 * the License.
 */(function(module,exports){(function(t,r){module.exports=r()})(typeof self<"u"?self:commonjsGlobal,function(){return function(){var __webpack_modules__={345:function(e,t,r){var n=r(219),o=r(751),i=r(828),s=r(833),l=new s;function c(v,w){typeof v=="string"?this.script=v||null:(this.script=null,w=v),this.workers=[],this.tasks=[],w=w||{},this.forkArgs=Object.freeze(w.forkArgs||[]),this.forkOpts=Object.freeze(w.forkOpts||{}),this.workerThreadOpts=Object.freeze(w.workerThreadOpts||{}),this.debugPortStart=w.debugPortStart||43210,this.nodeWorker=w.nodeWorker,this.workerType=w.workerType||w.nodeWorker||"auto",this.maxQueueSize=w.maxQueueSize||1/0,this.workerTerminateTimeout=w.workerTerminateTimeout||1e3,this.onCreateWorker=w.onCreateWorker||function(){return null},this.onTerminateWorker=w.onTerminateWorker||function(){return null},w&&"maxWorkers"in w?(d(w.maxWorkers),this.maxWorkers=w.maxWorkers):this.maxWorkers=Math.max((i.cpus||4)-1,1),w&&"minWorkers"in w&&(w.minWorkers==="max"?this.minWorkers=this.maxWorkers:(f(w.minWorkers),this.minWorkers=w.minWorkers,this.maxWorkers=Math.max(this.minWorkers,this.maxWorkers)),this._ensureMinWorkers()),this._boundNext=this._next.bind(this),this.workerType==="thread"&&o.ensureWorkerThreads()}c.prototype.exec=function(v,w,S){if(w&&!Array.isArray(w))throw new TypeError('Array expected as argument "params"');if(typeof v=="string"){var T=n.defer();if(this.tasks.length>=this.maxQueueSize)throw new Error("Max queue size of "+this.maxQueueSize+" reached");var I=this.tasks,N={method:v,params:w,resolver:T,timeout:null,options:S};I.push(N);var F=T.promise.timeout;return T.promise.timeout=function(E){return I.indexOf(N)!==-1?(N.timeout=E,T.promise):F.call(T.promise,E)},this._next(),T.promise}else{if(typeof v=="function")return this.exec("run",[String(v),w]);throw new TypeError('Function or string expected as argument "method"')}},c.prototype.proxy=function(){if(arguments.length>0)throw new Error("No arguments expected");var v=this;return this.exec("methods").then(function(w){var S={};return w.forEach(function(T){S[T]=function(){return v.exec(T,Array.prototype.slice.call(arguments))}}),S})},c.prototype._next=function(){if(this.tasks.length>0){var v=this._getWorker();if(v){var w=this,S=this.tasks.shift();if(S.resolver.promise.pending){var T=v.exec(S.method,S.params,S.resolver,S.options).then(w._boundNext).catch(function(){if(v.terminated)return w._removeWorker(v)}).then(function(){w._next()});typeof S.timeout=="number"&&T.timeout(S.timeout)}else w._next()}}},c.prototype._getWorker=function(){for(var v=this.workers,w=0;w<v.length;w++){var S=v[w];if(S.busy()===!1)return S}return v.length<this.maxWorkers?(S=this._createWorkerHandler(),v.push(S),S):null},c.prototype._removeWorker=function(v){var w=this;return l.releasePort(v.debugPort),this._removeWorkerFromList(v),this._ensureMinWorkers(),new n(function(S,T){v.terminate(!1,function(I){w.onTerminateWorker({forkArgs:v.forkArgs,forkOpts:v.forkOpts,workerThreadOpts:v.workerThreadOpts,script:v.script}),I?T(I):S(v)})})},c.prototype._removeWorkerFromList=function(v){var w=this.workers.indexOf(v);w!==-1&&this.workers.splice(w,1)},c.prototype.terminate=function(v,w){var S=this;this.tasks.forEach(function(B){B.resolver.reject(new Error("Pool terminated"))}),this.tasks.length=0;var T=function(E){l.releasePort(E.debugPort),this._removeWorkerFromList(E)},I=T.bind(this),N=[],F=this.workers.slice();return F.forEach(function(B){var E=B.terminateAndNotify(v,w).then(I).always(function(){S.onTerminateWorker({forkArgs:B.forkArgs,forkOpts:B.forkOpts,workerThreadOpts:B.workerThreadOpts,script:B.script})});N.push(E)}),n.all(N)},c.prototype.stats=function(){var v=this.workers.length,w=this.workers.filter(function(S){return S.busy()}).length;return{totalWorkers:v,busyWorkers:w,idleWorkers:v-w,pendingTasks:this.tasks.length,activeTasks:w}},c.prototype._ensureMinWorkers=function(){if(this.minWorkers)for(var v=this.workers.length;v<this.minWorkers;v++)this.workers.push(this._createWorkerHandler())},c.prototype._createWorkerHandler=function(){var v=this.onCreateWorker({forkArgs:this.forkArgs,forkOpts:this.forkOpts,workerThreadOpts:this.workerThreadOpts,script:this.script})||{};return new o(v.script||this.script,{forkArgs:v.forkArgs||this.forkArgs,forkOpts:v.forkOpts||this.forkOpts,workerThreadOpts:v.workerThreadOpts||this.workerThreadOpts,debugPort:l.nextAvailableStartingAt(this.debugPortStart),workerType:this.workerType,workerTerminateTimeout:this.workerTerminateTimeout})};function d(v){if(!m(v)||!b(v)||v<1)throw new TypeError("Option maxWorkers must be an integer number >= 1")}function f(v){if(!m(v)||!b(v)||v<0)throw new TypeError("Option minWorkers must be an integer number >= 0")}function m(v){return typeof v=="number"}function b(v){return Math.round(v)==v}e.exports=c},219:function(e){function t(i,s){var l=this;if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(typeof i!="function")throw new SyntaxError("Function parameter handler(resolve, reject) missing");var c=[],d=[];this.resolved=!1,this.rejected=!1,this.pending=!0;var f=function(w,S){c.push(w),d.push(S)};this.then=function(v,w){return new t(function(S,T){var I=v?r(v,S,T):S,N=w?r(w,S,T):T;f(I,N)},l)};var m=function(w){return l.resolved=!0,l.rejected=!1,l.pending=!1,c.forEach(function(S){S(w)}),f=function(T,I){T(w)},m=b=function(){},l},b=function(w){return l.resolved=!1,l.rejected=!0,l.pending=!1,d.forEach(function(S){S(w)}),f=function(T,I){I(w)},m=b=function(){},l};this.cancel=function(){return s?s.cancel():b(new n),l},this.timeout=function(v){if(s)s.timeout(v);else{var w=setTimeout(function(){b(new o("Promise timed out after "+v+" ms"))},v);l.always(function(){clearTimeout(w)})}return l},i(function(v){m(v)},function(v){b(v)})}function r(i,s,l){return function(c){try{var d=i(c);d&&typeof d.then=="function"&&typeof d.catch=="function"?d.then(s,l):s(d)}catch(f){l(f)}}}t.prototype.catch=function(i){return this.then(null,i)},t.prototype.always=function(i){return this.then(i,i)},t.all=function(i){return new t(function(s,l){var c=i.length,d=[];c?i.forEach(function(f,m){f.then(function(b){d[m]=b,c--,c==0&&s(d)},function(b){c=0,l(b)})}):s(d)})},t.defer=function(){var i={};return i.promise=new t(function(s,l){i.resolve=s,i.reject=l}),i};function n(i){this.message=i||"promise cancelled",this.stack=new Error().stack}n.prototype=new Error,n.prototype.constructor=Error,n.prototype.name="CancellationError",t.CancellationError=n;function o(i){this.message=i||"timeout exceeded",this.stack=new Error().stack}o.prototype=new Error,o.prototype.constructor=Error,o.prototype.name="TimeoutError",t.TimeoutError=o,e.exports=t},751:function(e,t,r){function n(_,C){var x=typeof Symbol<"u"&&_[Symbol.iterator]||_["@@iterator"];if(!x){if(Array.isArray(_)||(x=o(_))||C&&_&&typeof _.length=="number"){x&&(_=x);var L=0,U=function(){};return{s:U,n:function(){return L>=_.length?{done:!0}:{done:!1,value:_[L++]}},e:function(K){throw K},f:U}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var G=!0,J=!1,z;return{s:function(){x=x.call(_)},n:function(){var K=x.next();return G=K.done,K},e:function(K){J=!0,z=K},f:function(){try{!G&&x.return!=null&&x.return()}finally{if(J)throw z}}}}function o(_,C){if(!!_){if(typeof _=="string")return i(_,C);var x=Object.prototype.toString.call(_).slice(8,-1);if(x==="Object"&&_.constructor&&(x=_.constructor.name),x==="Map"||x==="Set")return Array.from(_);if(x==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(x))return i(_,C)}}function i(_,C){(C==null||C>_.length)&&(C=_.length);for(var x=0,L=new Array(C);x<C;x++)L[x]=_[x];return L}function s(_,C){var x=Object.keys(_);if(Object.getOwnPropertySymbols){var L=Object.getOwnPropertySymbols(_);C&&(L=L.filter(function(U){return Object.getOwnPropertyDescriptor(_,U).enumerable})),x.push.apply(x,L)}return x}function l(_){for(var C=1;C<arguments.length;C++){var x=arguments[C]!=null?arguments[C]:{};C%2?s(Object(x),!0).forEach(function(L){c(_,L,x[L])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(x)):s(Object(x)).forEach(function(L){Object.defineProperty(_,L,Object.getOwnPropertyDescriptor(x,L))})}return _}function c(_,C,x){return C=d(C),C in _?Object.defineProperty(_,C,{value:x,enumerable:!0,configurable:!0,writable:!0}):_[C]=x,_}function d(_){var C=f(_,"string");return m(C)==="symbol"?C:String(C)}function f(_,C){if(m(_)!=="object"||_===null)return _;var x=_[Symbol.toPrimitive];if(x!==void 0){var L=x.call(_,C||"default");if(m(L)!=="object")return L;throw new TypeError("@@toPrimitive must return a primitive value.")}return(C==="string"?String:Number)(_)}function m(_){return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},m(_)}var b=r(219),v=r(828),w=r(397),S="__workerpool-terminate__";function T(){var _=N();if(!_)throw new Error("WorkerPool: workerType = 'thread' is not supported, Node >= 11.7.0 required");return _}function I(){if(typeof Worker!="function"&&((typeof Worker>"u"?"undefined":m(Worker))!=="object"||typeof Worker.prototype.constructor!="function"))throw new Error("WorkerPool: Web Workers not supported")}function N(){try{return w("worker_threads")}catch(_){if(m(_)==="object"&&_!==null&&_.code==="MODULE_NOT_FOUND")return null;throw _}}function F(){if(v.platform==="browser"){if(typeof Blob>"u")throw new Error("Blob not supported by the browser");if(!window.URL||typeof window.URL.createObjectURL!="function")throw new Error("URL.createObjectURL not supported by the browser");var _=new Blob([r(670)],{type:"text/javascript"});return window.URL.createObjectURL(_)}else return __dirname+"/worker.js"}function B(_,C){if(C.workerType==="web")return I(),E(_,Worker);if(C.workerType==="thread")return x=T(),D(_,x,C.workerThreadOpts);if(C.workerType==="process"||!C.workerType)return R(_,W(C),w("child_process"));if(v.platform==="browser")return I(),E(_,Worker);var x=N();return x?D(_,x):R(_,W(C),w("child_process"))}function E(_,C){var x=new C(_);return x.isBrowserWorker=!0,x.on=function(L,U){this.addEventListener(L,function(G){U(G.data)})},x.send=function(L,U){this.postMessage(L,U)},x}function D(_,C,x){var L=new C.Worker(_,l({stdout:!1,stderr:!1},x));return L.isWorkerThread=!0,L.send=function(U,G){this.postMessage(U,G)},L.kill=function(){return this.terminate(),!0},L.disconnect=function(){this.terminate()},L}function R(_,C,x){var L=x.fork(_,C.forkArgs,C.forkOpts),U=L.send;return L.send=function(G){return U.call(L,G)},L.isChildProcess=!0,L}function W(_){_=_||{};var C=process.execArgv.join(" "),x=C.indexOf("--inspect")!==-1,L=C.indexOf("--debug-brk")!==-1,U=[];return x&&(U.push("--inspect="+_.debugPort),L&&U.push("--debug-brk")),process.execArgv.forEach(function(G){G.indexOf("--max-old-space-size")>-1&&U.push(G)}),Object.assign({},_,{forkArgs:_.forkArgs,forkOpts:Object.assign({},_.forkOpts,{execArgv:(_.forkOpts&&_.forkOpts.execArgv||[]).concat(U)})})}function q(_){for(var C=new Error(""),x=Object.keys(_),L=0;L<x.length;L++)C[x[L]]=_[x[L]];return C}function Y(_,C){var x=this,L=C||{};this.script=_||F(),this.worker=B(this.script,L),this.debugPort=L.debugPort,this.forkOpts=L.forkOpts,this.forkArgs=L.forkArgs,this.workerThreadOpts=L.workerThreadOpts,this.workerTerminateTimeout=L.workerTerminateTimeout,_||(this.worker.ready=!0),this.requestQueue=[],this.worker.on("message",function(z){if(!x.terminated)if(typeof z=="string"&&z==="ready")x.worker.ready=!0,G();else{var Q=z.id,K=x.processing[Q];K!==void 0&&(z.isEvent?K.options&&typeof K.options.on=="function"&&K.options.on(z.payload):(delete x.processing[Q],x.terminating===!0&&x.terminate(),z.error?K.resolver.reject(q(z.error)):K.resolver.resolve(z.result)))}});function U(z){x.terminated=!0;for(var Q in x.processing)x.processing[Q]!==void 0&&x.processing[Q].resolver.reject(z);x.processing=Object.create(null)}function G(){var z=n(x.requestQueue.splice(0)),Q;try{for(z.s();!(Q=z.n()).done;){var K=Q.value;x.worker.send(K.message,K.transfer)}}catch(te){z.e(te)}finally{z.f()}}var J=this.worker;this.worker.on("error",U),this.worker.on("exit",function(z,Q){var K=`Workerpool Worker terminated Unexpectedly
`;K+="    exitCode: `"+z+"`\n",K+="    signalCode: `"+Q+"`\n",K+="    workerpool.script: `"+x.script+"`\n",K+="    spawnArgs: `"+J.spawnargs+"`\n",K+="    spawnfile: `"+J.spawnfile+"`\n",K+="    stdout: `"+J.stdout+"`\n",K+="    stderr: `"+J.stderr+"`\n",U(new Error(K))}),this.processing=Object.create(null),this.terminating=!1,this.terminated=!1,this.cleaning=!1,this.terminationHandler=null,this.lastId=0}Y.prototype.methods=function(){return this.exec("methods")},Y.prototype.exec=function(_,C,x,L){x||(x=b.defer());var U=++this.lastId;this.processing[U]={id:U,resolver:x,options:L};var G={message:{id:U,method:_,params:C},transfer:L&&L.transfer};this.terminated?x.reject(new Error("Worker is terminated")):this.worker.ready?this.worker.send(G.message,G.transfer):this.requestQueue.push(G);var J=this;return x.promise.catch(function(z){if(z instanceof b.CancellationError||z instanceof b.TimeoutError)return delete J.processing[U],J.terminateAndNotify(!0).then(function(){throw z},function(Q){throw Q});throw z})},Y.prototype.busy=function(){return this.cleaning||Object.keys(this.processing).length>0},Y.prototype.terminate=function(_,C){var x=this;if(_){for(var L in this.processing)this.processing[L]!==void 0&&this.processing[L].resolver.reject(new Error("Worker terminated"));this.processing=Object.create(null)}if(typeof C=="function"&&(this.terminationHandler=C),this.busy())this.terminating=!0;else{var U=function(z){if(x.terminated=!0,x.cleaning=!1,x.worker!=null&&x.worker.removeAllListeners&&x.worker.removeAllListeners("message"),x.worker=null,x.terminating=!1,x.terminationHandler)x.terminationHandler(z,x);else if(z)throw z};if(this.worker)if(typeof this.worker.kill=="function"){if(this.worker.killed){U(new Error("worker already killed!"));return}var G=setTimeout(function(){x.worker&&x.worker.kill()},this.workerTerminateTimeout);this.worker.once("exit",function(){clearTimeout(G),x.worker&&(x.worker.killed=!0),U()}),this.worker.ready?this.worker.send(S):this.requestQueue.push(S),this.cleaning=!0;return}else if(typeof this.worker.terminate=="function")this.worker.terminate(),this.worker.killed=!0;else throw new Error("Failed to terminate worker");U()}},Y.prototype.terminateAndNotify=function(_,C){var x=b.defer();return C&&(x.promise.timeout=C),this.terminate(_,function(L,U){L?x.reject(L):x.resolve(U)}),x.promise},e.exports=Y,e.exports._tryRequireWorkerThreads=N,e.exports._setupProcessWorker=R,e.exports._setupBrowserWorker=E,e.exports._setupWorkerThreadWorker=D,e.exports.ensureWorkerThreads=T},833:function(e){var t=65535;e.exports=r;function r(){this.ports=Object.create(null),this.length=0}r.prototype.nextAvailableStartingAt=function(n){for(;this.ports[n]===!0;)n++;if(n>=t)throw new Error("WorkerPool debug port limit reached: "+n+">= "+t);return this.ports[n]=!0,this.length++,n},r.prototype.releasePort=function(n){delete this.ports[n],this.length--}},828:function(e,t,r){var n=r(397),o=function(c){return typeof c<"u"&&c.versions!=null&&c.versions.node!=null};e.exports.isNode=o,e.exports.platform=typeof process<"u"&&o(process)?"node":"browser";var i=s("worker_threads");e.exports.isMainThread=e.exports.platform==="node"?(!i||i.isMainThread)&&!process.connected:typeof Window<"u",e.exports.cpus=e.exports.platform==="browser"?self.navigator.hardwareConcurrency:n("os").cpus().length;function s(l){try{return n(l)}catch{return null}}},670:function(e){e.exports=`!function(){var __webpack_modules__={577:function(e){e.exports=function(e,r){this.message=e,this.transfer=r}}},__webpack_module_cache__={};function __webpack_require__(e){var r=__webpack_module_cache__[e];return void 0!==r||(r=__webpack_module_cache__[e]={exports:{}},__webpack_modules__[e](r,r.exports,__webpack_require__)),r.exports}var __webpack_exports__={};!function(){var exports=__webpack_exports__,__webpack_unused_export__;function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Transfer=__webpack_require__(577),requireFoolWebpack=eval("typeof require !== 'undefined' ? require : function (module) { throw new Error('Module \\" + module + \\" not found.') }"),TERMINATE_METHOD_ID="__workerpool-terminate__",worker={exit:function(){}},WorkerThreads,parentPort;if("undefined"!=typeof self&&"function"==typeof postMessage&&"function"==typeof addEventListener)worker.on=function(e,r){addEventListener(e,function(e){r(e.data)})},worker.send=function(e){postMessage(e)};else{if("undefined"==typeof process)throw new Error("Script must be executed as a worker");try{WorkerThreads=requireFoolWebpack("worker_threads")}catch(error){if("object"!==_typeof(error)||null===error||"MODULE_NOT_FOUND"!==error.code)throw error}WorkerThreads&&null!==WorkerThreads.parentPort?(parentPort=WorkerThreads.parentPort,worker.send=parentPort.postMessage.bind(parentPort),worker.on=parentPort.on.bind(parentPort)):(worker.on=process.on.bind(process),worker.send=function(e){process.send(e)},worker.on("disconnect",function(){process.exit(1)})),worker.exit=process.exit.bind(process)}function convertError(o){return Object.getOwnPropertyNames(o).reduce(function(e,r){return Object.defineProperty(e,r,{value:o[r],enumerable:!0})},{})}function isPromise(e){return e&&"function"==typeof e.then&&"function"==typeof e.catch}worker.methods={},worker.methods.run=function(e,r){e=new Function("return ("+e+").apply(null, arguments);");return e.apply(e,r)},worker.methods.methods=function(){return Object.keys(worker.methods)},worker.terminationHandler=void 0,worker.cleanupAndExit=function(e){function r(){worker.exit(e)}if(!worker.terminationHandler)return r();var o=worker.terminationHandler(e);isPromise(o)?o.then(r,r):r()};var currentRequestId=null;worker.on("message",function(r){if(r===TERMINATE_METHOD_ID)return worker.cleanupAndExit(0);try{var e=worker.methods[r.method];if(!e)throw new Error('Unknown method "'+r.method+'"');currentRequestId=r.id;var o=e.apply(e,r.params);isPromise(o)?o.then(function(e){e instanceof Transfer?worker.send({id:r.id,result:e.message,error:null},e.transfer):worker.send({id:r.id,result:e,error:null}),currentRequestId=null}).catch(function(e){worker.send({id:r.id,result:null,error:convertError(e)}),currentRequestId=null}):(o instanceof Transfer?worker.send({id:r.id,result:o.message,error:null},o.transfer):worker.send({id:r.id,result:o,error:null}),currentRequestId=null)}catch(e){worker.send({id:r.id,result:null,error:convertError(e)})}}),worker.register=function(e,r){if(e)for(var o in e)e.hasOwnProperty(o)&&(worker.methods[o]=e[o]);r&&(worker.terminationHandler=r.onTerminate),worker.send("ready")},worker.emit=function(e){currentRequestId&&(e instanceof Transfer?worker.send({id:currentRequestId,isEvent:!0,payload:e.message},e.transfer):worker.send({id:currentRequestId,isEvent:!0,payload:e}))},__webpack_unused_export__=worker.register,worker.emit}()}();`},397:function(module){var requireFoolWebpack=eval(`typeof require !== 'undefined' ? require : function (module) { throw new Error('Module " + module + " not found.') }`);module.exports=requireFoolWebpack},577:function(e){function t(r,n){this.message=r,this.transfer=n}e.exports=t},744:function(__unused_webpack_module,exports,__webpack_require__){function _typeof(e){return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(e)}var Transfer=__webpack_require__(577),requireFoolWebpack=eval(`typeof require !== 'undefined' ? require : function (module) { throw new Error('Module " + module + " not found.') }`),TERMINATE_METHOD_ID="__workerpool-terminate__",worker={exit:function e(){}};if(typeof self<"u"&&typeof postMessage=="function"&&typeof addEventListener=="function")worker.on=function(e,t){addEventListener(e,function(r){t(r.data)})},worker.send=function(e){postMessage(e)};else if(typeof process<"u"){var WorkerThreads;try{WorkerThreads=requireFoolWebpack("worker_threads")}catch(e){if(!(_typeof(e)==="object"&&e!==null&&e.code==="MODULE_NOT_FOUND"))throw e}if(WorkerThreads&&WorkerThreads.parentPort!==null){var parentPort=WorkerThreads.parentPort;worker.send=parentPort.postMessage.bind(parentPort),worker.on=parentPort.on.bind(parentPort),worker.exit=process.exit.bind(process)}else worker.on=process.on.bind(process),worker.send=function(e){process.send(e)},worker.on("disconnect",function(){process.exit(1)}),worker.exit=process.exit.bind(process)}else throw new Error("Script must be executed as a worker");function convertError(e){return Object.getOwnPropertyNames(e).reduce(function(t,r){return Object.defineProperty(t,r,{value:e[r],enumerable:!0})},{})}function isPromise(e){return e&&typeof e.then=="function"&&typeof e.catch=="function"}worker.methods={},worker.methods.run=function e(t,r){var n=new Function("return ("+t+").apply(null, arguments);");return n.apply(n,r)},worker.methods.methods=function e(){return Object.keys(worker.methods)},worker.terminationHandler=void 0,worker.cleanupAndExit=function(e){var t=function(){worker.exit(e)};if(!worker.terminationHandler)return t();var r=worker.terminationHandler(e);isPromise(r)?r.then(t,t):t()};var currentRequestId=null;worker.on("message",function(e){if(e===TERMINATE_METHOD_ID)return worker.cleanupAndExit(0);try{var t=worker.methods[e.method];if(t){currentRequestId=e.id;var r=t.apply(t,e.params);isPromise(r)?r.then(function(n){n instanceof Transfer?worker.send({id:e.id,result:n.message,error:null},n.transfer):worker.send({id:e.id,result:n,error:null}),currentRequestId=null}).catch(function(n){worker.send({id:e.id,result:null,error:convertError(n)}),currentRequestId=null}):(r instanceof Transfer?worker.send({id:e.id,result:r.message,error:null},r.transfer):worker.send({id:e.id,result:r,error:null}),currentRequestId=null)}else throw new Error('Unknown method "'+e.method+'"')}catch(n){worker.send({id:e.id,result:null,error:convertError(n)})}}),worker.register=function(e,t){if(e)for(var r in e)e.hasOwnProperty(r)&&(worker.methods[r]=e[r]);t&&(worker.terminationHandler=t.onTerminate),worker.send("ready")},worker.emit=function(e){if(currentRequestId){if(e instanceof Transfer){worker.send({id:currentRequestId,isEvent:!0,payload:e.message},e.transfer);return}worker.send({id:currentRequestId,isEvent:!0,payload:e})}},exports.add=worker.register,exports.emit=worker.emit}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(t!==void 0)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](r,r.exports,__webpack_require__),r.exports}var __webpack_exports__={};return function(){var e=__webpack_exports__,t=__webpack_require__(828);e.pool=function(n,o){var i=__webpack_require__(345);return new i(n,o)},e.worker=function(n,o){var i=__webpack_require__(744);i.add(n,o)},e.workerEmit=function(n){var o=__webpack_require__(744);o.emit(n)},e.Promise=__webpack_require__(219),e.Transfer=__webpack_require__(577),e.platform=t.platform,e.isMainThread=t.isMainThread,e.cpus=t.cpus}(),__webpack_exports__}()})})(workerpool$1);const workerpool=workerpool$1.exports,_tmpl$$7=template("<canvas></canvas>"),mediaQuery=window.matchMedia("(prefers-color-scheme: dark)"),[strokeColor,setStrokeColor]=createSignal(mediaQuery.matches?"white":"black");createEffect(()=>console.log(strokeColor()));mediaQuery.addEventListener("change",e=>{console.log(e),e.matches?setStrokeColor("white"):setStrokeColor("black")});const ChannelSegment=e=>{let t,r;return onCleanup(()=>{r?.cancel()}),createEffect(async()=>{const n=strokeColor();r?.cancel(),r=pool.exec(computeBuckets,[e.data,e.numBuckets]).then(o=>{t&&drawBars(t,o,n)}).catch(o=>{o.message!=="promise cancelled"&&console.error(o)})}),(()=>{const n=_tmpl$$7.cloneNode(!0),o=t;return typeof o=="function"?use(o,n):t=n,createRenderEffect(i=>{const s=e.width,l=e.height,c={width:"100%",height:"100%",...e.style};return s!==i._v$&&setAttribute(n,"width",i._v$=s),l!==i._v$2&&setAttribute(n,"height",i._v$2=l),i._v$3=style$1(n,c,i._v$3),i},{_v$:void 0,_v$2:void 0,_v$3:void 0}),n})()},pool=workerpool.pool();function computeBuckets(e,t){const r=Math.ceil(e.length/t),n=[];let o=0;for(let i=0;i<t;i++){const s=o+r,l=e.subarray(o,s);let c=1/0;for(const f of l)c=Math.min(f,c);let d=-1/0;for(const f of l)d=Math.max(f,d);n.push({min:c,max:d}),o=s}return n}const drawBars=(e,t,r="black")=>{const n=e.getContext("2d");if(!n)return;const o=2;n.lineWidth=o,n.strokeStyle=r,n.clearRect(0,0,e.width,e.height),n.translate(0,e.height/2);for(let i=0;i<t.length;i++){const s=t[i];if(!s)return;const{min:l,max:c}=s;n.beginPath(),n.moveTo(i,c*(e.height/2)+o/2),n.lineTo(i,l*(e.height/2)-o/2),n.stroke()}n.translate(0,-e.height/2)},createDrag=e=>{let t;const[r,n]=createSignal(0),o=l=>{e.onStart?.(l),t=l.clientX,document.body.addEventListener("pointerup",i),document.body.addEventListener("pointerleave",i),document.body.addEventListener("pointermove",s)},i=l=>{e.onFinished?.(l),t=void 0,document.body.removeEventListener("pointerup",i),document.body.removeEventListener("pointerleave",i),document.body.removeEventListener("pointermove",s),n(0)},s=l=>{t!==void 0&&(e.onDrag?.(l),n(l.clientX-t))};return{offset:r,start:o}},_tmpl$$6=template("<div></div>"),Stick=e=>{const[,t]=splitProps(e,["pos"]);return(()=>{const r=_tmpl$$6.cloneNode(!0);return spread(r,mergeProps(t,{get style(){return{position:"absolute",top:0,left:`${e.width/-2}px`,transform:`translateX(${e.pos*100}cqi)`,width:`${e.width}px`,height:"100%",background:e.background,...e.style}}}),!1,!0),r})()},_tmpl$$5=template("<button><span><span></span></span></button>"),_tmpl$2$2=template('<svg height="1ch" viewBox="0 0 1 1"><title>play</title><polygon points="0,0 1,0.5 0,1" fill="currentColor"></polygon></svg>'),_tmpl$3$2=template('<svg height="1ch" viewBox="0 0 1 1"><title>stop</title><rect x="0" y="0" width="1" height="1" fill="currentColor"></rect></svg>'),Trigger=e=>{const t=createMemo(()=>e.region&&player.playing()&&same(player.region(),e.region));return(()=>{const r=_tmpl$$5.cloneNode(!0),n=r.firstChild,o=n.firstChild;return r.$$dblclick=i=>i.stopPropagation(),r.$$click=()=>{t()?player.stop():(player.play(state.clip.buffer,e.region),e.onTrigger?.())},o.style.setProperty("font-family","monospace"),o.style.setProperty("font-size","1rem"),insert(o,(()=>{const i=createMemo(()=>!!t());return()=>i()?createComponent(StopIcon,{}):createComponent(PlayIcon,{})})()),insert(n,createComponent(Show,{get when(){return e.text},children:"\xA0"}),null),insert(n,()=>e.text,null),createRenderEffect(i=>{const s=e.style,l=!e.region;return i._v$=style$1(r,s,i._v$),l!==i._v$2&&(r.disabled=i._v$2=l),i},{_v$:void 0,_v$2:void 0}),r})()},PlayIcon=()=>_tmpl$2$2.cloneNode(!0),StopIcon=()=>_tmpl$3$2.cloneNode(!0);delegateEvents(["click","dblclick"]);function createZoom(){const t=Math.pow(2,10),[r,n]=createSignal(32),o=2;return{in:()=>n(i=>Math.max(1,i/o)),out:()=>n(i=>Math.min(t,i*o)),samplesPerPixel:r,inDisabled:()=>r()===1,outDisabled:()=>r()===t}}const debounce=(e,t)=>{let r;return n=>{r===void 0&&(e(n),r=setTimeout(()=>{r=void 0},t))}},_tmpl$$4=template("<div data-scroll-element><div></div></div>"),_tmpl$2$1=template('<div data-content-element><svg id="zoom-dot" viewBox="0 0 2 2" width="1ch"><circle cx="1" cy="1" r="1"></circle></svg></div>'),_tmpl$3$1=template("<div data-active-region></div>"),_tmpl$4$1=template('<div class="hitbox"></div>'),_tmpl$5$1=template("<button>delete</button>"),_tmpl$6$1=template("<div></div>"),_tmpl$7$1=template('<button><svg viewBox="0 0 1 1"><polygon points="0,0 1,0.5 0,1" fill="orange"></polygon></svg></button>'),_tmpl$8$1=template('<button aria-label="slice at cursor">slice</button>'),_tmpl$9$1=template("<div><button></button></div>"),_tmpl$10$1=template("<div data-summary-element></div>"),TILE_WIDTH=400,TILE_HEIGHT=100;let scrollElement,contentElement;const zoom=createZoom(),Waveform=e=>{const t=debounce(r=>{if(!scrollElement||!contentElement)return;const n=r.clientX-scrollElement.clientLeft,o=(n+scrollElement.scrollLeft)/contentElement.clientWidth;r.deltaY>0&&!zoom.outDisabled()&&zoom.out(),r.deltaY<0&&!zoom.inDisabled()&&zoom.in(),(!zoom.inDisabled()||!zoom.outDisabled())&&(scrollElement.scrollLeft=contentElement.clientWidth*o-n)},100);return(()=>{const r=_tmpl$$4.cloneNode(!0),n=r.firstChild;r.addEventListener("keypress",i=>{switch(i.key){case"s":return dispatch({type:"setMode",mode:"slice"});case"e":return dispatch({type:"setMode",mode:"edit"});case"d":return dispatch({type:"setMode",mode:"delete"})}}),r.addEventListener("wheel",i=>{!i.ctrlKey||(i.preventDefault(),t(i))}),r.$$keydown=i=>{i.ctrlKey&&((i.key==="+"||i.key==="=")&&(i.preventDefault(),zoom.in(),i.target.scrollIntoView({inline:"center",block:"nearest"})),(i.key==="-"||i.key==="_")&&(i.preventDefault(),zoom.out(),i.target.scrollIntoView({inline:"center",block:"nearest"})))};const o=scrollElement;return typeof o=="function"?use(o,r):scrollElement=r,r.style.setProperty("overflow","auto"),n.style.setProperty("height","calc(var(--min-btn-dimension) + 20px)"),insert(r,createComponent(WaveformContent,{get buffer(){return e.buffer}}),null),insert(r,createComponent(WaveformSummary,{get buffer(){return e.buffer}}),null),r})()},[zoomCenter,setZoomCenter]=createSignal(0),WaveformContent=e=>{const t=createMemo(()=>createVirtualizer({count:range(0,e.buffer.length/zoom.samplesPerPixel(),TILE_WIDTH).length,getScrollElement:()=>scrollElement,estimateSize:()=>TILE_WIDTH,horizontal:!0})),r=n=>{if(!contentElement)return;const o=contentElement.getBoundingClientRect(),i=n.clientX-o.left;dispatch({type:"setCursor",pos:i/contentElement.clientWidth})};return(()=>{const n=_tmpl$2$1.cloneNode(!0),o=n.firstChild;n.$$dblclick=s=>{r(s),setZoomCenter(state.cursor),dispatch({type:"showCursorControls"})};const i=contentElement;return typeof i=="function"?use(i,n):contentElement=n,n.style.setProperty("display","flex"),n.style.setProperty("position","relative"),n.style.setProperty("container-type","inline-size"),o.style.setProperty("position","absolute"),o.style.setProperty("left","-0.5ch"),o.style.setProperty("opacity","0.8"),o.style.setProperty("top","calc(var(--min-btn-dimension) * -1 - 15px)"),o.style.setProperty("fill","CanvasText"),insert(n,createComponent(For,{get each(){return t().getVirtualItems()},children:s=>createComponent(WaveformTile,{get buffer(){return e.buffer},get start(){return s.start},length:TILE_WIDTH})}),null),insert(n,createComponent(For,{get each(){return state.regions},children:(s,l)=>createComponent(Slice,{region:s,get index(){return l()},get id(){return s.start.toString()}})}),null),insert(n,createComponent(ActiveRegion,{}),null),insert(n,createComponent(Cursor,{}),null),insert(n,createComponent(Playhead,{}),null),createRenderEffect(s=>{const l=`${e.buffer.length/zoom.samplesPerPixel()}px`,c=e.buffer.numberOfChannels*TILE_HEIGHT+"px",d=`translateX(${zoomCenter()*100}cqi)`;return l!==s._v$&&n.style.setProperty("width",s._v$=l),c!==s._v$2&&n.style.setProperty("height",s._v$2=c),d!==s._v$3&&o.style.setProperty("transform",s._v$3=d),s},{_v$:void 0,_v$2:void 0,_v$3:void 0}),n})()},ActiveRegion=()=>{const e=createMemo(()=>{const t=state.regions[state.selectedRegion!==void 0?state.selectedRegion:-1];return t||{start:0,end:0}});return createComponent(Show,{get when(){return e()},get children(){const t=_tmpl$3$1.cloneNode(!0);return t.style.setProperty("position","absolute"),t.style.setProperty("height","100%"),t.style.setProperty("background","hsl(39deg 100% 50% / 40%)"),t.style.setProperty("pointer-events","none"),createRenderEffect(r=>{const n=(e().end-e().start)*100+"cqi",o=e().start*100+"cqi";return n!==r._v$4&&t.style.setProperty("width",r._v$4=n),o!==r._v$5&&t.style.setProperty("left",r._v$5=o),r},{_v$4:void 0,_v$5:void 0}),t}})},Slice=e=>{const t=s=>s.preventDefault(),r=createDrag({onStart:()=>{scrollElement?.addEventListener("touchmove",t)},onFinished:()=>{dispatch({type:"moveSlice",index:e.index,pos:n()}),setZoomCenter(e.region.start),scrollElement?.removeEventListener("touchmove",t)}}),n=()=>{if(contentElement){const s=o(),l=e.region.start+r.offset()/contentElement.clientWidth;return Math.max(s.left,Math.min(s.right,l))}return e.region.start},o=()=>{const s=state.clip;if(!s||!contentElement)throw"AAAAAAH";const d=.005/(s.buffer.length/s.buffer.sampleRate),f=(state.regions[e.index-1]?.start||0)+(e.index>0?d:0),m=e.region.end-d;return{left:f,right:m}},i=createKeyboardMovementHandler(s=>{const l=o(),c=Math.max(l.left,Math.min(l.right,e.region.start+s));dispatch({type:"moveSlice",index:e.index,pos:c}),setZoomCenter(c),document.getElementById(`slice-${c}`)?.focus()});return[createComponent(Stick,{get pos(){return n()},width:2,background:"CanvasText",style:{"box-shadow":"1px 0px 0px Canvas, -1px 0px 0px Canvas"}}),(()=>{const s=_tmpl$4$1.cloneNode(!0);return s.style.setProperty("position","absolute"),s.style.setProperty("height","100%"),createRenderEffect(l=>{const c=e.index,d=`translateX(${e.region.start*100}cqi)`,f=`${(e.region.end-e.region.start)*100}cqi`;return c!==l._v$6&&setAttribute(s,"data-index",l._v$6=c),d!==l._v$7&&s.style.setProperty("transform",l._v$7=d),f!==l._v$8&&s.style.setProperty("width",l._v$8=f),l},{_v$6:void 0,_v$7:void 0,_v$8:void 0}),s})(),createComponent(Show,{get when(){return state.mode==="edit"&&e.index>0},get children(){return createComponent(Stick,{get pos(){return n()},width:30,background:"CanvasText",style:{opacity:"50%"},onPointerDown:s=>{r.start(s)},onFocus:()=>setZoomCenter(n()),tabIndex:0,onkeydown:i,get id(){return`slice-${e.region.start}`}})}}),(()=>{const s=_tmpl$6$1.cloneNode(!0);return s.$$focusin=()=>setZoomCenter(n()),s.style.setProperty("position","absolute"),s.style.setProperty("display","flex"),s.style.setProperty("top","calc(-1 * var(--min-btn-dimension))"),insert(s,createComponent(Show,{get when(){return state.mode==="delete"&&e.index>0},get children(){const l=_tmpl$5$1.cloneNode(!0);return l.$$click=()=>{dispatch({type:"healSlice",index:e.index}),state.selectedRegion!==void 0&&e.index<=state.selectedRegion&&dispatch({type:"selectRegion",index:state.selectedRegion-1})},l}}),null),insert(s,createComponent(Trigger,{get region(){return e.region},get text(){return(e.index+1).toString()},onTrigger:()=>{setZoomCenter(e.region.start),state.selectedRegion!==void 0&&dispatch({type:"selectRegion",index:e.index})}}),null),createRenderEffect(()=>s.style.setProperty("transform",`translateX(${n()*100}cqi)`)),s})()]},createKeyboardMovementHandler=e=>t=>{if(!(!scrollElement||!contentElement||!(t.target instanceof Element))&&["ArrowRight","ArrowLeft","ArrowUp","ArrowDown","PageDown","PageUp","Home","End"].includes(t.key)){t.preventDefault();const n=10/contentElement.clientWidth,o=t.ctrlKey?n*10:n;t.key==="ArrowRight"&&(e(o),t.target.getBoundingClientRect().right>scrollElement.getBoundingClientRect().right&&t.target.scrollIntoView({inline:"center",block:"nearest"})),t.key==="ArrowLeft"&&(e(-o),t.target.getBoundingClientRect().left<scrollElement.getBoundingClientRect().left&&t.target.scrollIntoView({inline:"center",block:"nearest"}));const s=scrollElement.clientWidth/contentElement.clientWidth;t.key==="PageDown"&&(e(s),t.target.scrollIntoView({inline:"center",block:"nearest"})),t.key==="PageUp"&&(e(-s),t.target.scrollIntoView({inline:"center",block:"nearest"})),t.key==="Home"&&(e(-1),t.target.scrollIntoView({inline:"center",block:"nearest"})),t.key==="End"&&(e(1),t.target.scrollIntoView({inline:"center",block:"nearest"}))}},Cursor=e=>{const t=f=>f.preventDefault(),r=createDrag({onStart:()=>{scrollElement?.addEventListener("touchmove",t)},onFinished:()=>{dispatch({type:"setCursor",pos:n()}),scrollElement?.removeEventListener("touchmove",t),setZoomCenter(state.cursor)}}),n=()=>{if(contentElement){const f=state.cursor+r.offset()/contentElement.clientWidth;return Math.max(0,Math.min(1,f))}return state.cursor},o=createKeyboardMovementHandler(f=>{dispatch({type:"setCursor",pos:state.cursor+f}),setZoomCenter(state.cursor)});let i;const[s,l]=createSignal(0),c=createMemo(()=>{const f=state.regions[s()];return f!==void 0&&player.playing()&&same(player.region(),{start:state.cursor,end:f.end})}),d=()=>{const f=document.getElementById("cursor");if(!f)return;const m=document.elementsFromPoint(f.getBoundingClientRect().x,f.getBoundingClientRect().y).find(v=>v.classList.contains("hitbox"));if(!m||!(m instanceof HTMLElement))return;const b=parseInt(m.dataset.index||"");l(b)};return[(()=>{const f=_tmpl$6$1.cloneNode(!0);return f.style.setProperty("pointer-events","none"),insert(f,createComponent(Stick,{id:"cursor",get pos(){return n()},width:2,background:"repeating-linear-gradient(orange 0px, orange 4px, transparent 4px, transparent 8px)"})),f})(),createComponent(Show,{get when(){return state.mode==="slice"},get children(){return createComponent(Stick,{ref(f){const m=i;typeof m=="function"?m(f):i=f},get pos(){return n()},width:30,background:"hsl(39deg 100% 50% / 50%)",get onPointerDown(){return r.start},onKeyDown:o,onFocus:()=>setZoomCenter(n()),tabIndex:0,"aria-label":"cursor"})}}),(()=>{const f=_tmpl$7$1.cloneNode(!0),m=f.firstChild;return f.$$dblclick=b=>b.stopPropagation(),addEventListener$1(f,"keydown",o,!0),f.$$click=()=>{state.cursorControlsVisible?dispatch({type:"hideCursorControls"}):dispatch({type:"showCursorControls"})},f.style.setProperty("position","absolute"),f.style.setProperty("width","min-content"),f.style.setProperty("display","grid"),f.style.setProperty("left","-15px"),f.style.setProperty("align-content","center"),f.style.setProperty("font-size","large"),f.style.setProperty("background","hsl(39deg 100% 50% / 0%)"),f.style.setProperty("border","none"),f.style.setProperty("color","orange"),f.style.setProperty("min-width","unset"),f.style.setProperty("box-sizing","border-box"),f.style.setProperty("padding","0"),m.style.setProperty("width","30px"),createRenderEffect(b=>{const v=`translateX(calc(${n()*100}cqi))`,w=state.cursorControlsVisible?"hide cursor controls":"show cursor controls",S=`
            ${state.cursorControlsVisible?"rotate(-90deg)":"rotate(90deg)"}
            scale(0.5)
          `;return v!==b._v$9&&f.style.setProperty("transform",b._v$9=v),w!==b._v$10&&setAttribute(f,"aria-label",b._v$10=w),S!==b._v$11&&m.style.setProperty("transform",b._v$11=S),b},{_v$9:void 0,_v$10:void 0,_v$11:void 0}),f})(),createComponent(Show,{get when(){return state.cursorControlsVisible},get children(){const f=_tmpl$9$1.cloneNode(!0),m=f.firstChild;return f.$$focusin=()=>setZoomCenter(state.cursor),addEventListener$1(f,"keydown",o,!0),f.$$dblclick=b=>b.stopPropagation(),f.style.setProperty("position","absolute"),f.style.setProperty("display","flex"),f.style.setProperty("top","calc(-1 * var(--min-btn-dimension))"),insert(f,createComponent(Show,{get when(){return state.mode==="slice"},get children(){const b=_tmpl$8$1.cloneNode(!0);return b.$$click=()=>{d(),dispatch({type:"slice",index:s(),pos:state.cursor}),dispatch({type:"hideCursorControls"}),i?.focus(),setZoomCenter(state.cursor),state.selectedRegion!==void 0&&dispatch({type:"selectRegion",index:s()+1})},b}}),m),m.$$click=()=>{if(c())player.stop();else{setZoomCenter(state.cursor),d();const b=state.regions[s()];if(!b)return;player.play(state.clip.buffer,{start:state.cursor,end:b.end})}},m.style.setProperty("font-family","monospace"),m.style.setProperty("font-size","1rem"),insert(m,(()=>{const b=createMemo(()=>!!c());return()=>b()?createComponent(StopIcon,{}):createComponent(PlayIcon,{})})()),createRenderEffect(b=>{const v=`translateX(${n()*100}cqi)`,w=c()?"stop":"play from cursor";return v!==b._v$12&&f.style.setProperty("transform",b._v$12=v),w!==b._v$13&&setAttribute(m,"aria-label",b._v$13=w),b},{_v$12:void 0,_v$13:void 0}),f}})]},Playhead=()=>createComponent(Show,{get when(){return player.playing()},get children(){return createComponent(Stick,{get pos(){return player.progress()},width:2,background:"orange"})}}),WaveformSummary=e=>{let t;const r=()=>{const[c,d]=createSignal(0),[f,m]=createSignal(0);return useAnimationFrame(()=>{scrollElement&&contentElement&&(d(scrollElement.scrollLeft/contentElement.clientWidth*100),m(scrollElement.clientWidth/contentElement.clientWidth*100))}),(()=>{const b=_tmpl$6$1.cloneNode(!0);return b.style.setProperty("position","absolute"),b.style.setProperty("bottom","0"),b.style.setProperty("height","39px"),b.style.setProperty("background","#8888"),createRenderEffect(v=>{const w=`min(100cqi, max(${f()}cqi, 2px))`,S=c()+"cqi";return w!==v._v$14&&b.style.setProperty("width",v._v$14=w),S!==v._v$15&&b.style.setProperty("left",v._v$15=S),v},{_v$14:void 0,_v$15:void 0}),b})()},n=c=>{if(!t||!contentElement||!scrollElement)return;const d=t.getBoundingClientRect(),m=(c.clientX-d.left)/d.width;scrollElement.scrollLeft=contentElement.getBoundingClientRect().width*m-scrollElement.getBoundingClientRect().width/2},o=createDrag({onStart:n,onDrag:n}),[i,s]=createSignal(800),l=new ResizeObserver(lodash_debounce(()=>{t&&s(t.clientWidth)},300,{trailing:!0}));return onMount(()=>{t&&l.observe(t)}),onCleanup(()=>{t&&l.unobserve(t)}),(()=>{const c=_tmpl$10$1.cloneNode(!0);addEventListener$1(c,"pointerdown",o.start,!0);const d=t;return typeof d=="function"?use(d,c):t=c,c.style.setProperty("position","sticky"),c.style.setProperty("left","0"),c.style.setProperty("height","50px"),c.style.setProperty("touch-action","none"),c.style.setProperty("container-type","inline-size"),insert(c,createComponent(For,{get each(){return range(0,e.buffer.numberOfChannels)},children:f=>createComponent(ChannelSegment,{get data(){return e.buffer.getChannelData(f)},get width(){return i()},height:25,get numBuckets(){return i()},style:{position:"absolute",bottom:0,height:"39px"}})}),null),insert(c,createComponent(r,{}),null),insert(c,createComponent(Stick,{get pos(){return state.cursor},width:2,background:"repeating-linear-gradient(orange 0px, orange 2px, transparent 2px, transparent 4px)",style:{height:"50px",top:"unset",bottom:0}}),null),insert(c,createComponent(For,{get each(){return state.regions},children:f=>createComponent(Stick,{get pos(){return f.start},background:"CanvasText",style:{height:"10px"},width:2})}),null),insert(c,createComponent(ActiveRegion,{}),null),insert(c,createComponent(Playhead,{}),null),c})()},WaveformTile=e=>(()=>{const t=_tmpl$6$1.cloneNode(!0);return t.style.setProperty("display","flex"),t.style.setProperty("flex-direction","column"),t.style.setProperty("position","absolute"),t.style.setProperty("top","0"),t.style.setProperty("left","0"),t.style.setProperty("width","400px"),insert(t,createComponent(For,{get each(){return range(0,e.buffer.numberOfChannels)},children:r=>{const n=createMemo(()=>e.buffer.getChannelData(r).slice(e.start*zoom.samplesPerPixel(),(e.start+e.length)*zoom.samplesPerPixel()));return createComponent(ChannelSegment,{get data(){return n()},width:TILE_WIDTH,height:TILE_HEIGHT,get numBuckets(){return n().length/zoom.samplesPerPixel()}})}})),createRenderEffect(()=>t.style.setProperty("transform",`translateX(${e.start}px)`)),t})();delegateEvents(["keydown","dblclick","focusin","click","pointerdown"]);const Controls$1="",_tmpl$$3=template('<div class="controls-outer"><div class="controls"><fieldset><button>undo</button><button>redo</button></fieldset><fieldset><legend>mode:</legend><div class="radio-item"><input type="radio" id="slice" value="slice"><label for="slice">slice</label></div><div class="radio-item"><input type="radio" id="edit" value="edit"><label for="edit">edit</label></div><div class="radio-item"><input type="radio" id="delete" value="delete"><label for="delete">delete</label></div></fieldset><fieldset><button>zoom in</button><button>zoom out</button></fieldset></div></div>'),Controls=()=>(()=>{const e=_tmpl$$3.cloneNode(!0),t=e.firstChild,r=t.firstChild,n=r.firstChild,o=n.nextSibling,i=r.nextSibling,s=i.firstChild,l=s.nextSibling,c=l.firstChild,d=l.nextSibling,f=d.firstChild,m=d.nextSibling,b=m.firstChild,v=i.nextSibling,w=v.firstChild,S=w.nextSibling;return n.$$click=()=>undo.execute(),o.$$click=()=>redo.execute(),i.addEventListener("change",T=>{switch(T.target.value){case"slice":return dispatch({type:"setMode",mode:"slice"});case"edit":return dispatch({type:"setMode",mode:"edit"});case"delete":return dispatch({type:"setMode",mode:"delete"})}}),w.$$click=()=>{zoom.in(),document.getElementById("zoom-dot")?.scrollIntoView({inline:"center",block:"nearest"})},S.$$click=()=>{zoom.out(),document.getElementById("zoom-dot")?.scrollIntoView({inline:"center",block:"nearest"})},createRenderEffect(T=>{const I=undo.disabled(),N=redo.disabled(),F=zoom.inDisabled(),B=zoom.outDisabled();return I!==T._v$&&(n.disabled=T._v$=I),N!==T._v$2&&(o.disabled=T._v$2=N),F!==T._v$3&&(w.disabled=T._v$3=F),B!==T._v$4&&(S.disabled=T._v$4=B),T},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),createRenderEffect(()=>c.checked=state.mode==="slice"),createRenderEffect(()=>f.checked=state.mode==="edit"),createRenderEffect(()=>b.checked=state.mode==="delete"),e})();delegateEvents(["click"]);const formatOfAudioBuffer=e=>formatOfChannels(e.numberOfChannels),formatOfChannels=e=>{switch(e){case 1:return"mono";case 2:return"stereo";default:return e+" channels"}},_tmpl$$2=template("<div><button>home</button><div><p></p><p>s</p><p></p></div></div>"),Details=e=>(()=>{const t=_tmpl$$2.cloneNode(!0),r=t.firstChild,n=r.nextSibling,o=n.firstChild,i=o.nextSibling,s=i.firstChild,l=i.nextSibling;return t.style.setProperty("display","flex"),t.style.setProperty("align-items","center"),t.style.setProperty("word-break","break-word"),r.$$click=()=>{confirm("leave session?")&&(dispatch({type:"reset"}),player.stop())},r.style.setProperty("white-space","nowrap"),n.style.setProperty("display","flex"),n.style.setProperty("flex-wrap","wrap"),n.style.setProperty("gap","1ch"),n.style.setProperty("padding","1ch"),n.style.setProperty("margin-inline-start","auto"),insert(o,()=>e.clip.name),insert(i,()=>(e.clip.buffer.length/e.clip.buffer.sampleRate).toFixed(2),s),insert(l,()=>formatOfAudioBuffer(e.clip.buffer)),t})();delegateEvents(["click"]);const style="",_tmpl$$1=template("<div><progress></progress></div>"),Curtain=()=>(()=>{const e=_tmpl$$1.cloneNode(!0);return e.style.setProperty("position","fixed"),e.style.setProperty("width","100vw"),e.style.setProperty("height","100vh"),e.style.setProperty("left","0"),e.style.setProperty("top","0"),e.style.setProperty("background","hsl(0deg 0% 0% / 30%)"),e.style.setProperty("display","grid"),e.style.setProperty("place-content","center"),e.style.setProperty("z-index","100"),e})(),_tmpl$=template("<div><h2>import audio</h2></div>"),_tmpl$2=template("<button>delete sessions</button>"),_tmpl$3=template("<div><h2>sessions</h2></div>"),_tmpl$4=template("<div><h3></h3><p></p><p>s</p><p>last modified </p><button>open</button></div>"),_tmpl$5=template('<form><button type="submit" aria-label="import audio from url">from url</button><label for="url-input">url:</label><input type="url" id="url-input" name="url" required></form>'),_tmpl$6=template("<div></div>"),_tmpl$7=template('<dialog id="settings-dialog"></dialog>'),_tmpl$8=template('<div><button aria-label="close playback settings">close</button><div><fieldset><legend>speed/pitch</legend></fieldset></div><div><fieldset><legend>filter</legend></fieldset></div><div><fieldset><legend>compression</legend></fieldset></div></div>'),_tmpl$9=template('<div><p><label></label><span><span></span></span></p><input type="range"></div>'),_tmpl$10=template('<div style="display: grid; position: relative;"><button data-details-link><svg viewBox="0 0 5 5" fill="currentColor"><title>region <!> details</title><rect stroke="none" x="0" y="2" width="1" height="1"></rect><rect stroke="none" x="2" y="2" width="1" height="1"></rect><rect stroke="none" x="4" y="2" width="1" height="1"></rect></svg></button></div>'),_tmpl$11=template("<button>share</button>"),_tmpl$12=template('<div id="region-details"><div id="region-details-header"><button>back</button><h2 aria-live="polite"></h2><div id="region-details-footer"><button aria-label="previous region">\u2039</button><button aria-label="next region">\u203A</button></div></div><div id="region-details-body"><fieldset id="region-details-playback"><legend>playback</legend><button>spam</button></fieldset><fieldset><legend>export</legend><button>download</button></fieldset></div></div>'),_tmpl$13=template('<form><fieldset><legend>segment region</legend><label for="number-of-pieces-input">pieces:</label><input type="number" name="number of pieces" id="number-of-pieces-input" min="2" required pattern="[0-9]*"><button type="submit">chop</button></fieldset></form>'),_tmpl$14=template('<div id="bottom-panel"></div>'),_tmpl$15=template('<button aria-label="open playback settings">FX</button>'),_tmpl$16=template('<fieldset><label for="loop-toggle"><span>loop</span><input type="checkbox" id="loop-toggle" name="loop"></label></fieldset>'),hashHex=async e=>{const t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(r=>r.toString(16).padStart(2,"0")).join("")},hashAudioBuffer=e=>{const t=new Float32Array(e.length*e.numberOfChannels);for(let r=0;r<e.numberOfChannels;r++)t.set(e.getChannelData(r),r*e.length);return hashHex(t)},clipOfFile=async e=>{const t=await audioContext.decodeAudioData(await arrayBufferOfFile(e)),r=await hashAudioBuffer(t);return{name:e.name,buffer:t,hash:r}},arrayBufferOfFile=e=>new Promise((t,r)=>{const n=new FileReader;n.onloadend=o=>{if(!(o.target?.result instanceof ArrayBuffer)){r();return}t(o.target.result)},n.readAsArrayBuffer(e)}),LoadAudio=()=>(()=>{const e=_tmpl$.cloneNode(!0);return e.firstChild,e.style.setProperty("padding-inline","1rem"),e.style.setProperty("display","flex"),e.style.setProperty("flex-direction","column"),e.style.setProperty("gap","1rem"),e.style.setProperty("align-items","flex-start"),insert(e,createComponent(AudioInput,{onChange:async t=>{setBusy(!0);const r=await clipOfFile(t).catch(n=>{console.error(n),alert("failed to load audio"),setBusy(!1)});!r||(setBusy(!1),dispatch({type:"setClip",clip:r}))}}),null),insert(e,createComponent(UrlInput,{}),null),e})(),Sessions=()=>{const[e,t]=createSignal(),r=new BroadcastChannel("tab-sync");onCleanup(()=>{r.close()});const n=()=>{localforage.getItem("sessions").then(i=>{!i||t([...i.values()].sort((s,l)=>l.lastModified-s.lastModified))})};r.addEventListener("message",lodash_debounce(n,1e3)),n();const o=()=>e()?.length||0;return(()=>{const i=_tmpl$3.cloneNode(!0);return i.firstChild,i.style.setProperty("padding-inline","1rem"),i.style.setProperty("display","flex"),i.style.setProperty("flex-direction","column"),i.style.setProperty("gap","1rem"),i.style.setProperty("align-items","flex-start"),insert(i,createComponent(Show,{get when(){return e()},get children(){return createComponent(For,{get each(){return e()},children:s=>(()=>{const l=_tmpl$4.cloneNode(!0),c=l.firstChild,d=c.nextSibling,f=d.nextSibling,m=f.firstChild,b=f.nextSibling;b.firstChild;const v=b.nextSibling;return c.style.setProperty("line-break","anywhere"),insert(c,()=>s.alias),insert(d,()=>formatOfChannels(s.numberOfChannels)),insert(f,()=>(s.length/s.sampleRate).toFixed(2),m),insert(b,()=>new Date(s.lastModified).toLocaleString(),null),v.$$click=async()=>{setBusy(!0),await loadSession(s),setBusy(!1)},createRenderEffect(()=>setAttribute(v,"aria-label",`open session ${s.alias}`)),l})()})}}),null),insert(i,createComponent(Show,{get when(){return o()},get children(){const s=_tmpl$2.cloneNode(!0);return s.$$click=async()=>{confirm("delete sessions permanently?")&&(setBusy(!0),await deleteSessions(),setBusy(!1),t())},s}}),null),i})()},UrlInput=()=>{let e;return(()=>{const t=_tmpl$5.cloneNode(!0),r=t.firstChild,n=r.nextSibling,o=n.nextSibling;t.addEventListener("submit",async s=>{if(s.preventDefault(),s.currentTarget.checkValidity()&&e){setBusy(!0);const l=e.value,c=await fetch(l).then(m=>m.arrayBuffer()).then(m=>audioContext.decodeAudioData(m)).catch(m=>{console.error(m),alert("failed to load audio"),setBusy(!1)});if(!c)return;const d=l.slice(l.lastIndexOf("/")+1),f=await hashAudioBuffer(c);dispatch({type:"setClip",clip:{name:d,buffer:c,hash:f}}),setBusy(!1)}}),t.style.setProperty("display","flex"),t.style.setProperty("gap","1ch"),t.style.setProperty("align-items","center"),t.style.setProperty("flex-wrap","wrap");const i=e;return typeof i=="function"?use(i,o):e=o,t})()},App=()=>[createComponent(Show,{get when(){return state.clip},fallback:()=>(()=>{const e=_tmpl$6.cloneNode(!0);return e.style.setProperty("display","flex"),e.style.setProperty("flex-direction","column"),e.style.setProperty("gap","1rem"),e.style.setProperty("padding-block","1rem"),insert(e,createComponent(LoadAudio,{}),null),insert(e,createComponent(Sessions,{}),null),e})(),get children(){return[(()=>{const e=_tmpl$6.cloneNode(!0);return insert(e,createComponent(Details,{get clip(){return state.clip}}),null),insert(e,createComponent(Controls,{}),null),insert(e,createComponent(Waveform,{get buffer(){return state.clip.buffer}}),null),e})(),createComponent(BottomPanel,{}),createComponent(FloatingControls,{}),createComponent(SettingsDialog,{})]}}),createComponent(Show,{get when(){return busy()},get children(){return createComponent(Curtain,{})}})],SettingsDialog=()=>{let e;return(()=>{const t=_tmpl$7.cloneNode(!0);t.$$click=n=>{const o=n.currentTarget.getBoundingClientRect(),i=n.x<o.x||n.y<o.y||n.x>o.x+o.width||n.y>o.y+o.height;n.target===e&&i&&e?.close()};const r=e;return typeof r=="function"?use(r,t):e=t,t.style.setProperty("max-height","unset"),t.style.setProperty("max-width","100vw"),t.style.setProperty("box-sizing","border-box"),t.style.setProperty("height","100vh"),t.style.setProperty("border","none"),t.style.setProperty("border-right","2px solid"),insert(t,createComponent(SettingsForm,{})),t})()},SettingsForm=()=>(()=>{const e=_tmpl$8.cloneNode(!0),t=e.firstChild,r=t.nextSibling,n=r.firstChild;n.firstChild;const o=r.nextSibling,i=o.firstChild;i.firstChild;const s=o.nextSibling,l=s.firstChild;return l.firstChild,t.$$click=()=>{const c=document.getElementById("settings-dialog");c instanceof HTMLDialogElement&&c.close()},t.style.setProperty("align-self","flex-start"),insert(n,createComponent(RangeInput,{get value(){return player.pitchOffsetSemis()},onInput:c=>{player.setPitchOffsetSemis(parseFloat(c.currentTarget.value))},label:"coarse","aria-label":"speed/pitch coarse",id:"speed-semis",min:-12,max:12,sign:!0,unit:"semis"}),null),insert(n,createComponent(RangeInput,{get value(){return player.pitchOffsetCents()},onInput:c=>{player.setPitchOffsetCents(parseFloat(c.currentTarget.value))},label:"fine","aria-label":"speed/pitch fine",id:"speed-cents",min:-50,max:50,sign:!0,unit:"cents"}),null),insert(i,createComponent(RangeInput,{get value(){return player.loPass()},transformDisplay:c=>Math.floor(mapLinearToLogarithmic(c)),onInput:c=>{player.setLoPass(parseFloat(c.currentTarget.value))},label:"low pass","aria-label":"low pass filter",id:"filter-low-pass",min:0,max:100,unit:"hz"}),null),insert(i,createComponent(RangeInput,{get value(){return player.hiPass()},transformDisplay:c=>Math.floor(mapLinearToLogarithmic(c)),onInput:c=>{player.setHiPass(parseFloat(c.currentTarget.value))},label:"high pass","aria-label":"high pass filter",id:"filter-high-pass",min:0,max:100,unit:"hz"}),null),insert(l,createComponent(RangeInput,{get value(){return player.compressionThreshold()},onInput:c=>{player.setCompressionThreshold(parseFloat(c.currentTarget.value))},label:"threshold","aria-label":"compression threshold",id:"compression-threshold",min:-30,max:0,sign:!0,unit:"dB"}),null),insert(e,createComponent(RangeInput,{get value(){return player.gain()},onInput:c=>{player.setGain(parseFloat(c.currentTarget.value))},label:"gain",id:"gain",min:-20,max:20,sign:!0,unit:"dB"}),null),e})(),RangeInput=e=>{const t=()=>{const r=e.transformDisplay?e.transformDisplay(e.value):e.value;return(e.sign?`${e.value>=0?"+":"-"}${Math.abs(r)}`:r)+(e.unit||"")};return(()=>{const r=_tmpl$9.cloneNode(!0),n=r.firstChild,o=n.firstChild,i=o.nextSibling,s=i.firstChild,l=n.nextSibling;return r.style.setProperty("width","100%"),n.style.setProperty("display","flex"),n.style.setProperty("font-family","monospace"),insert(o,()=>e.label),i.style.setProperty("margin-inline-start","auto"),insert(s,t),addEventListener$1(l,"input",e.onInput,!0),l.style.setProperty("width","100%"),createRenderEffect(c=>{const d=e.id,f=e.id,m=e.id,b=e.min,v=e.max,w=e["aria-label"]||e.label;return d!==c._v$&&setAttribute(o,"for",c._v$=d),f!==c._v$2&&setAttribute(l,"name",c._v$2=f),m!==c._v$3&&setAttribute(l,"id",c._v$3=m),b!==c._v$4&&setAttribute(l,"min",c._v$4=b),v!==c._v$5&&setAttribute(l,"max",c._v$5=v),w!==c._v$6&&setAttribute(l,"aria-label",c._v$6=w),c},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0}),createRenderEffect(()=>l.value=e.value),r})()},Pads=()=>(()=>{const e=_tmpl$6.cloneNode(!0);return e.style.setProperty("display","grid"),e.style.setProperty("grid-template-columns","repeat( auto-fit, minmax(100px, 1fr) )"),e.style.setProperty("grid-auto-rows","100px"),e.style.setProperty("padding-bottom","calc(var(--min-btn-dimension) * 2)"),insert(e,createComponent(For,{get each(){return state.regions},children:(t,r)=>(()=>{const n=_tmpl$10.cloneNode(!0),o=n.firstChild,i=o.firstChild,s=i.firstChild,l=s.firstChild,c=l.nextSibling;return c.nextSibling,insert(n,createComponent(Trigger,{region:t,style:{height:"100%",width:"100%","z-index":0,"text-align":"start"},onTrigger:()=>{setZoomCenter(t.start),scrollElement&&contentElement&&(scrollElement.scrollLeft=t.start*contentElement.clientWidth-scrollElement.clientWidth/2)},get text(){return(r()+1).toString()}}),o),o.$$click=()=>{dispatch({type:"selectRegion",index:r()});const d=state.regions[r()];if(!d)return;setZoomCenter(d.start);const f=document.querySelector("#region-details button");f instanceof HTMLElement&&f.focus(),scrollRegionIntoView(d)},o.style.setProperty("position","absolute"),o.style.setProperty("right","0"),i.style.setProperty("width","10px"),insert(s,()=>r()+1,c),createRenderEffect(()=>setAttribute(n,"id",`region-${r()}`)),n})()})),e})(),RegionDetails=e=>{const t=()=>{const n=e.index+1,o=state.regions[n];!o||n<state.regions.length&&(dispatch({type:"selectRegion",index:n}),setZoomCenter(o.start),scrollRegionIntoView(o))},r=()=>{const n=e.index-1;if(n>-1){dispatch({type:"selectRegion",index:n});const o=state.regions[n];if(!o)return;setZoomCenter(o.start),scrollRegionIntoView(o)}};return(()=>{const n=_tmpl$12.cloneNode(!0),o=n.firstChild,i=o.firstChild,s=i.nextSibling,l=s.nextSibling,c=l.firstChild,d=c.nextSibling,f=o.nextSibling,m=f.firstChild,b=m.firstChild,v=b.nextSibling,w=m.nextSibling,S=w.firstChild,T=S.nextSibling;return n.style.setProperty("display","flex"),n.style.setProperty("flex-direction","column"),n.style.setProperty("gap","1rem"),o.style.setProperty("display","flex"),o.style.setProperty("align-items","center"),o.style.setProperty("position","sticky"),o.style.setProperty("top","0"),o.style.setProperty("background","Canvas"),o.style.setProperty("z-index","1"),i.$$click=()=>{const I=e.index;dispatch({type:"selectRegion",index:void 0});const N=document.querySelector(`#region-${I} [data-details-link]`);N instanceof HTMLElement&&N.focus()},s.style.setProperty("margin-inline","1rem"),s.style.setProperty("margin-inline-start","auto"),insert(s,()=>e.index+1),l.style.setProperty("display","flex"),l.style.setProperty("justify-content","center"),c.$$click=r,c.style.setProperty("font-size","1rem"),d.$$click=t,d.style.setProperty("font-size","1rem"),f.style.setProperty("display","flex"),f.style.setProperty("flex-wrap","wrap"),f.style.setProperty("gap","1rem"),f.style.setProperty("margin-inline","1rem"),f.style.setProperty("padding-bottom","calc(var(--min-btn-dimension) * 2)"),m.$$keydown=I=>{I.key==="ArrowRight"&&(I.preventDefault(),t()),I.key==="ArrowLeft"&&(I.preventDefault(),r())},insert(m,createComponent(Trigger,{get region(){return state.regions[e.index]}}),v),v.$$click=()=>{!state.clip||player.play(state.clip.buffer,state.regions[e.index])},T.$$click=async()=>{const I=state.clip?.buffer,N=state.regions[e.index];I&&N&&(setBusy(!0),await download(I,N,player.speed(),player.loPass(),player.hiPass(),player.compressionThreshold(),player.gain()).catch(),setBusy(!1))},insert(w,createComponent(Show,{get when(){return!!navigator.share},get children(){const I=_tmpl$11.cloneNode(!0);return I.$$click=async()=>{const N=state.clip?.buffer,F=state.regions[e.index];N&&F&&(setBusy(!0),await share(N,F,player.speed(),player.loPass(),player.hiPass(),player.compressionThreshold(),player.gain()).catch(),setBusy(!1))},I}}),null),insert(f,createComponent(SegmentRegionForm,{get index(){return e.index}}),null),createRenderEffect(I=>{const N=e.index===0,F=e.index===state.regions.length-1;return N!==I._v$7&&(c.disabled=I._v$7=N),F!==I._v$8&&(d.disabled=I._v$8=F),I},{_v$7:void 0,_v$8:void 0}),n})()},SegmentRegionForm=e=>{let t;if(!state.clip)return;const r=()=>{const o=state.regions[e.index];return!state.clip||!o?0:(o.end-o.start)*state.clip.buffer.duration},n=()=>Math.min(Math.floor(r()/.01),256);return(()=>{const o=_tmpl$13.cloneNode(!0),i=o.firstChild,s=i.firstChild,l=s.nextSibling,c=l.nextSibling;o.addEventListener("submit",f=>{f.preventDefault(),f.currentTarget.checkValidity()&&t&&dispatch({type:"segmentRegion",index:e.index,pieces:parseInt(t.value)})});const d=t;return typeof d=="function"?use(d,c):t=c,createRenderEffect(f=>{const m=n()<2,b=n();return m!==f._v$9&&(i.disabled=f._v$9=m),b!==f._v$10&&setAttribute(c,"max",f._v$10=b),f},{_v$9:void 0,_v$10:void 0}),o})()},BottomPanel=()=>(()=>{const e=_tmpl$14.cloneNode(!0);return insert(e,createComponent(Show,{get when(){return state.selectedRegion!==void 0},fallback:Pads,get children(){return createComponent(RegionDetails,{get index(){return state.selectedRegion}})}})),e})(),scrollRegionIntoView=e=>{scrollElement&&contentElement&&(scrollElement.scrollLeft=e.start*contentElement.clientWidth-scrollElement.clientWidth/2)},FloatingControls=()=>(()=>{const e=_tmpl$6.cloneNode(!0);return e.style.setProperty("position","fixed"),e.style.setProperty("bottom","calc(var(--min-btn-dimension) * .25)"),e.style.setProperty("left","calc(var(--min-btn-dimension) * .25)"),e.style.setProperty("min-width","unset"),e.style.setProperty("z-index","2"),e.style.setProperty("display","flex"),e.style.setProperty("gap","calc(var(--min-btn-dimension) * .25)"),insert(e,createComponent(ToggleFxDialog,{}),null),insert(e,createComponent(ToggleLoop,{}),null),e})(),ToggleFxDialog=()=>(()=>{const e=_tmpl$15.cloneNode(!0);return e.$$click=()=>{const t=document.getElementById("settings-dialog");t instanceof HTMLDialogElement&&t.showModal()},e.style.setProperty("width","calc(var(--min-btn-dimension) * 1.25)"),e.style.setProperty("height","calc(var(--min-btn-dimension) * 1.25)"),e})(),ToggleLoop=()=>(()=>{const e=_tmpl$16.cloneNode(!0),t=e.firstChild,r=t.firstChild,n=r.nextSibling;return e.style.setProperty("width","calc(var(--min-btn-dimension) * 1.25)"),e.style.setProperty("height","calc(var(--min-btn-dimension) * 1.25)"),n.addEventListener("change",o=>{player.setLoop(o.target.checked)}),createRenderEffect(()=>n.disabled=player.playing()),createRenderEffect(()=>n.checked=player.loop()),e})();delegateEvents(["click","input","keydown"]);render(App,document.getElementById("root"));
