(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();const style$2="",sharedConfig={};function setHydrateContext(e){sharedConfig.context=e}const equalFn=(e,t)=>e===t,$PROXY=Symbol("solid-proxy"),$TRACK=Symbol("solid-track"),signalOptions={equals:equalFn};let runEffects=runQueue;const STALE=1,PENDING=2,UNOWNED={owned:null,cleanups:null,context:null,owner:null};var Owner=null;let Transition=null,Listener=null,Updates=null,Effects=null,ExecCount=0;function createRoot(e,t){const n=Listener,r=Owner,o=e.length===0,s=o?UNOWNED:{owned:null,cleanups:null,context:null,owner:t||r},i=o?e:()=>e(()=>untrack(()=>cleanNode(s)));Owner=s,Listener=null;try{return runUpdates(i,!0)}finally{Listener=n,Owner=r}}function createSignal(e,t){t=t?Object.assign({},signalOptions,t):signalOptions;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},r=o=>(typeof o=="function"&&(o=o(n.value)),writeSignal(n,o));return[readSignal.bind(n),r]}function createComputed(e,t,n){const r=createComputation(e,t,!0,STALE);updateComputation(r)}function createRenderEffect(e,t,n){const r=createComputation(e,t,!1,STALE);updateComputation(r)}function createEffect(e,t,n){runEffects=runUserEffects;const r=createComputation(e,t,!1,STALE),o=SuspenseContext&&lookup(Owner,SuspenseContext.id);o&&(r.suspense=o),r.user=!0,Effects?Effects.push(r):updateComputation(r)}function createMemo(e,t,n){n=n?Object.assign({},signalOptions,n):signalOptions;const r=createComputation(e,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,updateComputation(r),readSignal.bind(r)}function batch(e){return runUpdates(e,!1)}function untrack(e){const t=Listener;Listener=null;try{return e()}finally{Listener=t}}function onMount(e){createEffect(()=>untrack(e))}function onCleanup(e){return Owner===null||(Owner.cleanups===null?Owner.cleanups=[e]:Owner.cleanups.push(e)),e}function getListener(){return Listener}let SuspenseContext;function readSignal(){const e=Transition;if(this.sources&&(this.state||e))if(this.state===STALE||e)updateComputation(this);else{const t=Updates;Updates=null,runUpdates(()=>lookUpstream(this),!1),Updates=t}if(Listener){const t=this.observers?this.observers.length:0;Listener.sources?(Listener.sources.push(this),Listener.sourceSlots.push(t)):(Listener.sources=[this],Listener.sourceSlots=[t]),this.observers?(this.observers.push(Listener),this.observerSlots.push(Listener.sources.length-1)):(this.observers=[Listener],this.observerSlots=[Listener.sources.length-1])}return this.value}function writeSignal(e,t,n){let r=e.value;return(!e.comparator||!e.comparator(r,t))&&(e.value=t,e.observers&&e.observers.length&&runUpdates(()=>{for(let o=0;o<e.observers.length;o+=1){const s=e.observers[o],i=Transition&&Transition.running;i&&Transition.disposed.has(s),(i&&!s.tState||!i&&!s.state)&&(s.pure?Updates.push(s):Effects.push(s),s.observers&&markDownstream(s)),i||(s.state=STALE)}if(Updates.length>1e6)throw Updates=[],new Error},!1)),t}function updateComputation(e){if(!e.fn)return;cleanNode(e);const t=Owner,n=Listener,r=ExecCount;Listener=Owner=e,runComputation(e,e.value,r),Listener=n,Owner=t}function runComputation(e,t,n){let r;try{r=e.fn(t)}catch(o){e.pure&&(e.state=STALE),handleError(o)}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?writeSignal(e,r):e.value=r,e.updatedAt=n)}function createComputation(e,t,n,r=STALE,o){const s={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:Owner,context:null,pure:n};return Owner===null||Owner!==UNOWNED&&(Owner.owned?Owner.owned.push(s):Owner.owned=[s]),s}function runTop(e){const t=Transition;if(e.state===0||t)return;if(e.state===PENDING||t)return lookUpstream(e);if(e.suspense&&untrack(e.suspense.inFallback))return e.suspense.effects.push(e);const n=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<ExecCount);)(e.state||t)&&n.push(e);for(let r=n.length-1;r>=0;r--)if(e=n[r],e.state===STALE||t)updateComputation(e);else if(e.state===PENDING||t){const o=Updates;Updates=null,runUpdates(()=>lookUpstream(e,n[0]),!1),Updates=o}}function runUpdates(e,t){if(Updates)return e();let n=!1;t||(Updates=[]),Effects?n=!0:Effects=[],ExecCount++;try{const r=e();return completeUpdates(n),r}catch(r){Updates||(Effects=null),handleError(r)}}function completeUpdates(e){if(Updates&&(runQueue(Updates),Updates=null),e)return;const t=Effects;Effects=null,t.length&&runUpdates(()=>runEffects(t),!1)}function runQueue(e){for(let t=0;t<e.length;t++)runTop(e[t])}function runUserEffects(e){let t,n=0;for(t=0;t<e.length;t++){const r=e[t];r.user?e[n++]=r:runTop(r)}for(sharedConfig.context&&setHydrateContext(),t=0;t<n;t++)runTop(e[t])}function lookUpstream(e,t){const n=Transition;e.state=0;for(let r=0;r<e.sources.length;r+=1){const o=e.sources[r];o.sources&&(o.state===STALE||n?o!==t&&runTop(o):(o.state===PENDING||n)&&lookUpstream(o,t))}}function markDownstream(e){const t=Transition;for(let n=0;n<e.observers.length;n+=1){const r=e.observers[n];(!r.state||t)&&(r.state=PENDING,r.pure?Updates.push(r):Effects.push(r),r.observers&&markDownstream(r))}}function cleanNode(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),r=e.sourceSlots.pop(),o=n.observers;if(o&&o.length){const s=o.pop(),i=n.observerSlots.pop();r<o.length&&(s.sourceSlots[i]=r,o[r]=s,n.observerSlots[r]=i)}}if(e.owned){for(t=0;t<e.owned.length;t++)cleanNode(e.owned[t]);e.owned=null}if(e.cleanups){for(t=0;t<e.cleanups.length;t++)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function castError(e){return e instanceof Error||typeof e=="string"?e:new Error("Unknown error")}function handleError(e){throw e=castError(e),e}function lookup(e,t){return e?e.context&&e.context[t]!==void 0?e.context[t]:lookup(e.owner,t):void 0}const FALLBACK=Symbol("fallback");function dispose(e){for(let t=0;t<e.length;t++)e[t]()}function mapArray(e,t,n={}){let r=[],o=[],s=[],i=0,l=t.length>1?[]:null;return onCleanup(()=>dispose(s)),()=>{let a=e()||[],u,c;return a[$TRACK],untrack(()=>{let h=a.length,d,f,y,w,v,_,E,$,P;if(h===0)i!==0&&(dispose(s),s=[],r=[],o=[],i=0,l&&(l=[])),n.fallback&&(r=[FALLBACK],o[0]=createRoot(C=>(s[0]=C,n.fallback())),i=1);else if(i===0){for(o=new Array(h),c=0;c<h;c++)r[c]=a[c],o[c]=createRoot(m);i=h}else{for(y=new Array(h),w=new Array(h),l&&(v=new Array(h)),_=0,E=Math.min(i,h);_<E&&r[_]===a[_];_++);for(E=i-1,$=h-1;E>=_&&$>=_&&r[E]===a[$];E--,$--)y[$]=o[E],w[$]=s[E],l&&(v[$]=l[E]);for(d=new Map,f=new Array($+1),c=$;c>=_;c--)P=a[c],u=d.get(P),f[c]=u===void 0?-1:u,d.set(P,c);for(u=_;u<=E;u++)P=r[u],c=d.get(P),c!==void 0&&c!==-1?(y[c]=o[u],w[c]=s[u],l&&(v[c]=l[u]),c=f[c],d.set(P,c)):s[u]();for(c=_;c<h;c++)c in y?(o[c]=y[c],s[c]=w[c],l&&(l[c]=v[c],l[c](c))):o[c]=createRoot(m);o=o.slice(0,i=h),r=a.slice(0)}return o});function m(h){if(s[c]=h,l){const[d,f]=createSignal(c);return l[c]=f,t(a[c],d)}return t(a[c])}}}function createComponent(e,t){return untrack(()=>e(t||{}))}function trueFn(){return!0}const propTraps={get(e,t,n){return t===$PROXY?n:e.get(t)},has(e,t){return e.has(t)},set:trueFn,deleteProperty:trueFn,getOwnPropertyDescriptor(e,t){return{configurable:!0,enumerable:!0,get(){return e.get(t)},set:trueFn,deleteProperty:trueFn}},ownKeys(e){return e.keys()}};function resolveSource(e){return(e=typeof e=="function"?e():e)?e:{}}function mergeProps(...e){if(e.some(n=>n&&($PROXY in n||typeof n=="function")))return new Proxy({get(n){for(let r=e.length-1;r>=0;r--){const o=resolveSource(e[r])[n];if(o!==void 0)return o}},has(n){for(let r=e.length-1;r>=0;r--)if(n in resolveSource(e[r]))return!0;return!1},keys(){const n=[];for(let r=0;r<e.length;r++)n.push(...Object.keys(resolveSource(e[r])));return[...new Set(n)]}},propTraps);const t={};for(let n=e.length-1;n>=0;n--)if(e[n]){const r=Object.getOwnPropertyDescriptors(e[n]);for(const o in r)o in t||Object.defineProperty(t,o,{enumerable:!0,get(){for(let s=e.length-1;s>=0;s--){const i=(e[s]||{})[o];if(i!==void 0)return i}}})}return t}function splitProps(e,...t){const n=new Set(t.flat()),r=Object.getOwnPropertyDescriptors(e),o=$PROXY in e;o||t.push(Object.keys(r).filter(i=>!n.has(i)));const s=t.map(i=>{const l={};for(let a=0;a<i.length;a++){const u=i[a];!o&&!(u in e)||Object.defineProperty(l,u,r[u]?r[u]:{get(){return e[u]},set(){return!0},enumerable:!0})}return l});return o&&s.push(new Proxy({get(i){return n.has(i)?void 0:e[i]},has(i){return n.has(i)?!1:i in e},keys(){return Object.keys(e).filter(i=>!n.has(i))}},propTraps)),s}function For(e){const t="fallback"in e&&{fallback:()=>e.fallback};return createMemo(mapArray(()=>e.each,e.children,t||void 0))}function Show(e){let t=!1;const n=e.keyed,r=createMemo(()=>e.when,void 0,{equals:(o,s)=>t?o===s:!o==!s});return createMemo(()=>{const o=r();if(o){const s=e.children,i=typeof s=="function"&&s.length>0;return t=n||i,i?untrack(()=>s(o)):s}return e.fallback})}const booleans=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],Properties=new Set(["className","value","readOnly","formNoValidate","isMap","noModule","playsInline",...booleans]),ChildProperties=new Set(["innerHTML","textContent","innerText","children"]),Aliases=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),PropAliases=Object.assign(Object.create(null),{class:"className",formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly"}),DelegatedEvents=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),SVGNamespace={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"};function reconcileArrays(e,t,n){let r=n.length,o=t.length,s=r,i=0,l=0,a=t[o-1].nextSibling,u=null;for(;i<o||l<s;){if(t[i]===n[l]){i++,l++;continue}for(;t[o-1]===n[s-1];)o--,s--;if(o===i){const c=s<r?l?n[l-1].nextSibling:n[s-l]:a;for(;l<s;)e.insertBefore(n[l++],c)}else if(s===l)for(;i<o;)(!u||!u.has(t[i]))&&t[i].remove(),i++;else if(t[i]===n[s-1]&&n[l]===t[o-1]){const c=t[--o].nextSibling;e.insertBefore(n[l++],t[i++].nextSibling),e.insertBefore(n[--s],c),t[o]=n[s]}else{if(!u){u=new Map;let m=l;for(;m<s;)u.set(n[m],m++)}const c=u.get(t[i]);if(c!=null)if(l<c&&c<s){let m=i,h=1,d;for(;++m<o&&m<s&&!((d=u.get(t[m]))==null||d!==c+h);)h++;if(h>c-l){const f=t[i];for(;l<c;)e.insertBefore(n[l++],f)}else e.replaceChild(n[l++],t[i++])}else i++;else t[i++].remove()}}}const $$EVENTS="_$DX_DELEGATE";function render(e,t,n,r={}){let o;return createRoot(s=>{o=s,t===document?e():insert(t,e(),t.firstChild?null:void 0,n)},r.owner),()=>{o(),t.textContent=""}}function template(e,t,n){const r=document.createElement("template");r.innerHTML=e;let o=r.content.firstChild;return n&&(o=o.firstChild),o}function delegateEvents(e,t=window.document){const n=t[$$EVENTS]||(t[$$EVENTS]=new Set);for(let r=0,o=e.length;r<o;r++){const s=e[r];n.has(s)||(n.add(s),t.addEventListener(s,eventHandler))}}function setAttribute(e,t,n){n==null?e.removeAttribute(t):e.setAttribute(t,n)}function setAttributeNS(e,t,n,r){r==null?e.removeAttributeNS(t,n):e.setAttributeNS(t,n,r)}function className(e,t){t==null?e.removeAttribute("class"):e.className=t}function addEventListener$1(e,t,n,r){if(r)Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n;else if(Array.isArray(n)){const o=n[0];e.addEventListener(t,n[0]=s=>o.call(e,n[1],s))}else e.addEventListener(t,n)}function classList(e,t,n={}){const r=Object.keys(t||{}),o=Object.keys(n);let s,i;for(s=0,i=o.length;s<i;s++){const l=o[s];!l||l==="undefined"||t[l]||(toggleClassKey(e,l,!1),delete n[l])}for(s=0,i=r.length;s<i;s++){const l=r[s],a=!!t[l];!l||l==="undefined"||n[l]===a||!a||(toggleClassKey(e,l,!0),n[l]=a)}return n}function style$1(e,t,n){if(!t)return n?setAttribute(e,"style"):t;const r=e.style;if(typeof t=="string")return r.cssText=t;typeof n=="string"&&(r.cssText=n=void 0),n||(n={}),t||(t={});let o,s;for(s in n)t[s]==null&&r.removeProperty(s),delete n[s];for(s in t)o=t[s],o!==n[s]&&(r.setProperty(s,o),n[s]=o);return n}function spread(e,t={},n,r){const o={};return r||createRenderEffect(()=>o.children=insertExpression(e,t.children,o.children)),createRenderEffect(()=>t.ref&&t.ref(e)),createRenderEffect(()=>assign(e,t,n,!0,o,!0)),o}function use(e,t,n){return untrack(()=>e(t,n))}function insert(e,t,n,r){if(n!==void 0&&!r&&(r=[]),typeof t!="function")return insertExpression(e,t,r,n);createRenderEffect(o=>insertExpression(e,t(),o,n),r)}function assign(e,t,n,r,o={},s=!1){t||(t={});for(const i in o)if(!(i in t)){if(i==="children")continue;o[i]=assignProp(e,i,null,o[i],n,s)}for(const i in t){if(i==="children"){r||insertExpression(e,t.children);continue}const l=t[i];o[i]=assignProp(e,i,l,o[i],n,s)}}function toPropertyName(e){return e.toLowerCase().replace(/-([a-z])/g,(t,n)=>n.toUpperCase())}function toggleClassKey(e,t,n){const r=t.trim().split(/\s+/);for(let o=0,s=r.length;o<s;o++)e.classList.toggle(r[o],n)}function assignProp(e,t,n,r,o,s){let i,l,a;if(t==="style")return style$1(e,n,r);if(t==="classList")return classList(e,n,r);if(n===r)return r;if(t==="ref")s||n(e);else if(t.slice(0,3)==="on:"){const u=t.slice(3);r&&e.removeEventListener(u,r),n&&e.addEventListener(u,n)}else if(t.slice(0,10)==="oncapture:"){const u=t.slice(10);r&&e.removeEventListener(u,r,!0),n&&e.addEventListener(u,n,!0)}else if(t.slice(0,2)==="on"){const u=t.slice(2).toLowerCase(),c=DelegatedEvents.has(u);if(!c&&r){const m=Array.isArray(r)?r[0]:r;e.removeEventListener(u,m)}(c||n)&&(addEventListener$1(e,u,n,c),c&&delegateEvents([u]))}else if((a=ChildProperties.has(t))||!o&&(PropAliases[t]||(l=Properties.has(t)))||(i=e.nodeName.includes("-")))t==="class"||t==="className"?className(e,n):i&&!l&&!a?e[toPropertyName(t)]=n:e[PropAliases[t]||t]=n;else{const u=o&&t.indexOf(":")>-1&&SVGNamespace[t.split(":")[0]];u?setAttributeNS(e,u,t,n):setAttribute(e,Aliases[t]||t,n)}return n}function eventHandler(e){const t=`$$${e.type}`;let n=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==n&&Object.defineProperty(e,"target",{configurable:!0,value:n}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return n||document}}),sharedConfig.registry&&!sharedConfig.done&&(sharedConfig.done=!0,document.querySelectorAll("[id^=pl-]").forEach(r=>r.remove()));n!==null;){const r=n[t];if(r&&!n.disabled){const o=n[`${t}Data`];if(o!==void 0?r.call(n,o,e):r.call(n,e),e.cancelBubble)return}n=n.host&&n.host!==n&&n.host instanceof Node?n.host:n.parentNode}}function insertExpression(e,t,n,r,o){for(sharedConfig.context&&!n&&(n=[...e.childNodes]);typeof n=="function";)n=n();if(t===n)return n;const s=typeof t,i=r!==void 0;if(e=i&&n[0]&&n[0].parentNode||e,s==="string"||s==="number"){if(sharedConfig.context)return n;if(s==="number"&&(t=t.toString()),i){let l=n[0];l&&l.nodeType===3?l.data=t:l=document.createTextNode(t),n=cleanChildren(e,n,r,l)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t}else if(t==null||s==="boolean"){if(sharedConfig.context)return n;n=cleanChildren(e,n,r)}else{if(s==="function")return createRenderEffect(()=>{let l=t();for(;typeof l=="function";)l=l();n=insertExpression(e,l,n,r)}),()=>n;if(Array.isArray(t)){const l=[],a=n&&Array.isArray(n);if(normalizeIncomingArray(l,t,n,o))return createRenderEffect(()=>n=insertExpression(e,l,n,r,!0)),()=>n;if(sharedConfig.context){if(!l.length)return n;for(let u=0;u<l.length;u++)if(l[u].parentNode)return n=l}if(l.length===0){if(n=cleanChildren(e,n,r),i)return n}else a?n.length===0?appendNodes(e,l,r):reconcileArrays(e,n,l):(n&&cleanChildren(e),appendNodes(e,l));n=l}else if(t instanceof Node){if(sharedConfig.context&&t.parentNode)return n=i?[t]:t;if(Array.isArray(n)){if(i)return n=cleanChildren(e,n,r,t);cleanChildren(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function normalizeIncomingArray(e,t,n,r){let o=!1;for(let s=0,i=t.length;s<i;s++){let l=t[s],a=n&&n[s];if(l instanceof Node)e.push(l);else if(!(l==null||l===!0||l===!1))if(Array.isArray(l))o=normalizeIncomingArray(e,l,a)||o;else if(typeof l=="function")if(r){for(;typeof l=="function";)l=l();o=normalizeIncomingArray(e,Array.isArray(l)?l:[l],Array.isArray(a)?a:[a])||o}else e.push(l),o=!0;else{const u=String(l);a&&a.nodeType===3&&a.data===u?e.push(a):e.push(document.createTextNode(u))}}return o}function appendNodes(e,t,n=null){for(let r=0,o=t.length;r<o;r++)e.insertBefore(t[r],n)}function cleanChildren(e,t,n,r){if(n===void 0)return e.textContent="";const o=r||document.createTextNode("");if(t.length){let s=!1;for(let i=t.length-1;i>=0;i--){const l=t[i];if(o!==l){const a=l.parentNode===e;!s&&!i?a?e.replaceChild(o,l):e.insertBefore(o,n):a&&l.remove()}else s=!0}}else e.insertBefore(o,n);return[o]}const _tmpl$$8=template("<button>from file</button>"),_tmpl$2$2=template('<input type="file" style="display: none;" accept=".mp3, .wav, .m4a">'),AudioInput=e=>{let t;return[(()=>{const n=_tmpl$$8.cloneNode(!0);return n.$$click=()=>t?.click(),n})(),(()=>{const n=_tmpl$2$2.cloneNode(!0);n.addEventListener("change",o=>{const[s]=[...o.currentTarget.files||[]];!s||e.onChange(s)});const r=t;return typeof r=="function"?use(r,n):t=n,n})()]};delegateEvents(["click"]);function unmute(e,t=!1,n=!1){let r;document.hidden!==void 0?r={hidden:"hidden",visibilitychange:"visibilitychange"}:document.webkitHidden!==void 0?r={hidden:"webkitHidden",visibilitychange:"webkitvisibilitychange"}:document.mozHidden!==void 0?r={hidden:"mozHidden",visibilitychange:"mozvisibilitychange"}:document.msHidden!==void 0&&(r={hidden:"msHidden",visibilitychange:"msvisibilitychange"});function o(x,A,N,L,p){for(let b=0;b<A.length;++b)x.addEventListener(A[b],N,{capture:L,passive:p})}function s(x,A,N,L,p){for(let b=0;b<A.length;++b)x.removeEventListener(A[b],N,{capture:L,passive:p})}function i(){}let l=navigator.userAgent.toLowerCase(),a=n||l.indexOf("iphone")>=0&&l.indexOf("like iphone")<0||l.indexOf("ipad")>=0&&l.indexOf("like ipad")<0||l.indexOf("ipod")>=0&&l.indexOf("like ipod")<0||l.indexOf("mac os x")>=0&&navigator.maxTouchPoints>0,u=!0;function c(){let x=!!(t||(!r||!document[r.hidden])&&(!a||document.hasFocus()));x!==u&&(u=x,_(!1),d())}function m(){c()}r&&o(document,[r.visibilitychange],m,!0,!0);function h(x){x&&x.target!==window||c()}a&&o(window,["focus","blur"],h,!0,!0);function d(){if(u){if(e.state!=="running"&&e.state!=="closed"&&P){let x=e.resume();x&&x.then(i,i).catch(i)}}else if(e.state==="running"){let x=e.suspend();x&&x.then(i,i).catch(i)}}function f(x){(!x||!x.unmute_handled)&&(x.unmute_handled=!0,d())}o(e,["statechange"],f,!0,!0),e.onstatechange||(e.onstatechange=f);let y=null;function w(x,A){let N=A;for(;x>1;x--)N+=A;return N}let v="data:audio/mpeg;base64,//uQx"+w(23,"A")+"WGluZwAAAA8AAAACAAACcQCA"+w(16,"gICA")+w(66,"/")+"8AAABhTEFNRTMuMTAwA8MAAAAAAAAAABQgJAUHQQAB9AAAAnGMHkkI"+w(320,"A")+"//sQxAADgnABGiAAQBCqgCRMAAgEAH"+w(15,"/")+"7+n/9FTuQsQH//////2NG0jWUGlio5gLQTOtIoeR2WX////X4s9Atb/JRVCbBUpeRUq"+w(18,"/")+"9RUi0f2jn/+xDECgPCjAEQAABN4AAANIAAAAQVTEFNRTMuMTAw"+w(97,"V")+"Q==";function _(x){if(a)if(u){if(x){if(!y){let A=document.createElement("div");A.innerHTML="<audio x-webkit-airplay='deny'></audio>",y=A.children.item(0),y.controls=!1,y.disableRemotePlayback=!0,y.preload="auto",y.src=v,y.loop=!0,y.load()}if(y.paused){let A=y.play();A&&A.then(i,E).catch(E)}}}else E()}function E(){y&&(y.src="about:blank",y.load(),y=null)}const $=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let P=!1;function C(){P=!0,_(!0),d()}return o(window,$,C,!0,!0),{dispose:function(){E(),r&&s(document,[r.visibilitychange],m,!0,!0),a&&s(window,["focus","blur"],h,!0,!0),s(window,$,C,!0,!0),s(e,["statechange"],f,!0,!0),e.onstatechange===f&&(e.onstatechange=null)}}}const audioContext=new AudioContext;unmute(audioContext);const useAnimationFrame=e=>{let t;const n=()=>{e(),t=requestAnimationFrame(n)};onMount(()=>{t=requestAnimationFrame(n)}),onCleanup(()=>{cancelAnimationFrame(t)})};var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},audiobufferToWav=audioBufferToWav;function audioBufferToWav(e,t){t=t||{};var n=e.numberOfChannels,r=e.sampleRate,o=t.float32?3:1,s=o===3?32:16,i;return n===2?i=interleave(e.getChannelData(0),e.getChannelData(1)):i=e.getChannelData(0),encodeWAV(i,o,r,n,s)}function encodeWAV(e,t,n,r,o){var s=o/8,i=r*s,l=new ArrayBuffer(44+e.length*s),a=new DataView(l);return writeString(a,0,"RIFF"),a.setUint32(4,36+e.length*s,!0),writeString(a,8,"WAVE"),writeString(a,12,"fmt "),a.setUint32(16,16,!0),a.setUint16(20,t,!0),a.setUint16(22,r,!0),a.setUint32(24,n,!0),a.setUint32(28,n*i,!0),a.setUint16(32,i,!0),a.setUint16(34,o,!0),writeString(a,36,"data"),a.setUint32(40,e.length*s,!0),t===1?floatTo16BitPCM(a,44,e):writeFloat32(a,44,e),l}function interleave(e,t){for(var n=e.length+t.length,r=new Float32Array(n),o=0,s=0;o<n;)r[o++]=e[s],r[o++]=t[s],s++;return r}function writeFloat32(e,t,n){for(var r=0;r<n.length;r++,t+=4)e.setFloat32(t,n[r],!0)}function floatTo16BitPCM(e,t,n){for(var r=0;r<n.length;r++,t+=2){var o=Math.max(-1,Math.min(1,n[r]));e.setInt16(t,o<0?o*32768:o*32767,!0)}}function writeString(e,t,n){for(var r=0;r<n.length;r++)e.setUint8(t+r,n.charCodeAt(r))}const player=createPlayer(audioContext);window.player=player;function createFxAssembly(e){const t=e.createBiquadFilter();t.type="lowpass",t.Q.value=0;const n=e.createBiquadFilter();n.type="highpass",n.Q.value=0;const r=e.createDynamicsCompressor(),o=e.createGain();return t.connect(n).connect(r).connect(o),{in:t,out:o,loPassFreq:t.frequency,hiPassFreq:n.frequency,compressionThreshold:r.threshold,gain:o.gain}}function createPlayer(e){const[t,n]=createSignal(void 0),[r,o]=createSignal({start:0,end:1});let s;const[i,l]=createSignal(!1),[a,u]=createSignal(0),[c,m]=createSignal(0),[h,d]=createSignal(100),[f,y]=createSignal(0),[w,v]=createSignal(0),[_,E]=createSignal(0),$=()=>{const p=c()+100*a();return Math.pow(2,p/1200)},P=createFxAssembly(e);P.out.connect(e.destination),createEffect(()=>{rampTo(P.gain,Math.pow(10,_()/20))}),createEffect(()=>{rampTo(P.hiPassFreq,mapLinearToLogarithmic(f()))}),createEffect(()=>{rampTo(P.loPassFreq,mapLinearToLogarithmic(h()))}),createEffect(()=>{rampTo(P.compressionThreshold,w())}),createEffect(()=>{$();const p=s?.sourceAssembly.sourceNode.buffer;p&&(x(),C(p,r()))});const C=(p,b={start:0,end:1})=>{x(),o(b),n(e.currentTime),i()?s=schedulePlaybackLoop(e,p,b,$(),P.in):s={sourceAssembly:schedulePlaybackSingle(e,p,b,$(),P.in,x)}},x=()=>{!s||(clearInterval(s.gainEnvelopeScheduler),smoothStop(s.sourceAssembly),s=void 0,n(void 0))},A=()=>t()!==void 0,[N,L]=createSignal(0);return useAnimationFrame(()=>{const p=t();if(!p||!s?.sourceAssembly.sourceNode.buffer)return;const b=(r().end-r().start)*s.sourceAssembly.sourceNode.buffer.duration,k=(e.currentTime-p)*$()%b,S=s.sourceAssembly.sourceNode.buffer.duration*r().start,R=k+S;L(R/s.sourceAssembly.sourceNode.buffer.duration)}),{play:C,playing:A,region:r,stop:x,progress:N,loop:i,setLoop:l,pitchOffsetSemis:a,setPitchOffsetSemis:u,pitchOffsetCents:c,setPitchOffsetCents:m,loPass:h,setLoPass:p=>{p<f()&&y(p),d(p)},hiPass:f,setHiPass:p=>{h()<p&&d(p),y(p)},speed:$,compressionThreshold:w,setCompressionThreshold:v,gain:_,setGain:E}}window.createPlayer=createPlayer;function rampTo(e,t,n=.001){e.cancelScheduledValues(audioContext.currentTime),e.value=e.value,e.linearRampToValueAtTime(t,audioContext.currentTime+n)}const smoothStop=(e,t=.001)=>{const n=audioContext.currentTime+t;e.gainNode.gain.cancelScheduledValues(audioContext.currentTime),e.gainNode.gain.setValueAtTime(1,audioContext.currentTime),e.gainNode.gain.linearRampToValueAtTime(0,n),e.sourceNode.onended=null,e.sourceNode.stop(n)},schedulePlaybackSingle=(e,t,n,r,o,s)=>{const i=e.currentTime,l=t.duration*n.start,a=t.duration*(n.end-n.start),u=e.createGain();u.connect(o);const c=e.createBufferSource();return c.playbackRate.value=r,c.buffer=t,c.connect(u),s&&(c.onended=s),scheduleEnvelope(u,{start:i,end:i+a/r,ramp:.001}),c.start(i,l,a),{sourceNode:c,gainNode:u}},schedulePlaybackLoop=(e,t,n,r,o)=>{const s=e.currentTime,i=t.duration*n.start,l=t.duration*n.end,a=e.createGain();a.connect(o);const u=e.createBufferSource();u.buffer=t,u.loop=!0,u.loopStart=i,u.loopEnd=l,u.playbackRate.value=r,u.connect(a);const c={sourceNode:u,gainNode:a},m=startEnvelopeScheduler(c,n,s,r);return u.start(s,i),{sourceAssembly:c,gainEnvelopeScheduler:m}},startEnvelopeScheduler=(e,t,n,r)=>{const o=(t.end-t.start)*(e.sourceNode.buffer?.duration||1)/r;let s=-1;const i=()=>{const l=audioContext.currentTime+1;for(let a=s+1;a*o+n<l;a++)s=a,scheduleEnvelope(e.gainNode,{start:n+a*o,end:n+(a+1)*o,ramp:.001})};return i(),setInterval(i,300)},scheduleEnvelope=(e,t)=>{e.gain.setValueAtTime(0,t.start),e.gain.linearRampToValueAtTime(1,t.start+t.ramp),e.gain.setValueAtTime(1,t.end-t.ramp),e.gain.linearRampToValueAtTime(0,t.end)},print=async(e,t,n,r,o,s,i)=>{const l=new OfflineAudioContext(e.numberOfChannels,e.duration*e.sampleRate*(t.end-t.start)/n,e.sampleRate),a=createFxAssembly(l);a.hiPassFreq.value=mapLinearToLogarithmic(r),a.loPassFreq.value=mapLinearToLogarithmic(o),a.compressionThreshold.value=s,a.gain.value=Math.pow(10,i/20),a.out.connect(l.destination),schedulePlaybackSingle(l,e,t,n,a.in);const u=await l.startRendering(),c=audiobufferToWav(u),m=await crypto.subtle.digest("SHA-256",c),d=Array.from(new Uint8Array(m)).map(f=>f.toString(16).padStart(2,"0")).join("")+".wav";return{wav:c,fileName:d}};function mapLinearToLogarithmic(e){const s=(Math.log10(2e4)-Math.log10(20))*((e-0)/100);return Math.pow(10,Math.log10(20)+s)}const download=async(e,t,n,r,o,s,i)=>{const{wav:l,fileName:a}=await print(e,t,n,o,r,s,i),u=URL.createObjectURL(new Blob([l],{type:"audio/wav"})),c=document.createElement("a");c.href=u,c.setAttribute("download",a),c.click(),URL.revokeObjectURL(u)},share=async(e,t,n,r,o,s,i)=>{const{wav:l,fileName:a}=await print(e,t,n,o,r,s,i),u=new File([l],a,{type:"audio/wav"});navigator.share({files:[u]})},$RAW=Symbol("store-raw"),$NODE=Symbol("store-node"),$NAME=Symbol("store-name");function wrap$1(e,t){let n=e[$PROXY];if(!n&&(Object.defineProperty(e,$PROXY,{value:n=new Proxy(e,proxyTraps$1)}),!Array.isArray(e))){const r=Object.keys(e),o=Object.getOwnPropertyDescriptors(e);for(let s=0,i=r.length;s<i;s++){const l=r[s];if(o[l].get){const a=o[l].get.bind(n);Object.defineProperty(e,l,{enumerable:o[l].enumerable,get:a})}}}return n}function isWrappable(e){let t;return e!=null&&typeof e=="object"&&(e[$PROXY]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function unwrap(e,t=new Set){let n,r,o,s;if(n=e!=null&&e[$RAW])return n;if(!isWrappable(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let i=0,l=e.length;i<l;i++)o=e[i],(r=unwrap(o,t))!==o&&(e[i]=r)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const i=Object.keys(e),l=Object.getOwnPropertyDescriptors(e);for(let a=0,u=i.length;a<u;a++)s=i[a],!l[s].get&&(o=e[s],(r=unwrap(o,t))!==o&&(e[s]=r))}return e}function getDataNodes(e){let t=e[$NODE];return t||Object.defineProperty(e,$NODE,{value:t={}}),t}function getDataNode(e,t,n){return e[t]||(e[t]=createDataNode(n))}function proxyDescriptor$1(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return!n||n.get||!n.configurable||t===$PROXY||t===$NODE||t===$NAME||(delete n.value,delete n.writable,n.get=()=>e[$PROXY][t]),n}function trackSelf(e){if(getListener()){const t=getDataNodes(e);(t._||(t._=createDataNode()))()}}function ownKeys(e){return trackSelf(e),Reflect.ownKeys(e)}function createDataNode(e){const[t,n]=createSignal(e,{equals:!1,internal:!0});return t.$=n,t}const proxyTraps$1={get(e,t,n){if(t===$RAW)return e;if(t===$PROXY)return n;if(t===$TRACK)return trackSelf(e),n;const r=getDataNodes(e),o=r.hasOwnProperty(t);let s=o?r[t]():e[t];if(t===$NODE||t==="__proto__")return s;if(!o){const i=Object.getOwnPropertyDescriptor(e,t);getListener()&&(typeof s!="function"||e.hasOwnProperty(t))&&!(i&&i.get)&&(s=getDataNode(r,t,s)())}return isWrappable(s)?wrap$1(s):s},has(e,t){return t===$RAW||t===$PROXY||t===$TRACK||t===$NODE||t==="__proto__"?!0:(this.get(e,t,e),t in e)},set(){return!0},deleteProperty(){return!0},ownKeys,getOwnPropertyDescriptor:proxyDescriptor$1};function setProperty(e,t,n,r=!1){if(!r&&e[t]===n)return;const o=e[t],s=e.length;n===void 0?delete e[t]:e[t]=n;let i=getDataNodes(e),l;(l=getDataNode(i,t,o))&&l.$(()=>n),Array.isArray(e)&&e.length!==s&&(l=getDataNode(i,"length",s))&&l.$(e.length),(l=i._)&&l.$()}function mergeStoreNode(e,t){const n=Object.keys(t);for(let r=0;r<n.length;r+=1){const o=n[r];setProperty(e,o,t[o])}}function updateArray(e,t){if(typeof t=="function"&&(t=t(e)),t=unwrap(t),Array.isArray(t)){if(e===t)return;let n=0,r=t.length;for(;n<r;n++){const o=t[n];e[n]!==o&&setProperty(e,n,o)}setProperty(e,"length",r)}else mergeStoreNode(e,t)}function updatePath(e,t,n=[]){let r,o=e;if(t.length>1){r=t.shift();const i=typeof r,l=Array.isArray(e);if(Array.isArray(r)){for(let a=0;a<r.length;a++)updatePath(e,[r[a]].concat(t),n);return}else if(l&&i==="function"){for(let a=0;a<e.length;a++)r(e[a],a)&&updatePath(e,[a].concat(t),n);return}else if(l&&i==="object"){const{from:a=0,to:u=e.length-1,by:c=1}=r;for(let m=a;m<=u;m+=c)updatePath(e,[m].concat(t),n);return}else if(t.length>1){updatePath(e[r],t,[r].concat(n));return}o=e[r],n=[r].concat(n)}let s=t[0];typeof s=="function"&&(s=s(o,n),s===o)||r===void 0&&s==null||(s=unwrap(s),r===void 0||isWrappable(o)&&isWrappable(s)&&!Array.isArray(s)?mergeStoreNode(o,s):setProperty(e,r,s))}function createStore(...[e,t]){const n=unwrap(e||{}),r=Array.isArray(n),o=wrap$1(n);function s(...i){batch(()=>{r&&i.length===1?updateArray(n,i[0]):updatePath(n,i)})}return[o,s]}const $ROOT=Symbol("store-root");function applyState(e,t,n,r,o){const s=t[n];if(e===s)return;if(!isWrappable(e)||!isWrappable(s)||o&&e[o]!==s[o]){if(e!==s){if(n===$ROOT)return e;setProperty(t,n,e)}return}if(Array.isArray(e)){if(e.length&&s.length&&(!r||o&&e[0][o]!=null)){let a,u,c,m,h,d,f,y;for(c=0,m=Math.min(s.length,e.length);c<m&&(s[c]===e[c]||o&&s[c][o]===e[c][o]);c++)applyState(e[c],s,c,r,o);const w=new Array(e.length),v=new Map;for(m=s.length-1,h=e.length-1;m>=c&&h>=c&&(s[m]===e[h]||o&&s[m][o]===e[h][o]);m--,h--)w[h]=s[m];if(c>h||c>m){for(u=c;u<=h;u++)setProperty(s,u,e[u]);for(;u<e.length;u++)setProperty(s,u,w[u]),applyState(e[u],s,u,r,o);s.length>e.length&&setProperty(s,"length",e.length);return}for(f=new Array(h+1),u=h;u>=c;u--)d=e[u],y=o?d[o]:d,a=v.get(y),f[u]=a===void 0?-1:a,v.set(y,u);for(a=c;a<=m;a++)d=s[a],y=o?d[o]:d,u=v.get(y),u!==void 0&&u!==-1&&(w[u]=s[a],u=f[u],v.set(y,u));for(u=c;u<e.length;u++)u in w?(setProperty(s,u,w[u]),applyState(e[u],s,u,r,o)):setProperty(s,u,e[u])}else for(let a=0,u=e.length;a<u;a++)applyState(e[a],s,a,r,o);s.length>e.length&&setProperty(s,"length",e.length);return}const i=Object.keys(e);for(let a=0,u=i.length;a<u;a++)applyState(e[i[a]],s,i[a],r,o);const l=Object.keys(s);for(let a=0,u=l.length;a<u;a++)e[l[a]]===void 0&&setProperty(s,l[a],void 0)}function reconcile(e,t={}){const{merge:n,key:r="id"}=t,o=unwrap(e);return s=>{if(!isWrappable(s)||!isWrappable(o))return o;const i=applyState(o,{[$ROOT]:s},$ROOT,n,r);return i===void 0?s:i}}const range=(e,t,n=1)=>[...new Array(Math.ceil((t-e)/n))].map((r,o)=>o*n),defaultState=Object.freeze({cursor:0,mode:"slice",cursorControlsVisible:!1,clip:void 0,regions:[{start:0,end:1}],selectedRegion:void 0}),[store,setStore]=createStore(defaultState),state=store;let[undoStack,setUndoStack]=createSignal([],{equals:!1}),[redoStack,setRedoStack]=createSignal([],{equals:!1}),lastDispatchTime=Date.now();const dispatch=e=>{switch(e.type){case"reset":{setUndoStack([]),setRedoStack([]),setStore(defaultState);break}case"setClip":{setUndoStack([]),setRedoStack([]),setStore("clip",e.clip);break}case"setCursor":{setStore("cursor",Math.max(0,Math.min(e.pos,1)));break}case"showCursorControls":{setStore("cursorControlsVisible",!0);break}case"hideCursorControls":{setStore("cursorControlsVisible",!1);break}case"setMode":{setStore("mode",e.mode);break}case"selectRegion":{setStore("selectedRegion",e.index);break}default:{const t=undoStack()[undoStack().length-1];e.type==="moveSlice"&&t?.forward.type==="moveSlice"&&e.index===t?.forward.index&&Date.now()-lastDispatchTime<1e3?setUndoStack(n=>(n[n.length-1]={forward:e,backward:t.backward},n)):setUndoStack(n=>(n.push(migrationOfEvent(e)),n)),setRedoStack([]),updateRegions(e)}}lastDispatchTime=Date.now()},migrationOfEvent=e=>{switch(e.type){case"slice":return{forward:e,backward:{type:"healSlice",index:e.index+1}};case"segmentRegion":return{forward:e,backward:{type:"combineRegions",startIndex:e.index,endIndex:e.index+e.pieces-1}};case"combineRegions":return{forward:e,backward:{type:"segmentRegion",index:e.startIndex,pieces:e.endIndex-e.startIndex}};case"healSlice":return{forward:e,backward:{type:"slice",index:e.index-1,pos:state.regions[e.index].start}};case"moveSlice":return{forward:e,backward:{...e,pos:state.regions[e.index].start}}}},updateRegions=e=>{switch(e.type){case"slice":{const t=store.regions[e.index];return!t||e.pos<=t.start||e.pos>=t.end?void 0:(same(player.region(),t)&&player.stop(),setStore("regions",n=>[...n.slice(0,e.index),{start:t.start,end:e.pos},{start:e.pos,end:t.end},...n.slice(e.index+1)]))}case"segmentRegion":{const t=store.regions[e.index];if(!t)return;const n=(t.end-t.start)/e.pieces;return same(player.region(),t)&&player.stop(),setStore("regions",r=>[...r.slice(0,e.index),...range(0,e.pieces).map(o=>({start:t.start+n*o,end:t.start+n*(o+1)})),...r.slice(e.index+1)])}case"combineRegions":{if(!state.regions[e.startIndex]||!state.regions[e.endIndex]||e.endIndex<=e.startIndex)return;state.selectedRegion&&state.selectedRegion>e.startIndex&&(state.selectedRegion<=e.endIndex?setStore("selectedRegion",e.startIndex):setStore("selectedRegion",state.selectedRegion-(e.endIndex-e.startIndex))),setStore("regions",t=>{const n=t[e.startIndex],r=t[e.endIndex];return!n||!r?t:[...t.slice(0,e.startIndex),{start:n.start,end:r.end},...t.slice(e.endIndex+1)]});return}case"healSlice":{const t=store.regions[e.index],n=store.regions[e.index-1];return!t||!n?void 0:((same(player.region(),t)||same(player.region(),n))&&player.stop(),setStore("regions",r=>[...r.slice(0,e.index).map((o,s)=>s===e.index-1?{start:o.start,end:r[e.index+1]?.start||1}:o),...r.slice(e.index+1)]))}case"moveSlice":{const t=store.regions[e.index],n=store.regions[e.index-1];if(!t||!n||e.pos<=n.start||e.pos>=t.end)return;(same(player.region(),t)||same(player.region(),n))&&player.stop(),setStore("regions",e.index-1,r=>({start:r.start,end:e.pos})),setStore("regions",e.index,r=>({start:e.pos,end:r.end}));return}}};window.dispatch=dispatch;window.state=state;const same=(e,t)=>e.start===t.start&&e.end===t.end,roughUndo=()=>{const e=undoStack().pop();setUndoStack(t=>t),e&&(setRedoStack(t=>(t.push(e),t)),updateRegions(e.backward),state.selectedRegion&&state.selectedRegion>=state.regions.length&&setStore("selectedRegion",state.regions.length-1))},roughRedo=()=>{const e=redoStack().pop();setRedoStack(t=>t),e&&(updateRegions(e.forward),undoStack().push(e),setUndoStack(t=>t))},undo={execute:roughUndo,disabled:()=>undoStack().length===0},redo={execute:roughRedo,disabled:()=>redoStack().length===0};window.undo=roughUndo;window.redo=roughRedo;/**
 * solid-virtual
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 *//**
 * virtual-core
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var props=["bottom","height","left","right","top","width"],rectChanged=function(t,n){return t===void 0&&(t={}),n===void 0&&(n={}),props.some(function(r){return t[r]!==n[r]})},observedNodes=new Map,rafId,run=function e(){var t=[];observedNodes.forEach(function(n,r){var o=r.getBoundingClientRect();rectChanged(o,n.rect)&&(n.rect=o,t.push(n))}),t.forEach(function(n){n.callbacks.forEach(function(r){return r(n.rect)})}),rafId=window.requestAnimationFrame(e)};function observeRect(e,t){return{observe:function(){var r=observedNodes.size===0;observedNodes.has(e)?observedNodes.get(e).callbacks.push(t):observedNodes.set(e,{rect:void 0,hasRectChanged:!1,callbacks:[t]}),r&&run()},unobserve:function(){var r=observedNodes.get(e);if(r){var o=r.callbacks.indexOf(t);o>=0&&r.callbacks.splice(o,1),r.callbacks.length||observedNodes.delete(e),observedNodes.size||cancelAnimationFrame(rafId)}}}}function memo(e,t,n){let r=[],o;return()=>{let s;n.key&&n.debug!=null&&n.debug()&&(s=Date.now());const i=e();if(!(i.length!==r.length||i.some((u,c)=>r[c]!==u)))return o;r=i;let a;if(n.key&&n.debug!=null&&n.debug()&&(a=Date.now()),o=t(...i),n==null||n.onChange==null||n.onChange(o),n.key&&n.debug!=null&&n.debug()){const u=Math.round((Date.now()-s)*100)/100,c=Math.round((Date.now()-a)*100)/100,m=c/16,h=(d,f)=>{for(d=String(d);d.length<f;)d=" "+d;return d};console.info("%c\u23F1 "+h(c,5)+" /"+h(u,5)+" ms",`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(`+Math.max(0,Math.min(120-120*m,120))+"deg 100% 31%);",n?.key)}return o}}const defaultKeyExtractor=e=>e,defaultRangeExtractor=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let o=t;o<=n;o++)r.push(o);return r},observeElementRect=(e,t)=>{const n=observeRect(e.scrollElement,r=>{t(r)});if(!!e.scrollElement)return t(e.scrollElement.getBoundingClientRect()),n.observe(),()=>{n.unobserve()}},observeElementOffset=(e,t)=>{const n=()=>t(e.scrollElement[e.options.horizontal?"scrollLeft":"scrollTop"]);if(!!e.scrollElement)return n(),e.scrollElement.addEventListener("scroll",n,{capture:!1,passive:!0}),()=>{e.scrollElement.removeEventListener("scroll",n)}},measureElement=(e,t)=>e.getBoundingClientRect()[t.options.horizontal?"width":"height"],elementScroll=(e,t,n)=>{var r;(r=n.scrollElement)==null||r.scrollTo({[n.options.horizontal?"left":"top"]:e,behavior:t?"smooth":void 0})};class Virtualizer{constructor(t){var n=this;this.unsubs=[],this.scrollElement=null,this.measurementsCache=[],this.itemMeasurementsCache={},this.pendingMeasuredCacheIndexes=[],this.measureElementCache={},this.setOptions=r=>{Object.entries(r).forEach(o=>{let[s,i]=o;typeof i>"u"&&delete r[s]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:defaultKeyExtractor,rangeExtractor:defaultRangeExtractor,enableSmoothScroll:!0,onChange:()=>{},measureElement,initialRect:{width:0,height:0},...r}},this.notify=()=>{var r,o;(r=(o=this.options).onChange)==null||r.call(o,this)},this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(r=>r()),this.unsubs=[]},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{const r=this.options.getScrollElement();this.scrollElement!==r&&(this.cleanup(),this.scrollElement=r,this.unsubs.push(this.options.observeElementRect(this,o=>{this.scrollRect=o,this.notify()})),this.unsubs.push(this.options.observeElementOffset(this,o=>{this.scrollOffset=o,this.notify()})))},this.getSize=()=>this.scrollRect[this.options.horizontal?"width":"height"],this.getMeasurements=memo(()=>[this.options.count,this.options.paddingStart,this.options.getItemKey,this.itemMeasurementsCache],(r,o,s,i)=>{const l=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const a=this.measurementsCache.slice(0,l);for(let u=l;u<r;u++){const c=s(u),m=i[c],h=a[u-1]?a[u-1].end:o,d=typeof m=="number"?m:this.options.estimateSize(u),f=h+d;a[u]={index:u,start:h,size:d,end:f,key:c}}return this.measurementsCache=a,a},{key:!1,debug:()=>this.options.debug}),this.calculateRange=memo(()=>[this.getMeasurements(),this.getSize(),this.scrollOffset],(r,o,s)=>calculateRange({measurements:r,outerSize:o,scrollOffset:s}),{key:!1,debug:()=>this.options.debug}),this.getIndexes=memo(()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count],(r,o,s,i)=>r({...o,overscan:s,count:i}),{key:!1}),this.getVirtualItems=memo(()=>[this.getIndexes(),this.getMeasurements(),this.options.measureElement],(r,o,s)=>{const i=c=>m=>{var h;const d=this.measurementsCache[c];if(!m)return;const f=s(m,this),y=(h=this.itemMeasurementsCache[d.key])!=null?h:d.size;f!==y&&(d.start<this.scrollOffset&&(this.destinationOffset||this._scrollToOffset(this.scrollOffset+(f-y),!1)),this.pendingMeasuredCacheIndexes.push(c),this.itemMeasurementsCache={...this.itemMeasurementsCache,[d.key]:f},this.notify())},l=[],a={};for(let c=0,m=r.length;c<m;c++){var u;const h=r[c],f={...o[h],measureElement:a[h]=(u=this.measureElementCache[h])!=null?u:i(h)};l.push(f)}return this.measureElementCache=a,l},{key:!1}),this.scrollToOffset=function(r,o){let{align:s}=o===void 0?{align:"start"}:o;const i=()=>{const l=n.scrollOffset,a=n.getSize();s==="auto"&&(r<=l?s="start":r>=l+a?s="end":s="start"),s==="start"?n._scrollToOffset(r,!0):s==="end"?n._scrollToOffset(r-a,!0):s==="center"&&n._scrollToOffset(r-a/2,!0)};i(),requestAnimationFrame(()=>{i()})},this.scrollToIndex=function(r,o){let{align:s,...i}=o===void 0?{align:"auto"}:o;const l=n.getMeasurements(),a=n.scrollOffset,u=n.getSize(),{count:c}=n.options,m=l[Math.max(0,Math.min(r,c-1))];if(!m)return;if(s==="auto")if(m.end>=a+u-n.options.scrollPaddingEnd)s="end";else if(m.start<=a+n.options.scrollPaddingStart)s="start";else return;const h=s==="end"?m.end+n.options.scrollPaddingEnd:m.start-n.options.scrollPaddingStart;n.scrollToOffset(h,{align:s,...i})},this.getTotalSize=()=>{var r;return(((r=this.getMeasurements()[this.options.count-1])==null?void 0:r.end)||this.options.paddingStart)+this.options.paddingEnd},this._scrollToOffset=(r,o)=>{clearTimeout(this.scrollCheckFrame),this.destinationOffset=r,this.options.scrollToFn(r,this.options.enableSmoothScroll&&o,this);let s;const i=()=>{let l=this.scrollOffset;this.scrollCheckFrame=s=setTimeout(()=>{if(this.scrollCheckFrame===s){if(this.scrollOffset===l){this.destinationOffset=void 0;return}l=this.scrollOffset,i()}},100)};i()},this.measure=()=>{this.itemMeasurementsCache={},this.notify()},this.setOptions(t),this.scrollRect=this.options.initialRect,this.scrollOffset=this.options.initialOffset}}const findNearestBinarySearch=(e,t,n,r)=>{for(;e<=t;){const o=(e+t)/2|0,s=n(o);if(s<r)e=o+1;else if(s>r)t=o-1;else return o}return e>0?e-1:0};function calculateRange(e){let{measurements:t,outerSize:n,scrollOffset:r}=e;const o=t.length-1,i=findNearestBinarySearch(0,o,a=>t[a].start,r);let l=i;for(;l<o&&t[l].end<r+n;)l++;return{startIndex:i,endIndex:l}}function createVirtualizerBase(e){const t=mergeProps(e),n=new Virtualizer(t),[r,o]=createStore(n.getVirtualItems()),[s,i]=createSignal(n.getTotalSize()),l={get(u,c){switch(c){case"getVirtualItems":return()=>r;case"getTotalSize":return()=>s();default:return Reflect.get(u,c)}}},a=new Proxy(n,l);return a.setOptions(t),onMount(()=>{const u=a._didMount();a._willUpdate(),onCleanup(u)}),createComputed(()=>{a.setOptions(mergeProps(t,e,{onChange:u=>{u._willUpdate(),o(reconcile(u.getVirtualItems(),{key:"index"})),i(u.getTotalSize()),e.onChange==null||e.onChange(u)}})),a.measure()}),a}function createVirtualizer(e){return createVirtualizerBase(mergeProps({observeElementRect,observeElementOffset,scrollToFn:elementScroll},e))}var workerpool$1={exports:{}};/**
 * workerpool.js
 * https://github.com/josdejong/workerpool
 *
 * Offload tasks to a pool of workers on node.js and in the browser.
 *
 * @version 6.4.0
 * @date    2023-02-24
 *
 * @license
 * Copyright (C) 2014-2022 Jos de Jong <wjosdejong@gmail.com>
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy
 * of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations under
 * the License.
 */(function(module,exports){(function(t,n){module.exports=n()})(typeof self<"u"?self:commonjsGlobal,function(){return function(){var __webpack_modules__={345:function(e,t,n){var r=n(219),o=n(751),s=n(828),i=n(833),l=new i;function a(d,f){typeof d=="string"?this.script=d||null:(this.script=null,f=d),this.workers=[],this.tasks=[],f=f||{},this.forkArgs=Object.freeze(f.forkArgs||[]),this.forkOpts=Object.freeze(f.forkOpts||{}),this.workerThreadOpts=Object.freeze(f.workerThreadOpts||{}),this.debugPortStart=f.debugPortStart||43210,this.nodeWorker=f.nodeWorker,this.workerType=f.workerType||f.nodeWorker||"auto",this.maxQueueSize=f.maxQueueSize||1/0,this.workerTerminateTimeout=f.workerTerminateTimeout||1e3,this.onCreateWorker=f.onCreateWorker||function(){return null},this.onTerminateWorker=f.onTerminateWorker||function(){return null},f&&"maxWorkers"in f?(u(f.maxWorkers),this.maxWorkers=f.maxWorkers):this.maxWorkers=Math.max((s.cpus||4)-1,1),f&&"minWorkers"in f&&(f.minWorkers==="max"?this.minWorkers=this.maxWorkers:(c(f.minWorkers),this.minWorkers=f.minWorkers,this.maxWorkers=Math.max(this.minWorkers,this.maxWorkers)),this._ensureMinWorkers()),this._boundNext=this._next.bind(this),this.workerType==="thread"&&o.ensureWorkerThreads()}a.prototype.exec=function(d,f,y){if(f&&!Array.isArray(f))throw new TypeError('Array expected as argument "params"');if(typeof d=="string"){var w=r.defer();if(this.tasks.length>=this.maxQueueSize)throw new Error("Max queue size of "+this.maxQueueSize+" reached");var v=this.tasks,_={method:d,params:f,resolver:w,timeout:null,options:y};v.push(_);var E=w.promise.timeout;return w.promise.timeout=function(P){return v.indexOf(_)!==-1?(_.timeout=P,w.promise):E.call(w.promise,P)},this._next(),w.promise}else{if(typeof d=="function")return this.exec("run",[String(d),f]);throw new TypeError('Function or string expected as argument "method"')}},a.prototype.proxy=function(){if(arguments.length>0)throw new Error("No arguments expected");var d=this;return this.exec("methods").then(function(f){var y={};return f.forEach(function(w){y[w]=function(){return d.exec(w,Array.prototype.slice.call(arguments))}}),y})},a.prototype._next=function(){if(this.tasks.length>0){var d=this._getWorker();if(d){var f=this,y=this.tasks.shift();if(y.resolver.promise.pending){var w=d.exec(y.method,y.params,y.resolver,y.options).then(f._boundNext).catch(function(){if(d.terminated)return f._removeWorker(d)}).then(function(){f._next()});typeof y.timeout=="number"&&w.timeout(y.timeout)}else f._next()}}},a.prototype._getWorker=function(){for(var d=this.workers,f=0;f<d.length;f++){var y=d[f];if(y.busy()===!1)return y}return d.length<this.maxWorkers?(y=this._createWorkerHandler(),d.push(y),y):null},a.prototype._removeWorker=function(d){var f=this;return l.releasePort(d.debugPort),this._removeWorkerFromList(d),this._ensureMinWorkers(),new r(function(y,w){d.terminate(!1,function(v){f.onTerminateWorker({forkArgs:d.forkArgs,forkOpts:d.forkOpts,workerThreadOpts:d.workerThreadOpts,script:d.script}),v?w(v):y(d)})})},a.prototype._removeWorkerFromList=function(d){var f=this.workers.indexOf(d);f!==-1&&this.workers.splice(f,1)},a.prototype.terminate=function(d,f){var y=this;this.tasks.forEach(function($){$.resolver.reject(new Error("Pool terminated"))}),this.tasks.length=0;var w=function(P){l.releasePort(P.debugPort),this._removeWorkerFromList(P)},v=w.bind(this),_=[],E=this.workers.slice();return E.forEach(function($){var P=$.terminateAndNotify(d,f).then(v).always(function(){y.onTerminateWorker({forkArgs:$.forkArgs,forkOpts:$.forkOpts,workerThreadOpts:$.workerThreadOpts,script:$.script})});_.push(P)}),r.all(_)},a.prototype.stats=function(){var d=this.workers.length,f=this.workers.filter(function(y){return y.busy()}).length;return{totalWorkers:d,busyWorkers:f,idleWorkers:d-f,pendingTasks:this.tasks.length,activeTasks:f}},a.prototype._ensureMinWorkers=function(){if(this.minWorkers)for(var d=this.workers.length;d<this.minWorkers;d++)this.workers.push(this._createWorkerHandler())},a.prototype._createWorkerHandler=function(){var d=this.onCreateWorker({forkArgs:this.forkArgs,forkOpts:this.forkOpts,workerThreadOpts:this.workerThreadOpts,script:this.script})||{};return new o(d.script||this.script,{forkArgs:d.forkArgs||this.forkArgs,forkOpts:d.forkOpts||this.forkOpts,workerThreadOpts:d.workerThreadOpts||this.workerThreadOpts,debugPort:l.nextAvailableStartingAt(this.debugPortStart),workerType:this.workerType,workerTerminateTimeout:this.workerTerminateTimeout})};function u(d){if(!m(d)||!h(d)||d<1)throw new TypeError("Option maxWorkers must be an integer number >= 1")}function c(d){if(!m(d)||!h(d)||d<0)throw new TypeError("Option minWorkers must be an integer number >= 0")}function m(d){return typeof d=="number"}function h(d){return Math.round(d)==d}e.exports=a},219:function(e){function t(s,i){var l=this;if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(typeof s!="function")throw new SyntaxError("Function parameter handler(resolve, reject) missing");var a=[],u=[];this.resolved=!1,this.rejected=!1,this.pending=!0;var c=function(f,y){a.push(f),u.push(y)};this.then=function(d,f){return new t(function(y,w){var v=d?n(d,y,w):y,_=f?n(f,y,w):w;c(v,_)},l)};var m=function(f){return l.resolved=!0,l.rejected=!1,l.pending=!1,a.forEach(function(y){y(f)}),c=function(w,v){w(f)},m=h=function(){},l},h=function(f){return l.resolved=!1,l.rejected=!0,l.pending=!1,u.forEach(function(y){y(f)}),c=function(w,v){v(f)},m=h=function(){},l};this.cancel=function(){return i?i.cancel():h(new r),l},this.timeout=function(d){if(i)i.timeout(d);else{var f=setTimeout(function(){h(new o("Promise timed out after "+d+" ms"))},d);l.always(function(){clearTimeout(f)})}return l},s(function(d){m(d)},function(d){h(d)})}function n(s,i,l){return function(a){try{var u=s(a);u&&typeof u.then=="function"&&typeof u.catch=="function"?u.then(i,l):i(u)}catch(c){l(c)}}}t.prototype.catch=function(s){return this.then(null,s)},t.prototype.always=function(s){return this.then(s,s)},t.all=function(s){return new t(function(i,l){var a=s.length,u=[];a?s.forEach(function(c,m){c.then(function(h){u[m]=h,a--,a==0&&i(u)},function(h){a=0,l(h)})}):i(u)})},t.defer=function(){var s={};return s.promise=new t(function(i,l){s.resolve=i,s.reject=l}),s};function r(s){this.message=s||"promise cancelled",this.stack=new Error().stack}r.prototype=new Error,r.prototype.constructor=Error,r.prototype.name="CancellationError",t.CancellationError=r;function o(s){this.message=s||"timeout exceeded",this.stack=new Error().stack}o.prototype=new Error,o.prototype.constructor=Error,o.prototype.name="TimeoutError",t.TimeoutError=o,e.exports=t},751:function(e,t,n){function r(p,b){var g=typeof Symbol<"u"&&p[Symbol.iterator]||p["@@iterator"];if(!g){if(Array.isArray(p)||(g=o(p))||b&&p&&typeof p.length=="number"){g&&(p=g);var k=0,S=function(){};return{s:S,n:function(){return k>=p.length?{done:!0}:{done:!1,value:p[k++]}},e:function(O){throw O},f:S}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var R=!0,M=!1,T;return{s:function(){g=g.call(p)},n:function(){var O=g.next();return R=O.done,O},e:function(O){M=!0,T=O},f:function(){try{!R&&g.return!=null&&g.return()}finally{if(M)throw T}}}}function o(p,b){if(!!p){if(typeof p=="string")return s(p,b);var g=Object.prototype.toString.call(p).slice(8,-1);if(g==="Object"&&p.constructor&&(g=p.constructor.name),g==="Map"||g==="Set")return Array.from(p);if(g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return s(p,b)}}function s(p,b){(b==null||b>p.length)&&(b=p.length);for(var g=0,k=new Array(b);g<b;g++)k[g]=p[g];return k}function i(p,b){var g=Object.keys(p);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(p);b&&(k=k.filter(function(S){return Object.getOwnPropertyDescriptor(p,S).enumerable})),g.push.apply(g,k)}return g}function l(p){for(var b=1;b<arguments.length;b++){var g=arguments[b]!=null?arguments[b]:{};b%2?i(Object(g),!0).forEach(function(k){a(p,k,g[k])}):Object.getOwnPropertyDescriptors?Object.defineProperties(p,Object.getOwnPropertyDescriptors(g)):i(Object(g)).forEach(function(k){Object.defineProperty(p,k,Object.getOwnPropertyDescriptor(g,k))})}return p}function a(p,b,g){return b=u(b),b in p?Object.defineProperty(p,b,{value:g,enumerable:!0,configurable:!0,writable:!0}):p[b]=g,p}function u(p){var b=c(p,"string");return m(b)==="symbol"?b:String(b)}function c(p,b){if(m(p)!=="object"||p===null)return p;var g=p[Symbol.toPrimitive];if(g!==void 0){var k=g.call(p,b||"default");if(m(k)!=="object")return k;throw new TypeError("@@toPrimitive must return a primitive value.")}return(b==="string"?String:Number)(p)}function m(p){return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},m(p)}var h=n(219),d=n(828),f=n(397),y="__workerpool-terminate__";function w(){var p=_();if(!p)throw new Error("WorkerPool: workerType = 'thread' is not supported, Node >= 11.7.0 required");return p}function v(){if(typeof Worker!="function"&&((typeof Worker>"u"?"undefined":m(Worker))!=="object"||typeof Worker.prototype.constructor!="function"))throw new Error("WorkerPool: Web Workers not supported")}function _(){try{return f("worker_threads")}catch(p){if(m(p)==="object"&&p!==null&&p.code==="MODULE_NOT_FOUND")return null;throw p}}function E(){if(d.platform==="browser"){if(typeof Blob>"u")throw new Error("Blob not supported by the browser");if(!window.URL||typeof window.URL.createObjectURL!="function")throw new Error("URL.createObjectURL not supported by the browser");var p=new Blob([n(670)],{type:"text/javascript"});return window.URL.createObjectURL(p)}else return __dirname+"/worker.js"}function $(p,b){if(b.workerType==="web")return v(),P(p,Worker);if(b.workerType==="thread")return g=w(),C(p,g,b.workerThreadOpts);if(b.workerType==="process"||!b.workerType)return x(p,A(b),f("child_process"));if(d.platform==="browser")return v(),P(p,Worker);var g=_();return g?C(p,g):x(p,A(b),f("child_process"))}function P(p,b){var g=new b(p);return g.isBrowserWorker=!0,g.on=function(k,S){this.addEventListener(k,function(R){S(R.data)})},g.send=function(k,S){this.postMessage(k,S)},g}function C(p,b,g){var k=new b.Worker(p,l({stdout:!1,stderr:!1},g));return k.isWorkerThread=!0,k.send=function(S,R){this.postMessage(S,R)},k.kill=function(){return this.terminate(),!0},k.disconnect=function(){this.terminate()},k}function x(p,b,g){var k=g.fork(p,b.forkArgs,b.forkOpts),S=k.send;return k.send=function(R){return S.call(k,R)},k.isChildProcess=!0,k}function A(p){p=p||{};var b=process.execArgv.join(" "),g=b.indexOf("--inspect")!==-1,k=b.indexOf("--debug-brk")!==-1,S=[];return g&&(S.push("--inspect="+p.debugPort),k&&S.push("--debug-brk")),process.execArgv.forEach(function(R){R.indexOf("--max-old-space-size")>-1&&S.push(R)}),Object.assign({},p,{forkArgs:p.forkArgs,forkOpts:Object.assign({},p.forkOpts,{execArgv:(p.forkOpts&&p.forkOpts.execArgv||[]).concat(S)})})}function N(p){for(var b=new Error(""),g=Object.keys(p),k=0;k<g.length;k++)b[g[k]]=p[g[k]];return b}function L(p,b){var g=this,k=b||{};this.script=p||E(),this.worker=$(this.script,k),this.debugPort=k.debugPort,this.forkOpts=k.forkOpts,this.forkArgs=k.forkArgs,this.workerThreadOpts=k.workerThreadOpts,this.workerTerminateTimeout=k.workerTerminateTimeout,p||(this.worker.ready=!0),this.requestQueue=[],this.worker.on("message",function(T){if(!g.terminated)if(typeof T=="string"&&T==="ready")g.worker.ready=!0,R();else{var I=T.id,O=g.processing[I];O!==void 0&&(T.isEvent?O.options&&typeof O.options.on=="function"&&O.options.on(T.payload):(delete g.processing[I],g.terminating===!0&&g.terminate(),T.error?O.resolver.reject(N(T.error)):O.resolver.resolve(T.result)))}});function S(T){g.terminated=!0;for(var I in g.processing)g.processing[I]!==void 0&&g.processing[I].resolver.reject(T);g.processing=Object.create(null)}function R(){var T=r(g.requestQueue.splice(0)),I;try{for(T.s();!(I=T.n()).done;){var O=I.value;g.worker.send(O.message,O.transfer)}}catch(W){T.e(W)}finally{T.f()}}var M=this.worker;this.worker.on("error",S),this.worker.on("exit",function(T,I){var O=`Workerpool Worker terminated Unexpectedly
`;O+="    exitCode: `"+T+"`\n",O+="    signalCode: `"+I+"`\n",O+="    workerpool.script: `"+g.script+"`\n",O+="    spawnArgs: `"+M.spawnargs+"`\n",O+="    spawnfile: `"+M.spawnfile+"`\n",O+="    stdout: `"+M.stdout+"`\n",O+="    stderr: `"+M.stderr+"`\n",S(new Error(O))}),this.processing=Object.create(null),this.terminating=!1,this.terminated=!1,this.cleaning=!1,this.terminationHandler=null,this.lastId=0}L.prototype.methods=function(){return this.exec("methods")},L.prototype.exec=function(p,b,g,k){g||(g=h.defer());var S=++this.lastId;this.processing[S]={id:S,resolver:g,options:k};var R={message:{id:S,method:p,params:b},transfer:k&&k.transfer};this.terminated?g.reject(new Error("Worker is terminated")):this.worker.ready?this.worker.send(R.message,R.transfer):this.requestQueue.push(R);var M=this;return g.promise.catch(function(T){if(T instanceof h.CancellationError||T instanceof h.TimeoutError)return delete M.processing[S],M.terminateAndNotify(!0).then(function(){throw T},function(I){throw I});throw T})},L.prototype.busy=function(){return this.cleaning||Object.keys(this.processing).length>0},L.prototype.terminate=function(p,b){var g=this;if(p){for(var k in this.processing)this.processing[k]!==void 0&&this.processing[k].resolver.reject(new Error("Worker terminated"));this.processing=Object.create(null)}if(typeof b=="function"&&(this.terminationHandler=b),this.busy())this.terminating=!0;else{var S=function(T){if(g.terminated=!0,g.cleaning=!1,g.worker!=null&&g.worker.removeAllListeners&&g.worker.removeAllListeners("message"),g.worker=null,g.terminating=!1,g.terminationHandler)g.terminationHandler(T,g);else if(T)throw T};if(this.worker)if(typeof this.worker.kill=="function"){if(this.worker.killed){S(new Error("worker already killed!"));return}var R=setTimeout(function(){g.worker&&g.worker.kill()},this.workerTerminateTimeout);this.worker.once("exit",function(){clearTimeout(R),g.worker&&(g.worker.killed=!0),S()}),this.worker.ready?this.worker.send(y):this.requestQueue.push(y),this.cleaning=!0;return}else if(typeof this.worker.terminate=="function")this.worker.terminate(),this.worker.killed=!0;else throw new Error("Failed to terminate worker");S()}},L.prototype.terminateAndNotify=function(p,b){var g=h.defer();return b&&(g.promise.timeout=b),this.terminate(p,function(k,S){k?g.reject(k):g.resolve(S)}),g.promise},e.exports=L,e.exports._tryRequireWorkerThreads=_,e.exports._setupProcessWorker=x,e.exports._setupBrowserWorker=P,e.exports._setupWorkerThreadWorker=C,e.exports.ensureWorkerThreads=w},833:function(e){var t=65535;e.exports=n;function n(){this.ports=Object.create(null),this.length=0}n.prototype.nextAvailableStartingAt=function(r){for(;this.ports[r]===!0;)r++;if(r>=t)throw new Error("WorkerPool debug port limit reached: "+r+">= "+t);return this.ports[r]=!0,this.length++,r},n.prototype.releasePort=function(r){delete this.ports[r],this.length--}},828:function(e,t,n){var r=n(397),o=function(a){return typeof a<"u"&&a.versions!=null&&a.versions.node!=null};e.exports.isNode=o,e.exports.platform=typeof process<"u"&&o(process)?"node":"browser";var s=i("worker_threads");e.exports.isMainThread=e.exports.platform==="node"?(!s||s.isMainThread)&&!process.connected:typeof Window<"u",e.exports.cpus=e.exports.platform==="browser"?self.navigator.hardwareConcurrency:r("os").cpus().length;function i(l){try{return r(l)}catch{return null}}},670:function(e){e.exports=`!function(){var __webpack_modules__={577:function(e){e.exports=function(e,r){this.message=e,this.transfer=r}}},__webpack_module_cache__={};function __webpack_require__(e){var r=__webpack_module_cache__[e];return void 0!==r||(r=__webpack_module_cache__[e]={exports:{}},__webpack_modules__[e](r,r.exports,__webpack_require__)),r.exports}var __webpack_exports__={};!function(){var exports=__webpack_exports__,__webpack_unused_export__;function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Transfer=__webpack_require__(577),requireFoolWebpack=eval("typeof require !== 'undefined' ? require : function (module) { throw new Error('Module \\" + module + \\" not found.') }"),TERMINATE_METHOD_ID="__workerpool-terminate__",worker={exit:function(){}},WorkerThreads,parentPort;if("undefined"!=typeof self&&"function"==typeof postMessage&&"function"==typeof addEventListener)worker.on=function(e,r){addEventListener(e,function(e){r(e.data)})},worker.send=function(e){postMessage(e)};else{if("undefined"==typeof process)throw new Error("Script must be executed as a worker");try{WorkerThreads=requireFoolWebpack("worker_threads")}catch(error){if("object"!==_typeof(error)||null===error||"MODULE_NOT_FOUND"!==error.code)throw error}WorkerThreads&&null!==WorkerThreads.parentPort?(parentPort=WorkerThreads.parentPort,worker.send=parentPort.postMessage.bind(parentPort),worker.on=parentPort.on.bind(parentPort)):(worker.on=process.on.bind(process),worker.send=function(e){process.send(e)},worker.on("disconnect",function(){process.exit(1)})),worker.exit=process.exit.bind(process)}function convertError(o){return Object.getOwnPropertyNames(o).reduce(function(e,r){return Object.defineProperty(e,r,{value:o[r],enumerable:!0})},{})}function isPromise(e){return e&&"function"==typeof e.then&&"function"==typeof e.catch}worker.methods={},worker.methods.run=function(e,r){e=new Function("return ("+e+").apply(null, arguments);");return e.apply(e,r)},worker.methods.methods=function(){return Object.keys(worker.methods)},worker.terminationHandler=void 0,worker.cleanupAndExit=function(e){function r(){worker.exit(e)}if(!worker.terminationHandler)return r();var o=worker.terminationHandler(e);isPromise(o)?o.then(r,r):r()};var currentRequestId=null;worker.on("message",function(r){if(r===TERMINATE_METHOD_ID)return worker.cleanupAndExit(0);try{var e=worker.methods[r.method];if(!e)throw new Error('Unknown method "'+r.method+'"');currentRequestId=r.id;var o=e.apply(e,r.params);isPromise(o)?o.then(function(e){e instanceof Transfer?worker.send({id:r.id,result:e.message,error:null},e.transfer):worker.send({id:r.id,result:e,error:null}),currentRequestId=null}).catch(function(e){worker.send({id:r.id,result:null,error:convertError(e)}),currentRequestId=null}):(o instanceof Transfer?worker.send({id:r.id,result:o.message,error:null},o.transfer):worker.send({id:r.id,result:o,error:null}),currentRequestId=null)}catch(e){worker.send({id:r.id,result:null,error:convertError(e)})}}),worker.register=function(e,r){if(e)for(var o in e)e.hasOwnProperty(o)&&(worker.methods[o]=e[o]);r&&(worker.terminationHandler=r.onTerminate),worker.send("ready")},worker.emit=function(e){currentRequestId&&(e instanceof Transfer?worker.send({id:currentRequestId,isEvent:!0,payload:e.message},e.transfer):worker.send({id:currentRequestId,isEvent:!0,payload:e}))},__webpack_unused_export__=worker.register,worker.emit}()}();`},397:function(module){var requireFoolWebpack=eval(`typeof require !== 'undefined' ? require : function (module) { throw new Error('Module " + module + " not found.') }`);module.exports=requireFoolWebpack},577:function(e){function t(n,r){this.message=n,this.transfer=r}e.exports=t},744:function(__unused_webpack_module,exports,__webpack_require__){function _typeof(e){return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(e)}var Transfer=__webpack_require__(577),requireFoolWebpack=eval(`typeof require !== 'undefined' ? require : function (module) { throw new Error('Module " + module + " not found.') }`),TERMINATE_METHOD_ID="__workerpool-terminate__",worker={exit:function e(){}};if(typeof self<"u"&&typeof postMessage=="function"&&typeof addEventListener=="function")worker.on=function(e,t){addEventListener(e,function(n){t(n.data)})},worker.send=function(e){postMessage(e)};else if(typeof process<"u"){var WorkerThreads;try{WorkerThreads=requireFoolWebpack("worker_threads")}catch(e){if(!(_typeof(e)==="object"&&e!==null&&e.code==="MODULE_NOT_FOUND"))throw e}if(WorkerThreads&&WorkerThreads.parentPort!==null){var parentPort=WorkerThreads.parentPort;worker.send=parentPort.postMessage.bind(parentPort),worker.on=parentPort.on.bind(parentPort),worker.exit=process.exit.bind(process)}else worker.on=process.on.bind(process),worker.send=function(e){process.send(e)},worker.on("disconnect",function(){process.exit(1)}),worker.exit=process.exit.bind(process)}else throw new Error("Script must be executed as a worker");function convertError(e){return Object.getOwnPropertyNames(e).reduce(function(t,n){return Object.defineProperty(t,n,{value:e[n],enumerable:!0})},{})}function isPromise(e){return e&&typeof e.then=="function"&&typeof e.catch=="function"}worker.methods={},worker.methods.run=function e(t,n){var r=new Function("return ("+t+").apply(null, arguments);");return r.apply(r,n)},worker.methods.methods=function e(){return Object.keys(worker.methods)},worker.terminationHandler=void 0,worker.cleanupAndExit=function(e){var t=function(){worker.exit(e)};if(!worker.terminationHandler)return t();var n=worker.terminationHandler(e);isPromise(n)?n.then(t,t):t()};var currentRequestId=null;worker.on("message",function(e){if(e===TERMINATE_METHOD_ID)return worker.cleanupAndExit(0);try{var t=worker.methods[e.method];if(t){currentRequestId=e.id;var n=t.apply(t,e.params);isPromise(n)?n.then(function(r){r instanceof Transfer?worker.send({id:e.id,result:r.message,error:null},r.transfer):worker.send({id:e.id,result:r,error:null}),currentRequestId=null}).catch(function(r){worker.send({id:e.id,result:null,error:convertError(r)}),currentRequestId=null}):(n instanceof Transfer?worker.send({id:e.id,result:n.message,error:null},n.transfer):worker.send({id:e.id,result:n,error:null}),currentRequestId=null)}else throw new Error('Unknown method "'+e.method+'"')}catch(r){worker.send({id:e.id,result:null,error:convertError(r)})}}),worker.register=function(e,t){if(e)for(var n in e)e.hasOwnProperty(n)&&(worker.methods[n]=e[n]);t&&(worker.terminationHandler=t.onTerminate),worker.send("ready")},worker.emit=function(e){if(currentRequestId){if(e instanceof Transfer){worker.send({id:currentRequestId,isEvent:!0,payload:e.message},e.transfer);return}worker.send({id:currentRequestId,isEvent:!0,payload:e})}},exports.add=worker.register,exports.emit=worker.emit}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(t!==void 0)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}var __webpack_exports__={};return function(){var e=__webpack_exports__,t=__webpack_require__(828);e.pool=function(r,o){var s=__webpack_require__(345);return new s(r,o)},e.worker=function(r,o){var s=__webpack_require__(744);s.add(r,o)},e.workerEmit=function(r){var o=__webpack_require__(744);o.emit(r)},e.Promise=__webpack_require__(219),e.Transfer=__webpack_require__(577),e.platform=t.platform,e.isMainThread=t.isMainThread,e.cpus=t.cpus}(),__webpack_exports__}()})})(workerpool$1);const workerpool=workerpool$1.exports,_tmpl$$7=template("<canvas></canvas>"),ChannelSegment=e=>{let t,n;return onCleanup(()=>{n?.cancel()}),createEffect(async()=>{n?.cancel(),n=pool.exec(computeBuckets,[e.data,e.numBuckets]).then(r=>{t&&drawBars(t,r)}).catch(r=>{r.message!=="promise cancelled"&&console.error(r)})}),(()=>{const r=_tmpl$$7.cloneNode(!0),o=t;return typeof o=="function"?use(o,r):t=r,createRenderEffect(s=>{const i=e.width,l=e.height,a={width:"100%",height:"100%",...e.style};return i!==s._v$&&setAttribute(r,"width",s._v$=i),l!==s._v$2&&setAttribute(r,"height",s._v$2=l),s._v$3=style$1(r,a,s._v$3),s},{_v$:void 0,_v$2:void 0,_v$3:void 0}),r})()},pool=workerpool.pool();function computeBuckets(e,t){const n=Math.ceil(e.length/t),r=[];let o=0;for(let s=0;s<t;s++){const i=o+n,l=e.subarray(o,i);let a=1/0;for(const c of l)a=Math.min(c,a);let u=-1/0;for(const c of l)u=Math.max(c,u);r.push({min:a,max:u}),o=i}return r}const drawBars=(e,t)=>{const n=e.getContext("2d");if(!n)return;const r=2;n.lineWidth=r,n.clearRect(0,0,e.width,e.height),n.translate(0,e.height/2);for(let o=0;o<t.length;o++){const s=t[o];if(!s)return;const{min:i,max:l}=s;n.beginPath(),n.moveTo(o,l*(e.height/2)+r/2),n.lineTo(o,i*(e.height/2)-r/2),n.stroke()}n.translate(0,-e.height/2)},createDrag=e=>{let t;const[n,r]=createSignal(0),o=l=>{e.onStart?.(l),t=l.clientX,document.body.addEventListener("pointerup",s),document.body.addEventListener("pointerleave",s),document.body.addEventListener("pointermove",i)},s=l=>{e.onFinished?.(l),t=void 0,document.body.removeEventListener("pointerup",s),document.body.removeEventListener("pointerleave",s),document.body.removeEventListener("pointermove",i),r(0)},i=l=>{t!==void 0&&(e.onDrag?.(l),r(l.clientX-t))};return{offset:n,start:o}},_tmpl$$6=template("<div></div>"),Stick=e=>{const[,t]=splitProps(e,["pos"]);return(()=>{const n=_tmpl$$6.cloneNode(!0);return spread(n,mergeProps(t,{get style(){return{position:"absolute",top:0,left:`${e.width/-2}px`,transform:`translateX(${e.pos*100}cqi)`,width:`${e.width}px`,height:"100%",background:e.background,...e.style}}}),!1,!0),n})()},_tmpl$$5=template("<button><span><span></span></span></button>"),Trigger=e=>{const t=createMemo(()=>e.region&&player.playing()&&same(player.region(),e.region));return(()=>{const n=_tmpl$$5.cloneNode(!0),r=n.firstChild,o=r.firstChild;return n.$$dblclick=s=>s.stopPropagation(),n.$$click=()=>{t()?player.stop():(player.play(state.clip.buffer,e.region),e.onTrigger?.())},o.style.setProperty("font-family","monospace"),o.style.setProperty("font-size","1rem"),insert(o,(()=>{const s=createMemo(()=>!!t());return()=>s()?"\u25A0":"\u25B6"})()),insert(r,createComponent(Show,{get when(){return e.text},children:"\xA0"}),null),insert(r,()=>e.text,null),createRenderEffect(s=>{const i=e.style,l=!e.region;return s._v$=style$1(n,i,s._v$),l!==s._v$2&&(n.disabled=s._v$2=l),s},{_v$:void 0,_v$2:void 0}),n})()};delegateEvents(["click","dblclick"]);function createZoom(){const t=Math.pow(2,10),[n,r]=createSignal(32),o=2;return{in:()=>r(s=>Math.max(1,s/o)),out:()=>r(s=>Math.min(t,s*o)),samplesPerPixel:n,inDisabled:()=>n()===1,outDisabled:()=>n()===t}}const debounce$1=(e,t)=>{let n;return r=>{n===void 0&&(e(r),n=setTimeout(()=>{n=void 0},t))}};var FUNC_ERROR_TEXT="Expected a function",NAN=0/0,symbolTag="[object Symbol]",reTrim=/^\s+|\s+$/g,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt,freeGlobal=typeof commonjsGlobal=="object"&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),objectProto=Object.prototype,objectToString=objectProto.toString,nativeMax=Math.max,nativeMin=Math.min,now=function(){return root.Date.now()};function debounce(e,t,n){var r,o,s,i,l,a,u=0,c=!1,m=!1,h=!0;if(typeof e!="function")throw new TypeError(FUNC_ERROR_TEXT);t=toNumber(t)||0,isObject(n)&&(c=!!n.leading,m="maxWait"in n,s=m?nativeMax(toNumber(n.maxWait)||0,t):s,h="trailing"in n?!!n.trailing:h);function d(C){var x=r,A=o;return r=o=void 0,u=C,i=e.apply(A,x),i}function f(C){return u=C,l=setTimeout(v,t),c?d(C):i}function y(C){var x=C-a,A=C-u,N=t-x;return m?nativeMin(N,s-A):N}function w(C){var x=C-a,A=C-u;return a===void 0||x>=t||x<0||m&&A>=s}function v(){var C=now();if(w(C))return _(C);l=setTimeout(v,y(C))}function _(C){return l=void 0,h&&r?d(C):(r=o=void 0,i)}function E(){l!==void 0&&clearTimeout(l),u=0,r=a=o=l=void 0}function $(){return l===void 0?i:_(now())}function P(){var C=now(),x=w(C);if(r=arguments,o=this,a=C,x){if(l===void 0)return f(a);if(m)return l=setTimeout(v,t),d(a)}return l===void 0&&(l=setTimeout(v,t)),i}return P.cancel=E,P.flush=$,P}function isObject(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function isObjectLike(e){return!!e&&typeof e=="object"}function isSymbol(e){return typeof e=="symbol"||isObjectLike(e)&&objectToString.call(e)==symbolTag}function toNumber(e){if(typeof e=="number")return e;if(isSymbol(e))return NAN;if(isObject(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=isObject(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(reTrim,"");var n=reIsBinary.test(e);return n||reIsOctal.test(e)?freeParseInt(e.slice(2),n?2:8):reIsBadHex.test(e)?NAN:+e}var lodash_debounce=debounce;const _tmpl$$4=template("<div data-scroll-element><div></div></div>"),_tmpl$2$1=template('<div data-content-element><svg id="zoom-dot" viewBox="0 0 2 2" width="1ch"><circle cx="1" cy="1" r="1"></circle></svg></div>'),_tmpl$3$1=template("<div data-active-region></div>"),_tmpl$4$1=template('<div class="hitbox"></div>'),_tmpl$5$1=template("<button>delete</button>"),_tmpl$6$1=template("<div></div>"),_tmpl$7$1=template('<button><svg viewBox="0 0 1 1"><polygon points="0,0 1,0.5 0,1" fill="orange"></polygon></svg></button>'),_tmpl$8$1=template("<button>slice</button>"),_tmpl$9$1=template("<div><button></button></div>"),_tmpl$10$1=template("<div data-summary-element></div>"),TILE_WIDTH=400,TILE_HEIGHT=100;let scrollElement,contentElement;const zoom=createZoom(),Waveform=e=>{const t=debounce$1(n=>{if(!scrollElement||!contentElement)return;const r=n.clientX-scrollElement.clientLeft,o=(r+scrollElement.scrollLeft)/contentElement.clientWidth;n.deltaY>0&&!zoom.outDisabled()&&zoom.out(),n.deltaY<0&&!zoom.inDisabled()&&zoom.in(),(!zoom.inDisabled()||!zoom.outDisabled())&&(scrollElement.scrollLeft=contentElement.clientWidth*o-r)},100);return(()=>{const n=_tmpl$$4.cloneNode(!0),r=n.firstChild;n.addEventListener("keypress",s=>{switch(s.key){case"s":return dispatch({type:"setMode",mode:"slice"});case"e":return dispatch({type:"setMode",mode:"edit"});case"d":return dispatch({type:"setMode",mode:"delete"})}}),n.addEventListener("wheel",s=>{!s.ctrlKey||(s.preventDefault(),t(s))}),n.$$keydown=s=>{s.ctrlKey&&((s.key==="+"||s.key==="=")&&(s.preventDefault(),zoom.in(),s.target.scrollIntoView({inline:"center",block:"nearest"})),(s.key==="-"||s.key==="_")&&(s.preventDefault(),zoom.out(),s.target.scrollIntoView({inline:"center",block:"nearest"})))};const o=scrollElement;return typeof o=="function"?use(o,n):scrollElement=n,n.style.setProperty("overflow","auto"),r.style.setProperty("height","calc(var(--min-btn-dimension) + 20px)"),insert(n,createComponent(WaveformContent,{get buffer(){return e.buffer}}),null),insert(n,createComponent(WaveformSummary,{get buffer(){return e.buffer}}),null),n})()},[zoomCenter,setZoomCenter]=createSignal(0),WaveformContent=e=>{const t=createMemo(()=>createVirtualizer({count:range(0,e.buffer.length/zoom.samplesPerPixel(),TILE_WIDTH).length,getScrollElement:()=>scrollElement,estimateSize:()=>TILE_WIDTH,horizontal:!0})),n=r=>{if(!contentElement)return;const o=contentElement.getBoundingClientRect(),s=r.clientX-o.left;dispatch({type:"setCursor",pos:s/contentElement.clientWidth})};return(()=>{const r=_tmpl$2$1.cloneNode(!0),o=r.firstChild;r.$$dblclick=i=>{n(i),setZoomCenter(state.cursor),dispatch({type:"showCursorControls"})};const s=contentElement;return typeof s=="function"?use(s,r):contentElement=r,r.style.setProperty("display","flex"),r.style.setProperty("position","relative"),r.style.setProperty("container-type","inline-size"),o.style.setProperty("position","absolute"),o.style.setProperty("left","-0.5ch"),o.style.setProperty("opacity","0.8"),o.style.setProperty("top","calc(var(--min-btn-dimension) * -1 - 15px)"),insert(r,createComponent(For,{get each(){return t().getVirtualItems()},children:i=>createComponent(WaveformTile,{get buffer(){return e.buffer},get start(){return i.start},length:TILE_WIDTH})}),null),insert(r,createComponent(For,{get each(){return state.regions},children:(i,l)=>createComponent(Slice,{region:i,get index(){return l()},get id(){return i.start.toString()}})}),null),insert(r,createComponent(ActiveRegion,{}),null),insert(r,createComponent(Cursor,{}),null),insert(r,createComponent(Playhead,{}),null),createRenderEffect(i=>{const l=`${e.buffer.length/zoom.samplesPerPixel()}px`,a=e.buffer.numberOfChannels*TILE_HEIGHT+"px",u=`translateX(${zoomCenter()*100}cqi)`;return l!==i._v$&&r.style.setProperty("width",i._v$=l),a!==i._v$2&&r.style.setProperty("height",i._v$2=a),u!==i._v$3&&o.style.setProperty("transform",i._v$3=u),i},{_v$:void 0,_v$2:void 0,_v$3:void 0}),r})()},ActiveRegion=()=>{const e=createMemo(()=>{const t=state.regions[state.selectedRegion!==void 0?state.selectedRegion:-1];return t||{start:0,end:0}});return createComponent(Show,{get when(){return e()},get children(){const t=_tmpl$3$1.cloneNode(!0);return t.style.setProperty("position","absolute"),t.style.setProperty("height","100%"),t.style.setProperty("background","hsl(39deg 100% 50% / 40%)"),t.style.setProperty("pointer-events","none"),createRenderEffect(n=>{const r=(e().end-e().start)*100+"cqi",o=e().start*100+"cqi";return r!==n._v$4&&t.style.setProperty("width",n._v$4=r),o!==n._v$5&&t.style.setProperty("left",n._v$5=o),n},{_v$4:void 0,_v$5:void 0}),t}})},Slice=e=>{const t=i=>i.preventDefault(),n=createDrag({onStart:()=>{scrollElement?.addEventListener("touchmove",t)},onFinished:()=>{dispatch({type:"moveSlice",index:e.index,pos:r()}),setZoomCenter(e.region.start),scrollElement?.removeEventListener("touchmove",t)}}),r=()=>{if(contentElement){const i=o(),l=e.region.start+n.offset()/contentElement.clientWidth;return Math.max(i.left,Math.min(i.right,l))}return e.region.start},o=()=>{const i=state.clip;if(!i||!contentElement)throw"AAAAAAH";const u=.005/(i.buffer.length/i.buffer.sampleRate),c=(state.regions[e.index-1]?.start||0)+(e.index>0?u:0),m=e.region.end-u;return{left:c,right:m}},s=createKeyboardMovementHandler(i=>{const l=o(),a=Math.max(l.left,Math.min(l.right,e.region.start+i));dispatch({type:"moveSlice",index:e.index,pos:a}),setZoomCenter(a),document.getElementById(`slice-${a}`)?.focus()});return[createComponent(Stick,{get pos(){return r()},width:2,background:"black",style:{"box-shadow":"1px 0px 0px white, -1px 0px 0px white"}}),(()=>{const i=_tmpl$4$1.cloneNode(!0);return i.style.setProperty("position","absolute"),i.style.setProperty("height","100%"),createRenderEffect(l=>{const a=e.index,u=`translateX(${e.region.start*100}cqi)`,c=`${(e.region.end-e.region.start)*100}cqi`;return a!==l._v$6&&setAttribute(i,"data-index",l._v$6=a),u!==l._v$7&&i.style.setProperty("transform",l._v$7=u),c!==l._v$8&&i.style.setProperty("width",l._v$8=c),l},{_v$6:void 0,_v$7:void 0,_v$8:void 0}),i})(),createComponent(Show,{get when(){return state.mode==="edit"&&e.index>0},get children(){return createComponent(Stick,{get pos(){return r()},width:30,background:"hsl(0deg 0% 25% / 50%)",onPointerDown:i=>{n.start(i)},onFocus:()=>setZoomCenter(r()),tabIndex:0,onkeydown:s,get id(){return`slice-${e.region.start}`}})}}),(()=>{const i=_tmpl$6$1.cloneNode(!0);return i.$$focusin=()=>setZoomCenter(r()),i.style.setProperty("position","absolute"),i.style.setProperty("display","flex"),i.style.setProperty("top","calc(-1 * var(--min-btn-dimension))"),insert(i,createComponent(Show,{get when(){return state.mode==="delete"&&e.index>0},get children(){const l=_tmpl$5$1.cloneNode(!0);return l.$$click=()=>{dispatch({type:"healSlice",index:e.index}),state.selectedRegion!==void 0&&e.index<=state.selectedRegion&&dispatch({type:"selectRegion",index:state.selectedRegion-1})},l}}),null),insert(i,createComponent(Trigger,{get region(){return e.region},get text(){return(e.index+1).toString()},onTrigger:()=>{setZoomCenter(e.region.start),state.selectedRegion!==void 0&&dispatch({type:"selectRegion",index:e.index})}}),null),createRenderEffect(()=>i.style.setProperty("transform",`translateX(${r()*100}cqi)`)),i})()]},createKeyboardMovementHandler=e=>t=>{if(!(!scrollElement||!contentElement||!(t.target instanceof Element))&&["ArrowRight","ArrowLeft","ArrowUp","ArrowDown","PageDown","PageUp","Home","End"].includes(t.key)){t.preventDefault();const r=10/contentElement.clientWidth,o=t.ctrlKey?r*10:r;t.key==="ArrowRight"&&(e(o),t.target.getBoundingClientRect().right>scrollElement.getBoundingClientRect().right&&t.target.scrollIntoView({inline:"center",block:"nearest"})),t.key==="ArrowLeft"&&(e(-o),t.target.getBoundingClientRect().left<scrollElement.getBoundingClientRect().left&&t.target.scrollIntoView({inline:"center",block:"nearest"}));const i=scrollElement.clientWidth/contentElement.clientWidth;t.key==="PageDown"&&(e(i),t.target.scrollIntoView({inline:"center",block:"nearest"})),t.key==="PageUp"&&(e(-i),t.target.scrollIntoView({inline:"center",block:"nearest"})),t.key==="Home"&&(e(-1),t.target.scrollIntoView({inline:"center",block:"nearest"})),t.key==="End"&&(e(1),t.target.scrollIntoView({inline:"center",block:"nearest"}))}},Cursor=e=>{const t=c=>c.preventDefault(),n=createDrag({onStart:()=>{scrollElement?.addEventListener("touchmove",t)},onFinished:()=>{dispatch({type:"setCursor",pos:r()}),scrollElement?.removeEventListener("touchmove",t),setZoomCenter(state.cursor)}}),r=()=>{if(contentElement){const c=state.cursor+n.offset()/contentElement.clientWidth;return Math.max(0,Math.min(1,c))}return state.cursor},o=createKeyboardMovementHandler(c=>{dispatch({type:"setCursor",pos:state.cursor+c}),setZoomCenter(state.cursor)});let s;const[i,l]=createSignal(0),a=createMemo(()=>{const c=state.regions[i()];return c!==void 0&&player.playing()&&same(player.region(),{start:state.cursor,end:c.end})}),u=()=>{const c=document.getElementById("cursor");if(!c)return;const m=document.elementsFromPoint(c.getBoundingClientRect().x,c.getBoundingClientRect().y).find(d=>d.classList.contains("hitbox"));if(!m||!(m instanceof HTMLElement))return;const h=parseInt(m.dataset.index||"");l(h)};return[(()=>{const c=_tmpl$6$1.cloneNode(!0);return c.style.setProperty("pointer-events","none"),insert(c,createComponent(Stick,{id:"cursor",get pos(){return r()},width:2,background:"repeating-linear-gradient(orange 0px, orange 4px, transparent 4px, transparent 8px)"})),c})(),createComponent(Show,{get when(){return state.mode==="slice"},get children(){return createComponent(Stick,{ref(c){const m=s;typeof m=="function"?m(c):s=c},get pos(){return r()},width:30,background:"hsl(39deg 100% 50% / 50%)",get onPointerDown(){return n.start},onKeyDown:o,onFocus:()=>setZoomCenter(r()),tabIndex:0})}}),(()=>{const c=_tmpl$7$1.cloneNode(!0),m=c.firstChild;return c.$$dblclick=h=>h.stopPropagation(),addEventListener$1(c,"keydown",o,!0),c.$$click=()=>{state.cursorControlsVisible?dispatch({type:"hideCursorControls"}):dispatch({type:"showCursorControls"})},c.style.setProperty("position","absolute"),c.style.setProperty("width","min-content"),c.style.setProperty("display","grid"),c.style.setProperty("left","-15px"),c.style.setProperty("align-content","center"),c.style.setProperty("font-size","large"),c.style.setProperty("background","hsl(39deg 100% 50% / 0%)"),c.style.setProperty("border","none"),c.style.setProperty("color","orange"),c.style.setProperty("min-width","unset"),c.style.setProperty("box-sizing","border-box"),c.style.setProperty("padding","0"),m.style.setProperty("width","30px"),createRenderEffect(h=>{const d=`translateX(calc(${r()*100}cqi))`,f=`
            ${state.cursorControlsVisible?"rotate(-90deg)":"rotate(90deg)"}
            scale(0.5)
          `;return d!==h._v$9&&c.style.setProperty("transform",h._v$9=d),f!==h._v$10&&m.style.setProperty("transform",h._v$10=f),h},{_v$9:void 0,_v$10:void 0}),c})(),createComponent(Show,{get when(){return state.cursorControlsVisible},get children(){const c=_tmpl$9$1.cloneNode(!0),m=c.firstChild;return c.$$focusin=()=>setZoomCenter(state.cursor),addEventListener$1(c,"keydown",o,!0),c.$$dblclick=h=>h.stopPropagation(),c.style.setProperty("position","absolute"),c.style.setProperty("display","flex"),c.style.setProperty("top","calc(-1 * var(--min-btn-dimension))"),insert(c,createComponent(Show,{get when(){return state.mode==="slice"},get children(){const h=_tmpl$8$1.cloneNode(!0);return h.$$click=()=>{u(),dispatch({type:"slice",index:i(),pos:state.cursor}),dispatch({type:"hideCursorControls"}),s?.focus(),setZoomCenter(state.cursor),state.selectedRegion!==void 0&&dispatch({type:"selectRegion",index:i()+1})},h}}),m),m.$$click=()=>{if(a())player.stop();else{setZoomCenter(state.cursor),u();const h=state.regions[i()];if(!h)return;player.play(state.clip.buffer,{start:state.cursor,end:h.end})}},m.style.setProperty("font-family","monospace"),m.style.setProperty("font-size","1rem"),insert(m,(()=>{const h=createMemo(()=>!!a());return()=>h()?"\u25A0":"\u25B6"})()),createRenderEffect(()=>c.style.setProperty("transform",`translateX(${r()*100}cqi)`)),c}})]},Playhead=()=>createComponent(Show,{get when(){return player.playing()},get children(){return createComponent(Stick,{get pos(){return player.progress()},width:2,background:"orange"})}}),WaveformSummary=e=>{let t;const n=()=>{const[a,u]=createSignal(0),[c,m]=createSignal(0);return useAnimationFrame(()=>{scrollElement&&contentElement&&(u(scrollElement.scrollLeft/contentElement.clientWidth*100),m(scrollElement.clientWidth/contentElement.clientWidth*100))}),(()=>{const h=_tmpl$6$1.cloneNode(!0);return h.style.setProperty("position","absolute"),h.style.setProperty("bottom","0"),h.style.setProperty("height","39px"),h.style.setProperty("background","#8888"),createRenderEffect(d=>{const f=`min(100cqi, max(${c()}cqi, 2px))`,y=a()+"cqi";return f!==d._v$11&&h.style.setProperty("width",d._v$11=f),y!==d._v$12&&h.style.setProperty("left",d._v$12=y),d},{_v$11:void 0,_v$12:void 0}),h})()},r=a=>{if(!t||!contentElement||!scrollElement)return;const u=t.getBoundingClientRect(),m=(a.clientX-u.left)/u.width;scrollElement.scrollLeft=contentElement.getBoundingClientRect().width*m-scrollElement.getBoundingClientRect().width/2},o=createDrag({onStart:r,onDrag:r}),[s,i]=createSignal(800);window.setWidth=i;const l=new ResizeObserver(lodash_debounce(()=>{t&&i(t.clientWidth)},300,{trailing:!0}));return onMount(()=>{t&&l.observe(t)}),onCleanup(()=>{t&&l.unobserve(t)}),(()=>{const a=_tmpl$10$1.cloneNode(!0);addEventListener$1(a,"pointerdown",o.start,!0);const u=t;return typeof u=="function"?use(u,a):t=a,a.style.setProperty("position","sticky"),a.style.setProperty("left","0"),a.style.setProperty("height","50px"),a.style.setProperty("touch-action","none"),a.style.setProperty("container-type","inline-size"),insert(a,createComponent(For,{get each(){return range(0,e.buffer.numberOfChannels)},children:c=>createComponent(ChannelSegment,{get data(){return e.buffer.getChannelData(c)},get width(){return s()},height:25,get numBuckets(){return s()},style:{position:"absolute",bottom:0,height:"39px"}})}),null),insert(a,createComponent(n,{}),null),insert(a,createComponent(Stick,{get pos(){return state.cursor},width:2,background:"repeating-linear-gradient(orange 0px, orange 2px, transparent 2px, transparent 4px)",style:{height:"50px",top:"unset",bottom:0}}),null),insert(a,createComponent(For,{get each(){return state.regions},children:c=>createComponent(Stick,{get pos(){return c.start},background:"black",style:{height:"10px"},width:2})}),null),insert(a,createComponent(ActiveRegion,{}),null),insert(a,createComponent(Playhead,{}),null),a})()},WaveformTile=e=>(()=>{const t=_tmpl$6$1.cloneNode(!0);return t.style.setProperty("display","flex"),t.style.setProperty("flex-direction","column"),t.style.setProperty("position","absolute"),t.style.setProperty("top","0"),t.style.setProperty("left","0"),t.style.setProperty("width","400px"),insert(t,createComponent(For,{get each(){return range(0,e.buffer.numberOfChannels)},children:n=>{const r=createMemo(()=>e.buffer.getChannelData(n).slice(e.start*zoom.samplesPerPixel(),(e.start+e.length)*zoom.samplesPerPixel()));return createComponent(ChannelSegment,{get data(){return r()},width:TILE_WIDTH,height:TILE_HEIGHT,get numBuckets(){return r().length/zoom.samplesPerPixel()}})}})),createRenderEffect(()=>t.style.setProperty("transform",`translateX(${e.start}px)`)),t})();delegateEvents(["keydown","dblclick","focusin","click","pointerdown"]);const Controls$1="",_tmpl$$3=template('<div class="controls-outer"><div class="controls"><fieldset><button>undo</button><button>redo</button></fieldset><fieldset><legend>mode:</legend><div class="radio-item"><input type="radio" id="slice" value="slice"><label for="slice">slice</label></div><div class="radio-item"><input type="radio" id="edit" value="edit"><label for="edit">edit</label></div><div class="radio-item"><input type="radio" id="delete" value="delete"><label for="delete">delete</label></div></fieldset><fieldset><button>zoom in</button><button>zoom out</button></fieldset></div></div>'),Controls=()=>(()=>{const e=_tmpl$$3.cloneNode(!0),t=e.firstChild,n=t.firstChild,r=n.firstChild,o=r.nextSibling,s=n.nextSibling,i=s.firstChild,l=i.nextSibling,a=l.firstChild,u=l.nextSibling,c=u.firstChild,m=u.nextSibling,h=m.firstChild,d=s.nextSibling,f=d.firstChild,y=f.nextSibling;return r.$$click=()=>undo.execute(),o.$$click=()=>redo.execute(),s.addEventListener("change",w=>{switch(w.target.value){case"slice":return dispatch({type:"setMode",mode:"slice"});case"edit":return dispatch({type:"setMode",mode:"edit"});case"delete":return dispatch({type:"setMode",mode:"delete"})}}),f.$$click=()=>{zoom.in(),document.getElementById("zoom-dot")?.scrollIntoView({inline:"center",block:"nearest"})},y.$$click=()=>{zoom.out(),document.getElementById("zoom-dot")?.scrollIntoView({inline:"center",block:"nearest"})},createRenderEffect(w=>{const v=undo.disabled(),_=redo.disabled(),E=zoom.inDisabled(),$=zoom.outDisabled();return v!==w._v$&&(r.disabled=w._v$=v),_!==w._v$2&&(o.disabled=w._v$2=_),E!==w._v$3&&(f.disabled=w._v$3=E),$!==w._v$4&&(y.disabled=w._v$4=$),w},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),createRenderEffect(()=>a.checked=state.mode==="slice"),createRenderEffect(()=>c.checked=state.mode==="edit"),createRenderEffect(()=>h.checked=state.mode==="delete"),e})();delegateEvents(["click"]);const formatOf=e=>{switch(e.numberOfChannels){case 1:return"mono";case 2:return"stereo";default:return e.numberOfChannels+" channels"}},_tmpl$$2=template("<div><button>clear</button><div><p></p><p>s</p><p></p></div></div>"),Details=e=>(()=>{const t=_tmpl$$2.cloneNode(!0),n=t.firstChild,r=n.nextSibling,o=r.firstChild,s=o.nextSibling,i=s.firstChild,l=s.nextSibling;return t.style.setProperty("display","flex"),t.style.setProperty("align-items","center"),t.style.setProperty("word-break","break-word"),n.$$click=()=>{confirm("Are you sure?")&&(dispatch({type:"reset"}),player.stop())},r.style.setProperty("display","flex"),r.style.setProperty("flex-wrap","wrap"),r.style.setProperty("gap","1ch"),r.style.setProperty("padding","1ch"),r.style.setProperty("margin-inline-start","auto"),insert(o,()=>e.clip.name),insert(s,()=>(e.clip.buffer.length/e.clip.buffer.sampleRate).toFixed(2),i),insert(l,()=>formatOf(e.clip.buffer)),t})();delegateEvents(["click"]);const style="",_tmpl$$1=template("<div><progress></progress></div>"),Curtain=()=>(()=>{const e=_tmpl$$1.cloneNode(!0);return e.style.setProperty("position","fixed"),e.style.setProperty("width","100vw"),e.style.setProperty("height","100vh"),e.style.setProperty("left","0"),e.style.setProperty("top","0"),e.style.setProperty("background","black"),e.style.setProperty("opacity","0.3"),e.style.setProperty("display","grid"),e.style.setProperty("place-content","center"),e.style.setProperty("z-index","100"),e})(),_tmpl$=template("<fieldset><legend>import audio</legend></fieldset>"),_tmpl$2=template('<form><button type="submit">from url</button><label for="url-input">url:</label><input type="url" id="url-input" name="url" required></form>'),_tmpl$3=template("<div></div>"),_tmpl$4=template('<dialog id="settings-dialog"></dialog>'),_tmpl$5=template("<div><button>X</button><fieldset><legend>speed/pitch</legend></fieldset><fieldset><legend>filter</legend></fieldset><fieldset><legend>compression</legend></fieldset></div>"),_tmpl$6=template('<div><p><label></label><span><span></span></span></p><input type="range"></div>'),_tmpl$7=template('<div style="display: grid; position: relative;"><button data-details-link>...</button></div>'),_tmpl$8=template("<button>share</button>"),_tmpl$9=template('<div id="region-details"><div id="region-details-header"><button>back</button><h2></h2><div id="region-details-footer"><button>\u2039</button><button>\u203A</button></div></div><div id="region-details-body"><fieldset id="region-details-playback"><legend>playback</legend><button>spam</button></fieldset><fieldset><legend>export</legend><button>download</button></fieldset></div></div>'),_tmpl$10=template('<form><fieldset><legend>segment region</legend><label for="number-of-pieces-input">pieces:</label><input type="number" name="number of pieces" id="number-of-pieces-input" min="2" required pattern="[0-9]*"><button type="submit">chop</button></fieldset></form>'),_tmpl$11=template('<div id="bottom-panel"></div>'),_tmpl$12=template("<button>FX</button>"),_tmpl$13=template('<label for="loop-toggle"><span>loop</span><input type="checkbox" id="loop-toggle" name="loop"></label>'),[busy,setBusy]=createSignal(!1),clipOfFile=async e=>({name:e.name,buffer:await audioContext.decodeAudioData(await arrayBufferOfFile(e))}),arrayBufferOfFile=e=>new Promise((t,n)=>{const r=new FileReader;r.onloadend=o=>{if(!(o.target?.result instanceof ArrayBuffer)){n();return}t(o.target.result)},r.readAsArrayBuffer(e)}),LoadAudio=()=>(()=>{const e=_tmpl$.cloneNode(!0);return e.firstChild,e.style.setProperty("margin-inline","1rem"),insert(e,createComponent(AudioInput,{onChange:async t=>{setBusy(!0);const n=await clipOfFile(t).catch(r=>{console.error(r),alert("failed to load audio"),setBusy(!1)});!n||(setBusy(!1),dispatch({type:"setClip",clip:n}))}}),null),insert(e,createComponent(UrlInput,{}),null),e})(),UrlInput=()=>{let e;return(()=>{const t=_tmpl$2.cloneNode(!0),n=t.firstChild,r=n.nextSibling,o=r.nextSibling;t.addEventListener("submit",async i=>{if(i.preventDefault(),i.currentTarget.checkValidity()&&e){setBusy(!0);const l=e.value,a=await fetch(l).then(c=>c.arrayBuffer()).then(c=>audioContext.decodeAudioData(c)).catch(c=>{console.error(c),alert("failed to load audio"),setBusy(!1)});if(!a)return;const u=l.slice(l.lastIndexOf("/")+1);dispatch({type:"setClip",clip:{name:u,buffer:a}}),setBusy(!1)}}),t.style.setProperty("display","flex"),t.style.setProperty("gap","1ch"),t.style.setProperty("align-items","center"),t.style.setProperty("flex-wrap","wrap");const s=e;return typeof s=="function"?use(s,o):e=o,t})()},App=()=>[createComponent(Show,{get when(){return state.clip},get fallback(){return createComponent(LoadAudio,{})},get children(){return[(()=>{const e=_tmpl$3.cloneNode(!0);return insert(e,createComponent(Details,{get clip(){return state.clip}}),null),insert(e,createComponent(Controls,{}),null),insert(e,createComponent(Waveform,{get buffer(){return state.clip.buffer}}),null),e})(),createComponent(BottomPanel,{}),createComponent(FloatingControls,{}),createComponent(SettingsDialog,{})]}}),createComponent(Show,{get when(){return busy()},get children(){return createComponent(Curtain,{})}})],SettingsDialog=()=>{let e;return(()=>{const t=_tmpl$4.cloneNode(!0);t.$$click=r=>{const o=r.currentTarget.getBoundingClientRect(),s=r.x<o.x||r.y<o.y||r.x>o.x+o.width||r.y>o.y+o.height;r.target===e&&s&&e?.close()};const n=e;return typeof n=="function"?use(n,t):e=t,t.style.setProperty("max-height","unset"),t.style.setProperty("max-width","100vw"),t.style.setProperty("box-sizing","border-box"),t.style.setProperty("height","100vh"),t.style.setProperty("border","none"),t.style.setProperty("border-right","2px solid"),t.style.setProperty("box-shadow","0px 0px 10px"),insert(t,createComponent(SettingsForm,{})),t})()},SettingsForm=()=>(()=>{const e=_tmpl$5.cloneNode(!0),t=e.firstChild,n=t.nextSibling;n.firstChild;const r=n.nextSibling;r.firstChild;const o=r.nextSibling;return o.firstChild,t.$$click=()=>{const s=document.getElementById("settings-dialog");s instanceof HTMLDialogElement&&s.close()},t.style.setProperty("align-self","flex-start"),insert(n,createComponent(RangeInput,{get value(){return player.pitchOffsetSemis()},onInput:s=>{player.setPitchOffsetSemis(parseFloat(s.currentTarget.value))},label:"coarse",id:"speed-semis",min:-12,max:12,sign:!0,unit:"semis"}),null),insert(n,createComponent(RangeInput,{get value(){return player.pitchOffsetCents()},onInput:s=>{player.setPitchOffsetCents(parseFloat(s.currentTarget.value))},label:"fine",id:"speed-cents",min:-50,max:50,sign:!0,unit:"cents"}),null),insert(r,createComponent(RangeInput,{get value(){return player.loPass()},transformDisplay:s=>Math.floor(mapLinearToLogarithmic(s)),onInput:s=>{player.setLoPass(parseFloat(s.currentTarget.value))},label:"low pass",id:"filter-low-pass",min:0,max:100,unit:"hz"}),null),insert(r,createComponent(RangeInput,{get value(){return player.hiPass()},transformDisplay:s=>Math.floor(mapLinearToLogarithmic(s)),onInput:s=>{player.setHiPass(parseFloat(s.currentTarget.value))},label:"high pass",id:"filter-high-pass",min:0,max:100,unit:"hz"}),null),insert(o,createComponent(RangeInput,{get value(){return player.compressionThreshold()},onInput:s=>{player.setCompressionThreshold(parseFloat(s.currentTarget.value))},label:"threshold",id:"compression-threshold",min:-30,max:0,sign:!0,unit:"dB"}),null),insert(e,createComponent(RangeInput,{get value(){return player.gain()},onInput:s=>{player.setGain(parseFloat(s.currentTarget.value))},label:"gain",id:"gain",min:-20,max:20,sign:!0,unit:"dB"}),null),e})(),RangeInput=e=>{const t=()=>{const n=e.transformDisplay?e.transformDisplay(e.value):e.value;return(e.sign?`${e.value>=0?"+":"-"}${Math.abs(n)}`:n)+(e.unit||"")};return(()=>{const n=_tmpl$6.cloneNode(!0),r=n.firstChild,o=r.firstChild,s=o.nextSibling,i=s.firstChild,l=r.nextSibling;return n.style.setProperty("width","100%"),r.style.setProperty("display","flex"),r.style.setProperty("font-family","monospace"),insert(o,()=>e.label),s.style.setProperty("margin-inline-start","auto"),insert(i,t),addEventListener$1(l,"input",e.onInput,!0),l.style.setProperty("width","100%"),createRenderEffect(a=>{const u=e.id,c=e.id,m=e.id,h=e.min,d=e.max;return u!==a._v$&&setAttribute(o,"for",a._v$=u),c!==a._v$2&&setAttribute(l,"name",a._v$2=c),m!==a._v$3&&setAttribute(l,"id",a._v$3=m),h!==a._v$4&&setAttribute(l,"min",a._v$4=h),d!==a._v$5&&setAttribute(l,"max",a._v$5=d),a},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0}),createRenderEffect(()=>l.value=e.value),n})()},Pads=()=>(()=>{const e=_tmpl$3.cloneNode(!0);return e.style.setProperty("display","grid"),e.style.setProperty("grid-template-columns","repeat( auto-fit, minmax(100px, 1fr) )"),e.style.setProperty("grid-auto-rows","100px"),e.style.setProperty("padding-bottom","calc(var(--min-btn-dimension) * 2)"),insert(e,createComponent(For,{get each(){return state.regions},children:(t,n)=>(()=>{const r=_tmpl$7.cloneNode(!0),o=r.firstChild;return insert(r,createComponent(Trigger,{region:t,style:{height:"100%",width:"100%","z-index":0,"text-align":"start"},onTrigger:()=>{setZoomCenter(t.start),scrollElement&&contentElement&&(scrollElement.scrollLeft=t.start*contentElement.clientWidth-scrollElement.clientWidth/2)},get text(){return(n()+1).toString()}}),o),o.$$click=()=>{dispatch({type:"selectRegion",index:n()});const s=state.regions[n()];if(!s)return;setZoomCenter(s.start);const i=document.querySelector("#region-details button");i instanceof HTMLElement&&i.focus(),scrollRegionIntoView(s)},o.style.setProperty("position","absolute"),o.style.setProperty("right","0"),createRenderEffect(()=>setAttribute(r,"id",`region-${n()}`)),r})()})),e})(),RegionDetails=e=>{const t=()=>{const r=e.index+1,o=state.regions[r];!o||r<state.regions.length&&(dispatch({type:"selectRegion",index:r}),setZoomCenter(o.start),scrollRegionIntoView(o))},n=()=>{const r=e.index-1;if(r>-1){dispatch({type:"selectRegion",index:r});const o=state.regions[r];if(!o)return;setZoomCenter(o.start),scrollRegionIntoView(o)}};return(()=>{const r=_tmpl$9.cloneNode(!0),o=r.firstChild,s=o.firstChild,i=s.nextSibling,l=i.nextSibling,a=l.firstChild,u=a.nextSibling,c=o.nextSibling,m=c.firstChild,h=m.firstChild,d=h.nextSibling,f=m.nextSibling,y=f.firstChild,w=y.nextSibling;return r.style.setProperty("display","flex"),r.style.setProperty("flex-direction","column"),r.style.setProperty("gap","1rem"),o.style.setProperty("display","flex"),o.style.setProperty("align-items","center"),o.style.setProperty("position","sticky"),o.style.setProperty("top","0"),o.style.setProperty("background","white"),o.style.setProperty("z-index","1"),s.$$click=()=>{const v=e.index;dispatch({type:"selectRegion",index:void 0});const _=document.querySelector(`#region-${v} [data-details-link]`);_ instanceof HTMLElement&&_.focus()},i.style.setProperty("margin-inline","1rem"),i.style.setProperty("margin-inline-start","auto"),insert(i,()=>e.index+1),l.style.setProperty("display","flex"),l.style.setProperty("justify-content","center"),a.$$click=n,a.style.setProperty("font-size","1rem"),u.$$click=t,u.style.setProperty("font-size","1rem"),c.style.setProperty("display","flex"),c.style.setProperty("flex-wrap","wrap"),c.style.setProperty("gap","1rem"),c.style.setProperty("margin-inline","1rem"),c.style.setProperty("padding-bottom","calc(var(--min-btn-dimension) * 2)"),m.$$keydown=v=>{v.key==="ArrowRight"&&(v.preventDefault(),t()),v.key==="ArrowLeft"&&(v.preventDefault(),n())},insert(m,createComponent(Trigger,{get region(){return state.regions[e.index]}}),d),d.$$click=()=>{!state.clip||player.play(state.clip.buffer,state.regions[e.index])},w.$$click=async()=>{const v=state.clip?.buffer,_=state.regions[e.index];v&&_&&(setBusy(!0),await download(v,_,player.speed(),player.loPass(),player.hiPass(),player.compressionThreshold(),player.gain()).catch(),setBusy(!1))},insert(f,createComponent(Show,{get when(){return!!navigator.share},get children(){const v=_tmpl$8.cloneNode(!0);return v.$$click=async()=>{const _=state.clip?.buffer,E=state.regions[e.index];_&&E&&(setBusy(!0),await share(_,E,player.speed(),player.loPass(),player.hiPass(),player.compressionThreshold(),player.gain()).catch(),setBusy(!1))},v}}),null),insert(c,createComponent(SegmentRegionForm,{get index(){return e.index}}),null),createRenderEffect(v=>{const _=e.index===0,E=e.index===state.regions.length-1;return _!==v._v$6&&(a.disabled=v._v$6=_),E!==v._v$7&&(u.disabled=v._v$7=E),v},{_v$6:void 0,_v$7:void 0}),r})()},SegmentRegionForm=e=>{let t;if(!state.clip)return;const n=()=>{const o=state.regions[e.index];return!state.clip||!o?0:(o.end-o.start)*state.clip.buffer.duration},r=()=>Math.min(Math.floor(n()/.01),256);return(()=>{const o=_tmpl$10.cloneNode(!0),s=o.firstChild,i=s.firstChild,l=i.nextSibling,a=l.nextSibling;o.addEventListener("submit",c=>{c.preventDefault(),c.currentTarget.checkValidity()&&t&&dispatch({type:"segmentRegion",index:e.index,pieces:parseInt(t.value)})});const u=t;return typeof u=="function"?use(u,a):t=a,createRenderEffect(c=>{const m=r()<2,h=r();return m!==c._v$8&&(s.disabled=c._v$8=m),h!==c._v$9&&setAttribute(a,"max",c._v$9=h),c},{_v$8:void 0,_v$9:void 0}),o})()},BottomPanel=()=>(()=>{const e=_tmpl$11.cloneNode(!0);return insert(e,createComponent(Show,{get when(){return state.selectedRegion!==void 0},fallback:Pads,get children(){return createComponent(RegionDetails,{get index(){return state.selectedRegion}})}})),e})(),scrollRegionIntoView=e=>{scrollElement&&contentElement&&(scrollElement.scrollLeft=e.start*contentElement.clientWidth-scrollElement.clientWidth/2)},FloatingControls=()=>(()=>{const e=_tmpl$3.cloneNode(!0);return e.style.setProperty("position","fixed"),e.style.setProperty("bottom","calc(var(--min-btn-dimension) * .25)"),e.style.setProperty("left","calc(var(--min-btn-dimension) * .25)"),e.style.setProperty("min-width","unset"),e.style.setProperty("z-index","2"),e.style.setProperty("display","flex"),e.style.setProperty("gap","calc(var(--min-btn-dimension) * .25)"),insert(e,createComponent(ToggleFxDialog,{}),null),insert(e,createComponent(ToggleLoop,{}),null),e})(),ToggleFxDialog=()=>(()=>{const e=_tmpl$12.cloneNode(!0);return e.$$click=()=>{const t=document.getElementById("settings-dialog");t instanceof HTMLDialogElement&&t.showModal()},e.style.setProperty("width","calc(var(--min-btn-dimension) * 1.25)"),e.style.setProperty("height","calc(var(--min-btn-dimension) * 1.25)"),e})(),ToggleLoop=()=>(()=>{const e=_tmpl$13.cloneNode(!0),t=e.firstChild,n=t.nextSibling;return e.style.setProperty("background","white"),e.style.setProperty("width","calc(var(--min-btn-dimension) * 1.25)"),e.style.setProperty("height","calc(var(--min-btn-dimension) * 1.25)"),e.style.setProperty("border","1px solid"),n.addEventListener("change",r=>{player.setLoop(r.target.checked)}),createRenderEffect(()=>n.disabled=player.playing()),createRenderEffect(()=>n.checked=player.loop()),e})();delegateEvents(["click","input","keydown"]);render(App,document.getElementById("root"));
